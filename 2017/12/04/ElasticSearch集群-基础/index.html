<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Blog"><title>ElasticSearch集群(基础) | Jack Wang Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=2.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/6.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">ElasticSearch集群(基础)</h1><a id="logo" href="/.">Jack Wang Blog</a><p class="description">Goals determine what you are going to be</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa icon-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">ElasticSearch集群(基础)</h1><div class="post-meta">Dec 4, 2017<span> | </span><span class="category"><a href="/categories/ELK/">ELK</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><a data-disqus-identifier="2017/12/04/ElasticSearch集群-基础/" href="/2017/12/04/ElasticSearch集群-基础/#disqus_thread" class="disqus-comment-count"></a><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#安装集群管理软件"><span class="toc-number">1.</span> <span class="toc-text">安装集群管理软件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#测试集群状态"><span class="toc-number">2.</span> <span class="toc-text">测试集群状态</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#安装elasticsearch-head插件"><span class="toc-number">3.</span> <span class="toc-text">安装elasticsearch-head插件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Docker"><span class="toc-number">4.</span> <span class="toc-text">Docker</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Q-amp-A"><span class="toc-number">5.</span> <span class="toc-text">Q & A</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#效果图"><span class="toc-number">6.</span> <span class="toc-text">效果图</span></a></li></ol></div></div><div class="post-content"><script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><p>这里分享的是ELK集群基础安装文档，<a href="http://www.yfshare.vip/2017/11/22/ELK%E5%AE%89%E8%A3%85-%E5%9F%BA%E7%A1%80/">这里是 ELK安装基础</a><br><a id="more"></a><br>环境：Centos 6.6<br>　　　ElasticSearch 5.1.1<br>　　　Logstash 5.1.1<br>　　　Kibana 5.1.1  </p>
<h4 id="安装集群管理软件"><a href="#安装集群管理软件" class="headerlink" title="安装集群管理软件"></a>安装集群管理软件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#安装ElasticSearch</span></div><div class="line">[root@ELK ~]<span class="comment"># yum -y install elasticsearch-5.1.1.rpm</span></div><div class="line"></div><div class="line"><span class="comment">#ELK node1配置</span></div><div class="line">[root@ELK ~]<span class="comment"># mkdir /etc/elasticsearch/data -p</span></div><div class="line">[root@ELK ~]<span class="comment"># id elasticsearch</span></div><div class="line">uid=498(elasticsearch) gid=499(elasticsearch) groups=499(elasticsearch)</div><div class="line">[root@ELK ~]<span class="comment"># chgrp elasticsearch /etc/elasticsearch/data/ -R</span></div><div class="line">[root@ELK ~]<span class="comment"># chmod 775 /etc/elasticsearch/data/ -R</span></div><div class="line">[root@ELK ~]<span class="comment"># java -version</span></div><div class="line">java version <span class="string">"1.8.0_112"</span></div><div class="line">Java(TM) SE Runtime Environment (build 1.8.0_112-b15)</div><div class="line">Java HotSpot(TM) 64-Bit Server VM (build 25.112-b15, mixed mode)</div><div class="line">[root@ELK ~]<span class="comment"># ln -s /usr/local/jdk1.8.0_112/bin/java /usr/bin/</span></div><div class="line"></div><div class="line">[root@ELK ~]<span class="comment"># grep -v ^# /etc/elasticsearch/elasticsearch.yml | grep -v ^$</span></div><div class="line">cluster.name: <span class="string">"ES-cluster"</span></div><div class="line">node.name: <span class="string">"es-node01"</span></div><div class="line">node.master: <span class="literal">true</span></div><div class="line">node.data: <span class="literal">true</span></div><div class="line">http.enabled: <span class="literal">true</span></div><div class="line">path.data: /etc/elasticsearch/data</div><div class="line">path.logs: /var/<span class="built_in">log</span>/elasticsearch</div><div class="line">network.host: 0.0.0.0</div><div class="line">http.port: 9200</div><div class="line">http.cors.enabled: <span class="literal">true</span></div><div class="line">http.cors.allow-origin: <span class="string">"*"</span></div><div class="line">discovery.zen.ping.unicast.hosts: [<span class="string">"192.168.31.100"</span>, <span class="string">"192.168.31.110"</span>]</div><div class="line">discovery.zen.minimum_master_nodes: 1</div><div class="line"><span class="comment">#discovery.zen.minimum_master_nodes（默认是1）：这个参数控制的是，一个节点需要看到的具有master节点资格的最小数量，然后才能在集群中做操作。官方的推荐值是(N/2)+1，其中N是具有master资格的节点的数量（我们的情况是3，因此这个参数设置为2，但对于只有2个节点的情况，设置为2就有些问题了，一个节点DOWN掉后，你肯定连不上2台服务器了，这点需要注意）</span></div><div class="line">gateway.recover_after_nodes: 2</div><div class="line">[root@ELK ~]<span class="comment">#</span></div><div class="line">[root@ELK ~]<span class="comment"># /etc/init.d/elasticsearch start</span></div><div class="line">[root@ELK ~]<span class="comment"># netstat -tunlp | grep 9200</span></div><div class="line">tcp        0      0 :::9200                     :::*                        LISTEN      33156/java          </div><div class="line">[root@ELK ~]<span class="comment"># netstat -tunlp | grep 9300</span></div><div class="line">tcp        0      0 :::9300                     :::*                        LISTEN      33156/java          </div><div class="line">[root@ELK ~]<span class="comment">#</span></div><div class="line"></div><div class="line"><span class="comment">#ELK node2配置</span></div><div class="line"><span class="comment">#node2配置和node1配置相同(略)</span></div></pre></td></tr></table></figure>
<h4 id="测试集群状态"><a href="#测试集群状态" class="headerlink" title="测试集群状态"></a>测试集群状态</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">[root@ELK ~]<span class="comment"># curl localhost:9200/_cat/nodes?v     #获取集群中节点列表</span></div><div class="line">ip             heap.percent ram.percent cpu load_1m load_5m load_15m node.role master name</div><div class="line">192.168.31.100            4          81  99    4.32    3.28     3.46 mdi       -      es-node01</div><div class="line">192.168.31.110            3          94   5    0.07    0.03     0.01 mdi       *      es-node02</div><div class="line">[root@ELK ~]<span class="comment"># </span></div><div class="line">[root@ELK ~]<span class="comment"># curl localhost:9200/_cat/health?v    #集群健康检查</span></div><div class="line">epoch      timestamp cluster    status node.total node.data shards pri relo init unassign pending_tasks max_task_wait_time active_shards_percent</div><div class="line">1482982586 11:36:26  ES-cluster green           2         2     22  11    0    0        0             0                  -                100.0%</div><div class="line">[root@ELK ~]<span class="comment">#</span></div><div class="line">[root@ELK ~]<span class="comment"># curl 'localhost:9200/_cat/indices?v'  #获取ElasticSearch索引</span></div><div class="line">health status index                       uuid                   pri rep docs.count docs.deleted store.size pri.store.size</div><div class="line">green  open   logstash-message-2016.12.29 qkvr3jmWQei1oBhEy9VnCA   5   1         28            0    376.3kb        188.1kb</div><div class="line">green  open   logstash-nginx-2016.12.29   B9p9qwjsTlaE4<span class="built_in">fc</span>ZcIgJag   5   1          5            0      104kb           52kb</div><div class="line">green  open   .kibana                     bNLdONDMRdWK2-HdYkUuAA   1   1          3            0     34.1kb           17kb</div><div class="line">[root@ELK ~]<span class="comment">#</span></div><div class="line"></div><div class="line">//注：当ElasticSearch配置完成后，node2会复制node1的索引</div><div class="line">[root@ELK2 ~]<span class="comment"># curl 'localhost:9200/_cat/indices?v'</span></div><div class="line">health status index                       uuid                   pri rep docs.count docs.deleted store.size pri.store.size</div><div class="line">green  open   logstash-message-2016.12.29 qkvr3jmWQei1oBhEy9VnCA   5   1         28            0    376.3kb        188.1kb</div><div class="line">green  open   .kibana                     bNLdONDMRdWK2-HdYkUuAA   1   1          3            0     34.1kb           17kb</div><div class="line">green  open   logstash-nginx-2016.12.29   B9p9qwjsTlaE4<span class="built_in">fc</span>ZcIgJag   5   1          5            0      104kb           52kb</div><div class="line">[root@ELK2 ~]<span class="comment">#</span></div><div class="line"></div><div class="line"><span class="comment">#ElasticSearch集群日志文件位置：</span></div><div class="line">[root@ELK ~]<span class="comment"># ls /var/log/elasticsearch/</span></div><div class="line">ES-cluster_deprecation.log             ES-cluster_index_search_slowlog.log</div><div class="line">ES-cluster_index_indexing_slowlog.log  ES-cluster.log</div><div class="line">[root@ELK ~]<span class="comment">#</span></div></pre></td></tr></table></figure>
<h4 id="安装elasticsearch-head插件"><a href="#安装elasticsearch-head插件" class="headerlink" title="安装elasticsearch-head插件"></a>安装elasticsearch-head插件</h4><p>由于Elasticsearch 5.0 head插件不能以插件形式安装，因此需要单独安装<br>参考：<a href="https://github.com/mobz/elasticsearch-head" target="_blank" rel="external">https://github.com/mobz/elasticsearch-head</a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">Running as a plugin of Elasticsearch</div><div class="line"></div><div class="line">Install elasticsearch-head:</div><div class="line">– <span class="keyword">for</span> Elasticsearch 5.x:</div><div class="line">site plugins are not supported. Run elasticsearch-head as a standalone server</div><div class="line">– <span class="keyword">for</span> Elasticsearch 2.x – 4.x:</div><div class="line">sudo elasticsearch/bin/plugin install mobz/elasticsearch-head</div><div class="line">– <span class="keyword">for</span> Elasticsearch 1.x:</div><div class="line">sudo elasticsearch/bin/plugin -install mobz/elasticsearch-head/1.x</div><div class="line">– <span class="keyword">for</span> Elasticsearch 0.9:</div><div class="line">sudo elasticsearch/bin/plugin -install mobz/elasticsearch-head/0.9</div><div class="line">open http://localhost:9200/_plugin/head/</div><div class="line"></div><div class="line">Running with built <span class="keyword">in</span> server：</div><div class="line"><span class="built_in">enable</span> cors by adding http.cors.enabled: <span class="literal">true</span> <span class="keyword">in</span> elasticsearch configuration. Don’t forget to also <span class="built_in">set</span> http.cors.allow-origin because no origin allowed by default. http.cors.allow-origin: <span class="string">"*"</span> is valid value, however it’s considered as a security risk as your cluster is open to cross origin from anywhere. Check Elasticsearch documentation on this parameter: https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-http.html<span class="comment">#modules-http</span></div><div class="line">git <span class="built_in">clone</span> git://github.com/mobz/elasticsearch-head.git</div><div class="line"><span class="built_in">cd</span> elasticsearch-head</div><div class="line">npm install</div><div class="line">grunt server</div><div class="line">open http://localhost:9100/</div></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#npm命令需要安装nodejs</span></div><div class="line">[root@ELK ~]<span class="comment"># wget https://nodejs.org/dist/v0.12.16/node-v0.12.16.tar.gz</span></div><div class="line">[root@ELK ~]<span class="comment"># tar -zxf node-v0.12.16.tar.gz </span></div><div class="line">[root@ELK ~]<span class="comment"># cd node-v0.12.16</span></div><div class="line">[root@ELK node-v0.12.16]<span class="comment">#</span></div><div class="line">[root@ELK node-v0.12.16]<span class="comment"># ./configure --prefix=/usr/local/node-v0.12.16</span></div><div class="line">[root@ELK node-v0.12.16]<span class="comment"># make &amp;&amp; make install</span></div><div class="line">[root@ELK ~]<span class="comment"># ls -l /usr/local/node-v0.12.16/bin/npm</span></div><div class="line">lrwxrwxrwx 1 root root 38 Dec 28 12:43 /usr/<span class="built_in">local</span>/node-v0.12.16/bin/npm -&gt; ../lib/node_modules/npm/bin/npm-cli.js</div><div class="line">[root@ELK ~]<span class="comment"># ln -s /usr/local/node-v0.12.16/bin/npm /usr/bin/</span></div><div class="line">[root@ELK ~]<span class="comment"># ll /usr/bin/npm </span></div><div class="line">lrwxrwxrwx 1 root root 32 Dec 28 14:31 /usr/bin/npm -&gt; /usr/<span class="built_in">local</span>/node-v0.12.16/bin/npm</div><div class="line">[root@ELK ~]<span class="comment">#</span></div><div class="line">[root@ELK ~]<span class="comment"># ln -s /usr/local/node-v0.12.16/bin/node /usr/bin/</span></div><div class="line">[root@ELK ~]<span class="comment"># ll /usr/bin/node </span></div><div class="line">lrwxrwxrwx 1 root root 33 Dec 28 15:06 /usr/bin/node -&gt; /usr/<span class="built_in">local</span>/node-v0.12.16/bin/node</div><div class="line">[root@ELK ~]<span class="comment">#</span></div><div class="line"></div><div class="line">[root@ELK ~]<span class="comment"># yum -y install git</span></div><div class="line">[root@ELK ~]<span class="comment"># cd /usr/local/</span></div><div class="line">[root@ELK <span class="built_in">local</span>]<span class="comment"># git clone git://github.com/mobz/elasticsearch-head.git</span></div><div class="line">[root@ELK <span class="built_in">local</span>]<span class="comment"># cd elasticsearch-head</span></div><div class="line">[root@ELK elasticsearch-head]<span class="comment"># npm install</span></div><div class="line"><span class="comment">#如果在elasticsearch-head目录下node_modules/grunt下如果没有grunt二进制程序，则需要执行</span></div><div class="line">[root@ELK ~]<span class="comment"># cd /usr/local/elasticsearch-head/</span></div><div class="line">[root@ELK elasticsearch-head]<span class="comment"># npm install grunt --save</span></div><div class="line">[root@ELK elasticsearch-head]<span class="comment"># ls</span></div><div class="line">Dockerfile                          grunt_fileSets.js  node_modules                  README.textile  <span class="built_in">test</span></div><div class="line">elasticsearch-head.sublime-project  index.html         package.json                  _site</div><div class="line">Gruntfile.js                        LICENCE            plugin-descriptor.properties  src</div><div class="line">[root@ELK elasticsearch-head]<span class="comment"># ls -l node_modules/grunt/bin/grunt</span></div><div class="line">-rwxr-xr-x 1 root root 53 Apr  6  2016 node_modules/grunt/bin/grunt</div><div class="line">[root@ELK elasticsearch-head]<span class="comment">#</span></div><div class="line">[root@ELK elasticsearch-head]<span class="comment"># head -98 Gruntfile.js | tail -9</span></div><div class="line">		connect: &#123;</div><div class="line">			server: &#123;</div><div class="line">				options: &#123;</div><div class="line">					hostname: <span class="string">'0.0.0.0'</span>,   <span class="comment">#添加这行</span></div><div class="line">					port: 9100,</div><div class="line">					base: <span class="string">'.'</span>,</div><div class="line">					keepalive: <span class="literal">true</span></div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">[root@ELK elasticsearch-head]<span class="comment"># /usr/local/elasticsearch-head/node_modules/grunt/bin/grunt server  #如果执行报错看下面的解决办法</span></div><div class="line">Running <span class="string">"connect:server"</span> (connect) task</div><div class="line">Waiting forever...</div><div class="line">Started connect web server on http://localhost:9100</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#最新安装步骤</span></div><div class="line">yum -y install git make gcc gcc-c++ wget bzip2</div><div class="line">wget https://nodejs.org/dist/v8.9.3/node-v8.9.3.tar.gz</div><div class="line">tar -zxf node-v8.9.3.tar.gz</div><div class="line"><span class="built_in">cd</span> node-v8.9.3</div><div class="line">./configure --prefix=/usr/<span class="built_in">local</span>/node-v8.9.3</div><div class="line">make &amp;&amp; make install</div><div class="line">ln <span class="_">-s</span> /usr/<span class="built_in">local</span>/node-v8.9.3/bin/npm /usr/bin/</div><div class="line">ln <span class="_">-s</span> /usr/<span class="built_in">local</span>/node-v8.9.3/bin/node /usr/bin/</div><div class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/ &amp;&amp; git <span class="built_in">clone</span> https://github.com/mobz/elasticsearch-head.git</div><div class="line">mkdir -p /tmp/phantomjs/ &amp;&amp; wget https://github.com/Medium/phantomjs/releases/download/v2.1.1/phantomjs-2.1.1-linux-x86_64.tar.bz2 -O /tmp/phantomjs/phantomjs-2.1.1-linux-x86_64.tar.bz2</div><div class="line"><span class="built_in">cd</span> elasticsearch-head/ &amp;&amp; npm install</div><div class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/elasticsearch-head/ &amp;&amp; npm install grunt --save</div><div class="line">npm install grunt-contrib-clean --registry=https://registry.npm.taobao.org</div><div class="line">npm install grunt-contrib-concat --registry=https://registry.npm.taobao.org</div><div class="line">npm install grunt-contrib-watch --registry=https://registry.npm.taobao.org</div><div class="line">npm install grunt-contrib-connect --registry=https://registry.npm.taobao.org</div><div class="line">npm install grunt-contrib-copy --registry=https://registry.npm.taobao.org</div><div class="line">npm install grunt-contrib-jasmine --registry=https://registry.npm.taobao.org</div><div class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/elasticsearch-head/ &amp;&amp; sed -i <span class="string">"/port: 9100/ihostname: '0.0.0.0',"</span> Gruntfile.js</div><div class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/elasticsearch-head/ &amp;&amp; /usr/<span class="built_in">local</span>/elasticsearch-head/node_modules/grunt/bin/grunt server &amp;</div></pre></td></tr></table></figure>
<h4 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h4><p>听说有些依赖在国内解决不了，已经考虑使用Docker<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># docker pull salgat/elasticsearch-head</span></div><div class="line"><span class="comment"># docker run -d --name elasticsearch-head -p9100:9100 docker.io/salgat/elasticsearch-head</span></div></pre></td></tr></table></figure></p>
<p>官方也提供了elasticsearch-head在Docker容器中使用的方法<br>Running with docker<br>for Elasticsearch 5.x: <code>docker run -p 9100:9100 mobz/elasticsearch-head:5</code><br>for Elasticsearch 2.x: <code>docker run -p 9100:9100 mobz/elasticsearch-head:2</code><br>for Elasticsearch 1.x: <code>docker run -p 9100:9100 mobz/elasticsearch-head:1</code><br>for fans of alpine there is mobz/elasticsearch-head:5-alpine<br>open <code>http://localhost:9100/</code>  </p>
<h4 id="Q-amp-A"><a href="#Q-amp-A" class="headerlink" title="Q &amp; A"></a>Q &amp; A</h4><p>如果服务器重启了，有时发现执行<figure class="highlight plain"><figcaption><span>server```报错```Fatal error: Unable to find local grunt.```，需要重新按照Question1的解决方法操作一下，也可以执行下面的脚本  </span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">```bash</div><div class="line">[root@ELK ~]# cat check_es_head_grunt.sh </div><div class="line">#!/bin/bash</div><div class="line"># Auther: yfshare</div><div class="line"># Date:2016-12-29</div><div class="line">eshead_dir=&quot;/usr/local/elasticsearch-head&quot;</div><div class="line">grunt_dir=&quot;$eshead_dir/node_modules/grunt&quot;</div><div class="line">grunt_bin=&quot;$grunt_dir/bin/grunt&quot;</div><div class="line"></div><div class="line">kill -9 `ps -ef | grep -iw &apos;grunt&apos; | grep -v grep | awk &apos;&#123;print $2&#125;&apos;` &amp;&gt;/dev/null</div><div class="line">[ ! -x &quot;$grunt_bin&quot; ] &amp;&amp; chmod 755 &quot;$grunt_bin&quot;</div><div class="line">echo &apos;&apos;</div><div class="line">echo &apos;Please wait a moment.&apos;</div><div class="line">cd &quot;$eshead_dir&quot;</div><div class="line">npm install grunt --save-dev &amp;&gt; /dev/null</div><div class="line">cd &quot;$eshead_dir&quot;</div><div class="line">&quot;$grunt_bin&quot; server &amp;</div><div class="line">[ $? -eq 0 ] &amp;&amp; echo &apos;start ok.&apos;</div><div class="line">[root@ELK ~]#</div></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">[root@ELK ~]<span class="comment"># sh check_es_head_grunt.sh </span></div><div class="line"></div><div class="line">Please <span class="built_in">wait</span> a moment.</div><div class="line">start ok.</div><div class="line">Running <span class="string">"connect:server"</span> (connect) task</div><div class="line">Waiting forever...</div><div class="line">Started connect web server on http://localhost:9100</div><div class="line"></div><div class="line">[root@ELK ~]<span class="comment">#</span></div></pre></td></tr></table></figure>
<p>Question1：如果报下面的错误：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">[root@ELK ~]<span class="comment"># /usr/local/elasticsearch-head/node_modules/grunt/bin/grunt server  </span></div><div class="line">grunt-cli: The grunt <span class="built_in">command</span> line interface (v1.2.0)  </div><div class="line">Fatal error: Unable to find <span class="built_in">local</span> grunt.</div><div class="line">If you<span class="string">'re seeing this message, grunt hasn'</span>t been installed locally to</div><div class="line">your project. For more information about installing and configuring grunt,</div><div class="line">please see the Getting Started guide:  </div><div class="line">http://gruntjs.com/getting-started  </div><div class="line">[root@ELK ~]<span class="comment">#  </span></div><div class="line"></div><div class="line">Answer：  </div><div class="line">[root@ELK ~]<span class="comment"># cd /usr/local/elasticsearch-head/  </span></div><div class="line">[root@ELK elasticsearch-head]<span class="comment"># npm install grunt --save-dev  </span></div><div class="line">再执行/usr/<span class="built_in">local</span>/elasticsearch-head/node_modules/grunt/bin/grunt server就OK了</div></pre></td></tr></table></figure></p>
<p>Question2：<br>之前修改ElasticSearch 5.1的network.host的IP时，不管修改成什么(注释network.host除外)，重启均报错，开始以为是不能绑定IP地址。之前有注意到日志里的报错的<figure class="highlight plain"><figcaption><span>checks failed. max number of threads [1024] for user [elasticsearch] is too low, increase to at least [2048]```因为注释了network.host后ElasticSearch能起来，所以没意识到是它的问题  </span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">```bash</div><div class="line">#ElasticSearch日志报错</div><div class="line">[2016-12-28T16:57:23,190][INFO ][o.e.n.Node               ] [es-node01] starting ...</div><div class="line">[2016-12-28T16:57:24,616][INFO ][o.e.t.TransportService   ] [es-node01] publish_address &#123;192.168.31.100:9300&#125;, bound_addresses &#123;192.168.31.100:9300&#125;</div><div class="line">[2016-12-28T16:57:24,686][INFO ][o.e.b.BootstrapCheck     ] [es-node01] bound or publishing to a non-loopback or non-link-local address, enforcing bootstrap checks</div><div class="line">[2016-12-28T16:57:24,708][ERROR][o.e.b.Bootstrap          ] [es-node01] node validation exception</div><div class="line">bootstrap checks failed</div><div class="line">max number of threads [1024] for user [elasticsearch] is too low, increase to at least [2048]</div><div class="line">[2016-12-28T16:57:24,739][INFO ][o.e.n.Node               ] [es-node01] stopping ...</div><div class="line">[2016-12-28T16:57:25,275][INFO ][o.e.n.Node               ] [es-node01] stopped</div><div class="line">[2016-12-28T16:57:25,277][INFO ][o.e.n.Node               ] [es-node01] closing ...</div><div class="line">[2016-12-28T16:57:25,500][INFO ][o.e.n.Node               ] [es-node01] closed</div></pre></td></tr></table></figure></p>
<p>Answer：修改<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">关于ElasticSearch5.1的network.host设置  </div><div class="line">参考：https://www.elastic.co/guide/en/elasticsearch/reference/5.1/modules-network.html#common-network-settings</div><div class="line">```bash</div><div class="line">[root@ELK ~]# grep -v ^# /etc/security/limits.conf | grep -v ^$</div><div class="line">elasticsearch	soft	nproc	2048</div><div class="line">elasticsearch	hard	nproc	4096</div><div class="line">[root@ELK ~]#</div></pre></td></tr></table></figure></p>
<p>Question3：<br>如果执行<code>/usr/local/elasticsearch-head/node_modules/grunt/bin/grunt server</code>报下面的错误<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">[root@ELK-test ~]<span class="comment"># /usr/local/elasticsearch-head/node_modules/grunt/bin/grunt server</span></div><div class="line">grunt-cli: The grunt <span class="built_in">command</span> line interface (v1.2.0)</div><div class="line"></div><div class="line">Fatal error: Unable to find <span class="built_in">local</span> grunt.</div><div class="line"></div><div class="line">If you<span class="string">'re seeing this message, grunt hasn'</span>t been installed locally to</div><div class="line">your project. For more information about installing and configuring grunt,</div><div class="line">please see the Getting Started guide:</div><div class="line"></div><div class="line">http://gruntjs.com/getting-started</div><div class="line">[root@ELK-test ~]<span class="comment">#</span></div><div class="line"></div><div class="line">Answer：</div><div class="line"><span class="comment">#进入elasticsearch-head安装目录即可，因为在别的地方找不到Gruntfile.js文件</span></div><div class="line">[root@ELK-test ~]<span class="comment"># cd /usr/local/elasticsearch-head/</span></div></pre></td></tr></table></figure></p>
<p>Question4：<br>如果执行<code>/usr/local/elasticsearch-head/node_modules/grunt/bin/grunt server</code>报下面的错误<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">[root@ELK-test elasticsearch-head]<span class="comment"># /usr/local/elasticsearch-head/node_modules/grunt/bin/grunt server</span></div><div class="line">&gt;&gt; Local Npm module <span class="string">"grunt-contrib-clean"</span> not found. Is it installed?</div><div class="line">&gt;&gt; Local Npm module <span class="string">"grunt-contrib-concat"</span> not found. Is it installed?</div><div class="line">&gt;&gt; Local Npm module <span class="string">"grunt-contrib-watch"</span> not found. Is it installed?</div><div class="line">&gt;&gt; Local Npm module <span class="string">"grunt-contrib-connect"</span> not found. Is it installed?</div><div class="line">&gt;&gt; Local Npm module <span class="string">"grunt-contrib-copy"</span> not found. Is it installed?</div><div class="line">&gt;&gt; Local Npm module <span class="string">"grunt-contrib-jasmine"</span> not found. Is it installed?</div><div class="line">Warning: Task <span class="string">"connect:server"</span> not found. Use --force to continue.</div><div class="line"></div><div class="line">Aborted due to warnings.</div><div class="line">[root@ELK-test elasticsearch-head]<span class="comment">#</span></div><div class="line"></div><div class="line">Answer：</div><div class="line">出现以下提示，为Gruntfile.js引用的，缺少以下包</div><div class="line">[root@ELK-test elasticsearch-head]<span class="comment"># npm install grunt-contrib-clean --registry=https://registry.npm.taobao.org</span></div><div class="line">[root@ELK-test elasticsearch-head]<span class="comment"># npm install grunt-contrib-concat --registry=https://registry.npm.taobao.org</span></div><div class="line">[root@ELK-test elasticsearch-head]<span class="comment"># npm install grunt-contrib-watch --registry=https://registry.npm.taobao.org</span></div><div class="line">[root@ELK-test elasticsearch-head]<span class="comment"># npm install grunt-contrib-connect --registry=https://registry.npm.taobao.org</span></div><div class="line">[root@ELK-test elasticsearch-head]<span class="comment"># npm install grunt-contrib-copy --registry=https://registry.npm.taobao.org</span></div><div class="line">[root@ELK-test elasticsearch-head]<span class="comment"># npm install grunt-contrib-jasmine --registry=https://registry.npm.taobao.org</span></div><div class="line"></div><div class="line">[root@ELK-test elasticsearch-head]<span class="comment"># /usr/local/elasticsearch-head/node_modules/grunt/bin/grunt server &amp;</span></div><div class="line">[1] 22877</div><div class="line">[root@ELK-test elasticsearch-head]<span class="comment">#</span></div></pre></td></tr></table></figure></p>
<p>Question5：<br>如果在执行<code>npm install</code>时报如下错误  </p>
<p>Answer：可以先下载其所需的文件再执行<code>npm install</code>安装<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mkdir -p /tmp/phantomjs/</div><div class="line">wget https://github.com/Medium/phantomjs/releases/download/v2.1.1/phantomjs-2.1.1-linux-x86_64.tar.bz2 -O /tmp/phantomjs/phantomjs-2.1.1-linux-x86_64.tar.bz2</div></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#npm install</span></div><div class="line">npm WARN deprecated coffee-script@1.10.0: CoffeeScript on NPM has moved to <span class="string">"coffeescript"</span> (no hyphen)</div><div class="line">npm WARN deprecated http2@3.3.7: Use the built-in module <span class="keyword">in</span> node 9.0.0 or newer, instead</div><div class="line"></div><div class="line">&gt; phantomjs-prebuilt@2.1.16 install /usr/<span class="built_in">local</span>/elasticsearch-head/node_modules/phantomjs-prebuilt</div><div class="line">&gt; node install.js</div><div class="line"></div><div class="line">PhantomJS not found on PATH</div><div class="line">Downloading https://github.com/Medium/phantomjs/releases/download/v2.1.1/phantomjs-2.1.1-linux-x86_64.tar.bz2</div><div class="line">Saving to /tmp/phantomjs/phantomjs-2.1.1-linux-x86_64.tar.bz2</div><div class="line">Receiving...</div><div class="line"></div><div class="line">Error making request.</div><div class="line">Error: connect ETIMEDOUT 52.216.82.152:443</div><div class="line">    at Object._errnoException (util.js:1024:11)</div><div class="line">    at _exceptionWithHostPort (util.js:1046:20)</div><div class="line">    at TCPConnectWrap.afterConnect [as oncomplete] (net.js:1182:14)</div><div class="line"></div><div class="line">Please report this full <span class="built_in">log</span> at https://github.com/Medium/phantomjs</div><div class="line">npm WARN elasticsearch-head@0.0.0 license should be a valid SPDX license expression</div><div class="line">npm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@1.1.3 (node_modules/fsevents):</div><div class="line">npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform <span class="keyword">for</span> fsevents@1.1.3: wanted &#123;<span class="string">"os"</span>:<span class="string">"darwin"</span>,<span class="string">"arch"</span>:<span class="string">"any"</span>&#125; (current: &#123;<span class="string">"os"</span>:<span class="string">"linux"</span>,<span class="string">"arch"</span>:<span class="string">"x64"</span>&#125;)</div><div class="line"></div><div class="line">npm ERR! code ELIFECYCLE</div><div class="line">npm ERR! errno 1</div><div class="line">npm ERR! phantomjs-prebuilt@2.1.16 install: `node install.js`</div><div class="line">npm ERR! Exit status 1</div><div class="line">npm ERR! </div><div class="line">npm ERR! Failed at the phantomjs-prebuilt@2.1.16 install script.</div><div class="line">npm ERR! This is probably not a problem with npm. There is likely additional logging output above.</div><div class="line"></div><div class="line">npm ERR! A complete <span class="built_in">log</span> of this run can be found <span class="keyword">in</span>:</div><div class="line">npm ERR!     /root/.npm/_logs/2017-12-16T02_18_46_188Z-debug.log</div></pre></td></tr></table></figure>
<p>注：集群配置完成后，需要把Logstash里的ElasticSearch的地址修改正确<br>即：Logstash配置文件的output关于ElasticSearch的配置<br><figure class="highlight puppet"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">output</span> &#123;</div><div class="line">        elasticsearch &#123;</div><div class="line">                <span class="attr">hosts</span> =&gt; [<span class="string">"192.168.31.100:9200"</span>]</div><div class="line">                <span class="attr">index</span> =&gt; <span class="string">"logstash-nginx-%&#123;+YYYY.MM.dd&#125;"</span></div><div class="line">        &#125;</div></pre></td></tr></table></figure></p>
<h4 id="效果图"><a href="#效果图" class="headerlink" title="效果图"></a>效果图</h4><p><img src="http://note.youdao.com/yws/api/personal/file/6034AE21E6DD472EA31F19BACF3BB39C?method=download&amp;shareKey=c1e28da86983aaae6e3d6961ab74b314" alt="image"><br><img src="http://note.youdao.com/yws/api/personal/file/0B60DD50A74C4E5D99F9BF97C0FB2FD1?method=download&amp;shareKey=f5bdfc6cc8fa4cbac65d30607cd1463e" alt="image"><br><img src="http://note.youdao.com/yws/api/personal/file/03465D12C20840FDB100ACD61C2AB152?method=download&amp;shareKey=49f66cf16d4ed5a8c37ff7e91d9558c7" alt="image"><br><img src="http://note.youdao.com/yws/api/personal/file/3EB4A9FD353C46A5BD1C99AB94D2B5A2?method=download&amp;shareKey=201db35f0c4ca938b4e844ca7d964b7a" alt="image"><br><img src="http://note.youdao.com/yws/api/personal/file/66D98E66A0EA48DC8E763C15E8A90D77?method=download&amp;shareKey=9dbeb81b55fa0717d16179e04fe8b32d" alt="image"><br><img src="http://note.youdao.com/yws/api/personal/file/C675C13D627D4035967A809951E48D73?method=download&amp;shareKey=610e0f92a9d468b21df21f3f12b03b93" alt="image">  </p>
<p>2台elasticsearch，显示一台master和一台slave才是正常的<br><img src="http://note.youdao.com/yws/api/personal/file/C0E9213A27E1487D8D8B2C1E2A625861?method=download&amp;shareKey=cb8459b1788cd846bf9f7cd73196dcb2" alt="es_cluster">  </p>
<p>本文参考：<a href="https://www.chinasa.net/archives/325.html" target="_blank" rel="external">https://www.chinasa.net/archives/325.html</a><br>　　　　　<a href="http://zerosre.com/2016/12/20/k8s日志管理-三/" target="_blank" rel="external">http://zerosre.com/2016/12/20/k8s日志管理-三/</a><br>　　　　　<a href="http://hnr520.blog.51cto.com/4484939/1867033" target="_blank" rel="external">http://hnr520.blog.51cto.com/4484939/1867033</a><br>nodejs下载地址：<a href="https://nodejs.org/en/blog/release/v0.12.16/" target="_blank" rel="external">https://nodejs.org/en/blog/release/v0.12.16/</a>  </p>
<p>附件：<br><a href="http://note.youdao.com/yws/api/personal/file/9DF4FD46C39F4D198FA28E31175946FF?method=download&amp;shareKey=fb14484fc213e29de7d11fb267bd073b" target="_blank" rel="external">yum.repo</a><br><a href="http://note.youdao.com/yws/api/personal/file/7394DDCE364F4C47A2059C3B977A0173?method=download&amp;shareKey=33a242bfa78c38aa6e2eec84967633cc" target="_blank" rel="external">elasticsearch-head.zip</a><br><a href="http://note.youdao.com/yws/api/personal/file/E85D6B24C1944F5BB7FF562141E542C2?method=download&amp;shareKey=4b9be8a44632f563f29c6aa9e4eee9db" target="_blank" rel="external">node-v0.12.16.tar.gz</a><br><a href="http://note.youdao.com/yws/api/personal/file/10CB6262193249F8ABB874BDCA4AF1F8?method=download&amp;shareKey=19b78be82de892d54a42a473a212cee5" target="_blank" rel="external">phantomjs-2.1.1-linux-x86_64.tar.bz2</a><br><a href="http://note.youdao.com/yws/api/personal/file/46615981B34F4DCEB51313876E3F481A?method=download&amp;shareKey=bed7ee555658949beaae23dfe6e34b33" target="_blank" rel="external">check_es_head_grunt.sh</a>  </p>
<hr>
<p>本作品采用<a href="https://creativecommons.org/licenses/by/2.5/cn/" target="_blank" rel="external">知识共享署名 2.5 中国大陆许可协议</a>进行许可，欢迎转载，但转载请注明来自<a href="http://www.yfshare.vip">Jack Wang Blog</a>，并保持转载后文章内容的完整。本人保留所有版权相关权利。<br><img src="http://note.youdao.com/yws/api/personal/file/FE3C6F68961F4541AF284E5F346FC3CA?method=download&amp;shareKey=c5e4c3ca81daa6e908d5630f8c6ec242" alt="打赏"><br>本文出自”Jack Wang Blog”：<a href="http://www.yfshare.vip/2017/12/04/ElasticSearch集群-基础/">http://www.yfshare.vip/2017/12/04/ElasticSearch集群-基础/</a></p>
</div><script type="text/javascript" src="/js/share.js?v=2.0.0" async></script><a data-url="http://www.yfshare.vip/2017/12/04/ElasticSearch集群-基础/" data-id="cjdg60h0f000qykm5nlz14i4u" class="article-share-link">分享到</a><div class="tags"><a href="/tags/ELK/">ELK</a><a href="/tags/Cluster/">Cluster</a><a href="/tags/Elasticsearch-Head/">Elasticsearch-Head</a></div><div class="post-nav"><a href="/2017/12/05/关于kernel-nf-conntrack-table-full-dropping-packet问题/" class="pre">关于kernel: nf_conntrack: table full, dropping packet问题</a><a href="/2017/12/04/timelion请求语法/" class="next">timelion请求语法</a></div><div id="disqus_thread"><div class="btn_click_load"><button class="disqus_click_btn">阅读评论 「请确保 disqus.com 可以正常加载」</button></div><script>var disqus_shortname = 'yfshare';
var disqus_identifier = '2017/12/04/ElasticSearch集群-基础/';
var disqus_title = 'ElasticSearch集群(基础)';
var disqus_url = 'http://www.yfshare.vip/2017/12/04/ElasticSearch集群-基础/';
$('.btn_click_load').click(function() {
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
  $('.btn_click_load').css('display','none');
});
$.ajax({
  url: 'https://disqus.com/favicon.ico',
  timeout: 3000,
  type: 'GET',
  success: (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    $('.btn_click_load').css('display','none');
  })(),
  error: function() {
    $('.btn_click_load').css('display','block');
  }
});</script><script id="dsq-count-scr" src="//yfshare.disqus.com/count.js" async></script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Ansible/">Ansible</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Atlassian/">Atlassian</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Database/">Database</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Docker/">Docker</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ELK/">ELK</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hexo/">Hexo</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Jenkins/">Jenkins</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/K8S/">K8S</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Security/">Security</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Virtualization/">Virtualization</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/WEB/">WEB</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Windows/">Windows</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Zabbix/">Zabbix</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/版本控制系统/">版本控制系统</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/02/10/部署TLS-k8s/">部署TLS k8s</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/11/自建docker私有仓库-Vmware-Harbor/">自建docker私有仓库(Vmware Harbor)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/20/The-Docker-of-Jira7-2-0-and-Confluence6-0-0/">The Docker of Jira7.2.0 and Confluence6.0.0</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/20/自建docker私有仓库-Registry/">自建docker私有仓库(Registry)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/14/The-Redmine-svn-of-docker/">The Redmine_svn of docker</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/05/关于kernel-nf-conntrack-table-full-dropping-packet问题/">关于kernel: nf_conntrack: table full, dropping packet问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/04/ElasticSearch集群-基础/">ElasticSearch集群(基础)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/04/timelion请求语法/">timelion请求语法</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/04/Logstash监控/">Logstash监控</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/22/Grok正则语法/">Grok正则语法</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://yfshare.blog.51cto.com/" title="酱油瓶 博客" target="_blank">酱油瓶 博客</a><ul></ul><a href="http://zerosre.com/" title="龙哥zero 博客" target="_blank">龙哥zero 博客</a><ul></ul><a href="http://renzhiyuan.blog.51cto.com/" title="任志远Ray 博客" target="_blank">任志远Ray 博客</a><ul></ul><a href="http://rongrong.njdgwl.com" title="浩子的 博客" target="_blank">浩子的 博客</a><ul></ul><a href="http://www.cnblogs.com/aresxin/" title="欣哥aresxin 博客" target="_blank">欣哥aresxin 博客</a><ul></ul><a href="http://securityit.cn/" title="万马奔腾" target="_blank">万马奔腾</a></div><div class="widget"><div class="widget-title"><i class="fa fa-external-resources"> 资源站</i></div><ul></ul><a href="http://mirror.symnds.com/distributions/CentOS-vault/" title="Centos镜像站" target="_blank">Centos镜像站</a><ul></ul><a href="http://www.rpmfind.net/" title="rpmfind mirror" target="_blank">rpmfind mirror</a><ul></ul><a href="http://rpm.org/" title="rpm.org" target="_blank">rpm.org</a><ul></ul><a href="http://rpm.pbone.net/" title="rpm search" target="_blank">rpm search</a><ul></ul><a href="http://download.chinaunix.net/" title="chinaunix download" target="_blank">chinaunix download</a><ul></ul><a href="http://www.anquanquan.info/" title="安全圈info" target="_blank">安全圈info</a><ul></ul><a href="http://source.tosimp.net/" title="Tosimp 资源站" target="_blank">Tosimp 资源站</a></div><div class="widget"><div class="widget-title"><i class="fa fa-external-music"> 音乐</i></div></div><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=371362&auto=1&height=66"></iframe><div class="widget"><div class="widget-title"><i class="fa fa-external-game"> 游戏</i></div><ul></ul><a href="/2048" title="2048小游戏" target="_blank">2048小游戏</a><ul></ul><a href="/tantanqiu" title="变色弹球跳台阶小游戏" target="_blank">变色弹球跳台阶小游戏</a></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> 最近评论</i></div><script type="text/javascript" src="//yfshare.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">Jack Wang Blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=2.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=2.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=2.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?3890bdc1bfaccae9364479b65f36fbd2";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=2.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=2.0.0"></script></div></body></html>