<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Jack Wang Blog</title>
  <subtitle>Goals determine what you are going to be</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://yfshare.github.io/"/>
  <updated>2017-03-07T09:09:08.000Z</updated>
  <id>https://yfshare.github.io/</id>
  
  <author>
    <name>Jack Wang</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>部署Ansible Tower</title>
    <link href="https://yfshare.github.io/2017/03/07/%E9%83%A8%E7%BD%B2Ansible-Tower/"/>
    <id>https://yfshare.github.io/2017/03/07/部署Ansible-Tower/</id>
    <published>2017-03-07T09:05:18.000Z</published>
    <updated>2017-03-07T09:09:08.000Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><p>Ansible Tower (以前叫’AWX’)是能够帮助任何IT团队更容易使用Ansible的解决方案。该方案基于web<br>Tower允许对用户进行权限控制，即使某用户不能传送某SSH凭证，你也可以通过Tower来对该用户共享该凭证。我们可以通过图形化界面来管理Inventory，也可以对各种各样的云资源做同步。Tower可以记录所有job的日志，也可以与LDAP集成，并且拥有强大的可浏览的REST API。Tower也提供了命令行工具，可以与Jenkins轻松集成。Provisioning回调对自动伸缩拓扑图提供了强大的支持<br><a id="more"></a><br>Tower的免费版本最多支持10个节点，并且Ansible公司会提供强大的支持。可以用Ansible playbook来安装Tower，ansible的版本为1.7x或更高版本<br>安装要求：内存&gt;=2GB,/var &gt;=10GB。否则会安装失败  </p>
<p>官网地址：<a href="https://www.ansible.com/tower" target="_blank" rel="external">https://www.ansible.com/tower</a><br>下载地址(下载免费控制10个机器的授权)：<a href="https://www.ansible.com/license" target="_blank" rel="external">https://www.ansible.com/license</a><br><a href="https://releases.ansible.com/awx/setup/" target="_blank" rel="external">ansible-tower各个版本下载地址</a><br>目前最新版为3.1.0要求：RHEL 7, CentOS 7, or Ubuntu 14.04 LTS or 16.04 LTS, and requires Ansible Core 2.1.X or later.<br>我这里系统是Centos 6.6，所以只能用Tower-3.0.3及以前的版本  </p>
<p>安装前检查：  </p>
<ol>
<li>python版本为2.6</li>
<li>保持网络畅通</li>
<li>内存预留充足，内存&gt;=2GB,/var &gt;=10GB</li>
<li>安装用户为root</li>
</ol>
<p>环境：Centos 6.6<br>　　　ansible 2.2.1.0</p>
<p>安装Tower<br>Ansible tower包含一个简单的基于文本的配置向导来配置安装你的tower，安装Tower需要使用到postgresql数据库<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#配置yum源</span></div><div class="line">注意:除了光盘源外还需要extra(CentOS-Base.repo)</div><div class="line"></div><div class="line"><span class="comment">#CentOS-Base.repo源</span></div><div class="line">[root@Ansible ~]<span class="comment"># cd /etc/yum.repos.d/</span></div><div class="line">[root@Ansible yum.repos.d]<span class="comment"># cat CentOS-Base.repo </span></div><div class="line">[base]</div><div class="line">name=CentOS-<span class="variable">$releasever</span> - Base</div><div class="line">mirrorlist=http://mirrorlist.centos.org/?release=<span class="variable">$releasever</span>&amp;arch=<span class="variable">$basearch</span>&amp;repo=os&amp;infra=<span class="variable">$infra</span></div><div class="line"><span class="comment">#baseurl=http://mirror.centos.org/centos/$releasever/os/$basearch/</span></div><div class="line">gpgcheck=0</div><div class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6</div><div class="line"></div><div class="line"><span class="comment">#released updates </span></div><div class="line">[updates]</div><div class="line">name=CentOS-<span class="variable">$releasever</span> - Updates</div><div class="line">mirrorlist=http://mirrorlist.centos.org/?release=<span class="variable">$releasever</span>&amp;arch=<span class="variable">$basearch</span>&amp;repo=updates&amp;infra=<span class="variable">$infra</span></div><div class="line"><span class="comment">#baseurl=http://mirror.centos.org/centos/$releasever/updates/$basearch/</span></div><div class="line">gpgcheck=1</div><div class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6</div><div class="line"></div><div class="line"><span class="comment">#additional packages that may be useful</span></div><div class="line">[extras]</div><div class="line">name=CentOS-<span class="variable">$releasever</span> - Extras</div><div class="line">mirrorlist=http://mirrorlist.centos.org/?release=<span class="variable">$releasever</span>&amp;arch=<span class="variable">$basearch</span>&amp;repo=extras&amp;infra=<span class="variable">$infra</span></div><div class="line"><span class="comment">#baseurl=http://mirror.centos.org/centos/$releasever/extras/$basearch/</span></div><div class="line">gpgcheck=1</div><div class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6</div><div class="line"></div><div class="line"><span class="comment">#additional packages that extend functionality of existing packages</span></div><div class="line">[centosplus]</div><div class="line">name=CentOS-<span class="variable">$releasever</span> - Plus</div><div class="line">mirrorlist=http://mirrorlist.centos.org/?release=<span class="variable">$releasever</span>&amp;arch=<span class="variable">$basearch</span>&amp;repo=centosplus&amp;infra=<span class="variable">$infra</span></div><div class="line"><span class="comment">#baseurl=http://mirror.centos.org/centos/$releasever/centosplus/$basearch/</span></div><div class="line">gpgcheck=1</div><div class="line">enabled=0</div><div class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6</div><div class="line"></div><div class="line"><span class="comment">#contrib - packages by Centos Users</span></div><div class="line">[contrib]</div><div class="line">name=CentOS-<span class="variable">$releasever</span> - Contrib</div><div class="line">mirrorlist=http://mirrorlist.centos.org/?release=<span class="variable">$releasever</span>&amp;arch=<span class="variable">$basearch</span>&amp;repo=contrib&amp;infra=<span class="variable">$infra</span></div><div class="line"><span class="comment">#baseurl=http://mirror.centos.org/centos/$releasever/contrib/$basearch/</span></div><div class="line">gpgcheck=1</div><div class="line">enabled=0</div><div class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6</div><div class="line">[root@Ansible yum.repos.d]<span class="comment">#</span></div></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#Ansible-Tower的yum源</span></div><div class="line">[root@Ansible yum.repos.d]<span class="comment"># cat Ansible-Tower.repo </span></div><div class="line">[Ansible-Tower]</div><div class="line">name=Ansible Tower Repository - <span class="variable">$releasever</span> <span class="variable">$basearch</span></div><div class="line">baseurl=http://releases.ansible.com/ansible-tower/rpm/epel-6-<span class="variable">$basearch</span></div><div class="line">enabled=1</div><div class="line">gpgcheck=0</div><div class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-ansible-release</div><div class="line">[root@Ansible yum.repos.d]<span class="comment">#</span></div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">[root@Ansible yum.repos.d]<span class="comment"># cat yum.repo </span></div><div class="line">[nginx]</div><div class="line">name=nginx repo</div><div class="line">baseurl=http://nginx.org/packages/centos/6/<span class="variable">$basearch</span>/</div><div class="line">gpgcheck=0</div><div class="line">enabled=1</div><div class="line">  </div><div class="line">[webtatic]</div><div class="line">name=Webtatic Repository EL6 - <span class="variable">$basearch</span></div><div class="line">baseurl=http://repo.webtatic.com/yum/el6/<span class="variable">$basearch</span>/</div><div class="line"><span class="comment">#mirrorlist=http://mirror.webtatic.com/yum/el6/$basearch/mirrorlist</span></div><div class="line">failovermethod=priority</div><div class="line">enabled=1</div><div class="line">gpgcheck=0</div><div class="line"></div><div class="line">[epel] </div><div class="line">name=Extra Packages <span class="keyword">for</span> Enterprise Linux 6 - <span class="variable">$basearch</span> </div><div class="line">baseurl=http://mirrors.aliyun.com/epel/6/<span class="variable">$basearch</span> </div><div class="line">http://mirrors.aliyuncs.com/epel/6/<span class="variable">$basearch</span> </div><div class="line">mirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-6&amp;arch=<span class="variable">$basearch</span> </div><div class="line">failovermethod=priority </div><div class="line">enabled=1 </div><div class="line">gpgcheck=0</div><div class="line"></div><div class="line">[remi]</div><div class="line">name=Les RPM de remi pour Enterprise Linux 6 - <span class="variable">$basearch</span></div><div class="line"><span class="comment">#baseurl=http://rpms.famillecollet.com/enterprise/6/remi/$basearch/</span></div><div class="line">mirrorlist=http://rpms.famillecollet.com/enterprise/6/remi/mirror</div><div class="line">enabled=1</div><div class="line">gpgcheck=0</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#安装Tower</span></div><div class="line">[root@Ansible ~]<span class="comment"># wget https://releases.ansible.com/awx/setup/ansible-tower-setup-3.0.3.tar.gz</span></div><div class="line">[root@Ansible ~]<span class="comment"># tar -zxf ansible-tower-setup-3.0.3.tar.gz</span></div><div class="line">[root@Ansible ~]<span class="comment"># cd ansible-tower-setup-3.0.3</span></div><div class="line">[root@Ansible ansible-tower-setup-3.0.3]<span class="comment"># ./setup.sh</span></div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#安装到一半如果在这里报错，是因为连不上数据库，启动postgresql即可</span></div><div class="line">TASK [awx_install : Migrate the Tower database schema (may take awhile when upgrading).] ***</div><div class="line"></div><div class="line"><span class="comment">#解决办法</span></div><div class="line">[root@Ansible ~]<span class="comment"># service postgresql-9.4 initdb</span></div><div class="line">[root@Ansible ~]<span class="comment"># service postgresql-9.4 start</span></div><div class="line">[root@Ansible ~]<span class="comment"># chkconfig postgresql on</span></div><div class="line"></div><div class="line"><span class="comment">#创建用户</span></div><div class="line">[root@Ansible ~]<span class="comment"># id postgres</span></div><div class="line">uid=26(postgres) gid=26(postgres) groups=26(postgres)</div><div class="line">[root@Ansible ~]<span class="comment"># su - postgres</span></div><div class="line">-bash-4.1$ psql</div><div class="line">psql (9.4.11)</div><div class="line">Type <span class="string">"help"</span> <span class="keyword">for</span> help.</div><div class="line"></div><div class="line">postgres=<span class="comment"># CREATE ROLE awx CREATEDB PASSWORD 'admin' LOGIN; </span></div><div class="line">CREATE ROLE</div><div class="line">postgres=<span class="comment"># \q</span></div><div class="line">-bash-4.1$ <span class="built_in">exit</span></div><div class="line"><span class="built_in">logout</span></div><div class="line">[root@Ansible ~]<span class="comment"># sed -i 's#peer#md5#g' /var/lib/pgsql/9.4/data/pg_hba.conf</span></div><div class="line">[root@Ansible ~]<span class="comment"># sed -i 's#ident#md5#g' /var/lib/pgsql/9.4/data/pg_hba.conf</span></div><div class="line">[root@Ansible ~]<span class="comment"># service postgresql-9.4 restart</span></div><div class="line">Stopping postgresql-9.4 service:                           [  OK  ]</div><div class="line">Starting postgresql-9.4 service:                           [  OK  ]</div><div class="line">[root@Ansible ~]<span class="comment">#</span></div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">测试awx用户连接，输入密码连接，并创建数据库</div><div class="line">[root@Ansible ~]<span class="comment"># psql -U awx -d postgres -h 127.0.0.1</span></div><div class="line">Password <span class="keyword">for</span> user awx: </div><div class="line">psql (9.4.11)</div><div class="line">Type <span class="string">"help"</span> <span class="keyword">for</span> help.</div><div class="line"></div><div class="line">postgres=&gt; create database awx;</div><div class="line">CREATE DATABASE</div><div class="line">postgres=&gt; \q</div><div class="line">[root@Ansible ~]<span class="comment">#</span></div></pre></td></tr></table></figure>
<p>再次./setup.sh进行安装tower<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#inventory配置</span></div><div class="line">[root@Ansible ansible-tower-setup-3.0.3]<span class="comment"># grep -v ^$ inventory</span></div><div class="line">[primary]</div><div class="line">localhost ansible_connection=<span class="built_in">local</span></div><div class="line">[secondary]</div><div class="line">[database]</div><div class="line">[all:vars]</div><div class="line">admin_password=<span class="string">'admin'</span></div><div class="line">redis_password=<span class="string">'1234567'</span></div><div class="line">pg_host=<span class="string">'127.0.0.1'</span></div><div class="line">pg_port=<span class="string">'5432'</span></div><div class="line">pg_database=<span class="string">'awx'</span></div><div class="line">pg_username=<span class="string">'awx'</span></div><div class="line">pg_password=<span class="string">'admin'</span></div><div class="line">[root@Ansible ansible-tower-setup-3.0.3]<span class="comment">#</span></div><div class="line"></div><div class="line">[root@Ansible ansible-tower-setup-3.0.3]<span class="comment"># ./setup.sh</span></div><div class="line">···</div><div class="line">The setup process completed successfully.</div></pre></td></tr></table></figure></p>
<p>访问<a href="http://ip/" target="_blank" rel="external">http://ip/</a> 打开Ansible Tower Dashboard<br><img src="http://note.youdao.com/yws/api/personal/file/2F9139842F074D2BB72B5489E557F6E1?method=download&amp;shareKey=00f221946a4cbec628661e1b4e47529e" alt="image">  </p>
<p><img src="http://note.youdao.com/yws/api/personal/file/6E0779F0097A4E50BCB1180C06BC4B5E?method=download&amp;shareKey=4bfd38e9671683e36b4438b0e5f5421d" alt="image">  </p>
<p><img src="http://note.youdao.com/yws/api/personal/file/C6B06B214ECF42F89AC434B10E906B05?method=download&amp;shareKey=012de0283dbb99bbc60d74040de5e7dd" alt="image"><br>安装成功  </p>
<p>参考：<a href="http://www.jianshu.com/p/1c6aa6ceeca6" target="_blank" rel="external">http://www.jianshu.com/p/1c6aa6ceeca6</a>  </p>
<hr>
<p>本作品采用<a href="https://creativecommons.org/licenses/by/2.5/cn/" target="_blank" rel="external">知识共享署名 2.5 中国大陆许可协议</a>进行许可，欢迎转载，但转载请注明来自<a href="https://yfshare.github.io">Jack Wang Blog</a>，并保持转载后文章内容的完整。本人保留所有版权相关权利。</p>
<p>本文出自”Jack Wang Blog”：<a href="https://yfshare.github.io/2017/03/07/部署Ansible-Tower/">https://yfshare.github.io/2017/03/07/部署Ansible-Tower/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Ansible Tower (以前叫’AWX’)是能够帮助任何IT团队更容易使用Ansible的解决方案。该方案基于web&lt;br&gt;Tower允许对用户进行权限控制，即使某用户不能传送某SSH凭证，你也可以通过Tower来对该用户共享该凭证。我们可以通过图形化界面来管理Inventory，也可以对各种各样的云资源做同步。Tower可以记录所有job的日志，也可以与LDAP集成，并且拥有强大的可浏览的REST API。Tower也提供了命令行工具，可以与Jenkins轻松集成。Provisioning回调对自动伸缩拓扑图提供了强大的支持&lt;br&gt;
    
    </summary>
    
    
      <category term="Ansible" scheme="https://yfshare.github.io/tags/Ansible/"/>
    
      <category term="Tower" scheme="https://yfshare.github.io/tags/Tower/"/>
    
  </entry>
  
  <entry>
    <title>Oracle数据库备份与恢复 - RMAN备份</title>
    <link href="https://yfshare.github.io/2017/02/28/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D-RMAN%E5%A4%87%E4%BB%BD/"/>
    <id>https://yfshare.github.io/2017/02/28/Oracle数据库备份与恢复-RMAN备份/</id>
    <published>2017-02-28T02:42:42.000Z</published>
    <updated>2017-02-28T06:37:34.000Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><p>如果要说DBA工作中最重要的职责（没有之一），那无疑就是保证客户数据的安全和完整，可以看到几乎任何一本Oracle DBA的技术书籍一定都会把大篇幅来介绍数据库的备份与恢复，从中也可以看到备份和恢复的重要程度。<a href="http://www.eygle.com/" target="_blank" rel="external">eygle</a>曾经总结了<a href="http://www.eygle.com/archives/2006/03/the_four_rule_for_dba.html" target="_blank" rel="external">DBA生存之四大守则</a>的第一条就是：备份重于一切<br><em>我们必需知道,系统总是要崩溃的，没有有效的备份只是等哪一天死！我经常开玩笑的说,唯一会使DBA在梦中惊醒的就是,没有有效的备份.</em><br><a id="more"></a></p>
<h2 id="RMAN概览"><a href="#RMAN概览" class="headerlink" title="RMAN概览"></a>RMAN概览</h2><p>RMAN是Oracle数据库软件自带的备份/恢复工具。RMAN只能用于9i或更高的版本中。它能够备份整个数据库或数据库部件，如表空间、数据文件、控制文件、归档文件以及Spfile参数文件。通过RMAN的方式无论是要备份还是要恢复，都必须先启动实例并加载数据库。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">From Wiki：RMAN (Recovery Manager) is a backup and recovery manager supplied <span class="keyword">for</span> Oracle databases (from version 8) created by the Oracle Corporation. It provides database backup, restore, and recovery capabilities addressing high availability and disaster recovery concerns. Oracle Corporation recommends RMAN as its preferred method <span class="keyword">for</span> backup and recovery and has written <span class="built_in">command</span>-line and graphical (via Oracle Enterprise Manager) interfaces <span class="keyword">for</span> the product.</div></pre></td></tr></table></figure></p>
<h2 id="RMAN之备份"><a href="#RMAN之备份" class="headerlink" title="RMAN之备份"></a>RMAN之备份</h2><p>连接数据库<br>很简单，进入到命令提示符界面：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[oracle@orcl ~]$ rman target /</div><div class="line">Recovery Manager: Release 11.2.0.4.0 - Production on Tue Feb 28 10:51:34 2017</div><div class="line">Copyright (c) 1982, 2011, Oracle and/or its affiliates.  All rights reserved.</div><div class="line">connected to target database: ORCL (DBID=1455780274)</div><div class="line">RMAN&gt;</div></pre></td></tr></table></figure></p>
<p>也可以先启动RMAN，然后再通过CONNECT命令来连接目标数据库：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[oracle@orcl ~]$ rman</div><div class="line">Recovery Manager: Release 11.2.0.4.0 - Production on Tue Feb 28 10:52:45 2017</div><div class="line">Copyright (c) 1982, 2011, Oracle and/or its affiliates.  All rights reserved.</div><div class="line">RMAN&gt; connect target /</div><div class="line">connected to target database: ORCL (DBID=1455780274)</div><div class="line">RMAN&gt;</div></pre></td></tr></table></figure></p>
<p>使用RMAN来做各种类型的备份</p>
<ol>
<li>整库备份<br>整库备份的命令很简单，就是backup database<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">RMAN&gt; backup database;</div><div class="line"></div><div class="line">Starting backup at 28-FEB-17</div><div class="line">using target database control file instead of recovery catalog</div><div class="line">allocated channel: ORA_DISK_1</div><div class="line">channel ORA_DISK_1: SID=1717 device <span class="built_in">type</span>=DISK</div><div class="line">channel ORA_DISK_1: starting full datafile backup <span class="built_in">set</span></div><div class="line">channel ORA_DISK_1: specifying datafile(s) <span class="keyword">in</span> backup <span class="built_in">set</span></div><div class="line">input datafile file number=00001 name=/u01/data/orcl/system01.dbf</div><div class="line">input datafile file number=00002 name=/u01/data/orcl/sysaux01.dbf</div><div class="line">input datafile file number=00003 name=/u01/data/orcl/undotbs01.dbf</div><div class="line">input datafile file number=00004 name=/u01/data/orcl/users01.dbf</div><div class="line">input datafile file number=00007 name=/u01/data/orcl/dev_paydb.dbf</div><div class="line">input datafile file number=00008 name=/u01/data/orcl/dev_payboxdb.dbf</div><div class="line">input datafile file number=00009 name=/u01/data/orcl/ticket.dbf</div><div class="line">input datafile file number=00005 name=/u01/data/orcl/PAYBOX_FG_PRO.dbf</div><div class="line">input datafile file number=00006 name=/u01/data/orcl/PAYBOX_TEST2SP.dbf</div><div class="line">channel ORA_DISK_1: starting piece 1 at 28-FEB-17</div><div class="line">channel ORA_DISK_1: finished piece 1 at 28-FEB-17</div><div class="line">piece handle=/u01/app/oracle/product/11.2.0.4/db_1/dbs/01rtn1md_1_1 tag=TAG20170228T105613 comment=NONE</div><div class="line">channel ORA_DISK_1: backup <span class="built_in">set</span> complete, elapsed time: 00:40:26</div><div class="line">channel ORA_DISK_1: starting full datafile backup <span class="built_in">set</span></div><div class="line">channel ORA_DISK_1: specifying datafile(s) <span class="keyword">in</span> backup <span class="built_in">set</span></div><div class="line">including current control file <span class="keyword">in</span> backup <span class="built_in">set</span></div><div class="line">including current SPFILE <span class="keyword">in</span> backup <span class="built_in">set</span></div><div class="line">channel ORA_DISK_1: starting piece 1 at 28-FEB-17</div><div class="line">channel ORA_DISK_1: finished piece 1 at 28-FEB-17</div><div class="line">piece handle=/u01/app/oracle/product/11.2.0.4/db_1/dbs/02rtn428_1_1 tag=TAG20170228T105613 comment=NONE</div><div class="line">channel ORA_DISK_1: backup <span class="built_in">set</span> complete, elapsed time: 00:00:01</div><div class="line">Finished backup at 28-FEB-17</div><div class="line"></div><div class="line">RMAN&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>整库备份集生成了两个备份片段：一个存储数据文件，另一个存储控制文件和SPFILE（服务器端初始化参数文件），都被保存到Oracle软件的安装目录下，这是因为没有为备份集指定存储路径，默认情况下就会存储到Oracle软件的安装目录中</p>
<p>真正的备份操作，你肯定希望能够指定备份集的存储位置，没问题，最简单的方式是在执行BACKUP命令时，指定FORMAT参数来自定义备份片段的路径和命令规则<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">RMAN&gt; BACKUP DATABASE FORMAT <span class="string">'/u01/data/db_bk/bak_%U'</span>;</div></pre></td></tr></table></figure></p>
<p>查看创建的全库备份<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">RMAN&gt; LIST BACKUP OF DATABASE;</div><div class="line"></div><div class="line">List of Backup Sets</div><div class="line">===================</div><div class="line"></div><div class="line">BS Key  Type LV Size       Device Type Elapsed Time Completion Time</div><div class="line">------- ---- -- ---------- ----------- ------------ ---------------</div><div class="line">1       Full    4.99G      DISK        00:40:17     28-FEB-17      </div><div class="line">        BP Key: 1   Status: AVAILABLE  Compressed: NO  Tag: TAG20170228T105613</div><div class="line">        Piece Name: /u01/app/oracle/product/11.2.0.4/db_1/dbs/01rtn1md_1_1</div><div class="line">  List of Datafiles <span class="keyword">in</span> backup <span class="built_in">set</span> 1</div><div class="line">  File LV Type Ckp SCN    Ckp Time  Name</div><div class="line">  ---- -- ---- ---------- --------- ----</div><div class="line">  1       Full 37643780   28-FEB-17 /u01/data/orcl/system01.dbf</div><div class="line">  2       Full 37643780   28-FEB-17 /u01/data/orcl/sysaux01.dbf</div><div class="line">  3       Full 37643780   28-FEB-17 /u01/data/orcl/undotbs01.dbf</div><div class="line">  4       Full 37643780   28-FEB-17 /u01/data/orcl/users01.dbf</div><div class="line">  5       Full 37643780   28-FEB-17 /u01/data/orcl/PAYBOX_FG_PRO.dbf</div><div class="line">  6       Full 37643780   28-FEB-17 /u01/data/orcl/PAYBOX_TEST2SP.dbf</div><div class="line">  7       Full 37643780   28-FEB-17 /u01/data/orcl/dev_paydb.dbf</div><div class="line">  8       Full 37643780   28-FEB-17 /u01/data/orcl/dev_payboxdb.dbf</div><div class="line">  9       Full 37643780   28-FEB-17 /u01/data/orcl/ticket.dbf</div><div class="line"></div><div class="line">RMAN&gt;</div></pre></td></tr></table></figure></p>
<ol>
<li>表空间的备份<br>rman还可以针对表空间备份<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">RMAN&gt; BACKUP TABLESPACE USERS;</div><div class="line"></div><div class="line">Starting backup at 28-FEB-17</div><div class="line">using channel ORA_DISK_1</div><div class="line">channel ORA_DISK_1: starting full datafile backup <span class="built_in">set</span></div><div class="line">channel ORA_DISK_1: specifying datafile(s) <span class="keyword">in</span> backup <span class="built_in">set</span></div><div class="line">input datafile file number=00004 name=/u01/data/orcl/users01.dbf</div><div class="line">channel ORA_DISK_1: starting piece 1 at 28-FEB-17</div><div class="line">channel ORA_DISK_1: finished piece 1 at 28-FEB-17</div><div class="line">piece handle=/u01/app/oracle/product/11.2.0.4/db_1/dbs/03rtn5li_1_1 tag=TAG20170228T120402 comment=NONE</div><div class="line">channel ORA_DISK_1: backup <span class="built_in">set</span> complete, elapsed time: 00:01:05</div><div class="line">Finished backup at 28-FEB-17</div><div class="line"></div><div class="line">RMAN&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>查看表空间的备份<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">RMAN&gt; LIST BACKUP OF TABLESPACE USERS;</div><div class="line"></div><div class="line">List of Backup Sets</div><div class="line">===================</div><div class="line"></div><div class="line">BS Key  Type LV Size       Device Type Elapsed Time Completion Time</div><div class="line">------- ---- -- ---------- ----------- ------------ ---------------</div><div class="line">1       Full    4.99G      DISK        00:40:17     28-FEB-17      </div><div class="line">        BP Key: 1   Status: AVAILABLE  Compressed: NO  Tag: TAG20170228T105613</div><div class="line">        Piece Name: /u01/app/oracle/product/11.2.0.4/db_1/dbs/01rtn1md_1_1</div><div class="line">  List of Datafiles <span class="keyword">in</span> backup <span class="built_in">set</span> 1</div><div class="line">  File LV Type Ckp SCN    Ckp Time  Name</div><div class="line">  ---- -- ---- ---------- --------- ----</div><div class="line">  4       Full 37643780   28-FEB-17 /u01/data/orcl/users01.dbf</div><div class="line"></div><div class="line">BS Key  Type LV Size       Device Type Elapsed Time Completion Time</div><div class="line">------- ---- -- ---------- ----------- ------------ ---------------</div><div class="line">3       Full    415.72M    DISK        00:00:59     28-FEB-17      </div><div class="line">        BP Key: 3   Status: AVAILABLE  Compressed: NO  Tag: TAG20170228T120402</div><div class="line">        Piece Name: /u01/app/oracle/product/11.2.0.4/db_1/dbs/03rtn5li_1_1</div><div class="line">  List of Datafiles <span class="keyword">in</span> backup <span class="built_in">set</span> 3</div><div class="line">  File LV Type Ckp SCN    Ckp Time  Name</div><div class="line">  ---- -- ---- ---------- --------- ----</div><div class="line">  4       Full 37647157   28-FEB-17 /u01/data/orcl/users01.dbf</div><div class="line"></div><div class="line">RMAN&gt;</div></pre></td></tr></table></figure></p>
<p>这里发现USER表空间存在2份备份（因为之前做过一次全量备份）</p>
<p>删除指定的BACKUPSET<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">RMAN&gt; DELETE BACKUPSET 3;</div><div class="line">using channel ORA_DISK_1</div><div class="line"></div><div class="line">List of Backup Pieces</div><div class="line">BP Key  BS Key  Pc<span class="comment"># Cp# Status      Device Type Piece Name</span></div><div class="line">------- ------- --- --- ----------- ----------- ----------</div><div class="line">3       3       1   1   AVAILABLE   DISK        /u01/app/oracle/product/11.2.0.4/db_1/dbs/03rtn5li_1_1</div><div class="line"></div><div class="line">Do you really want to delete the above objects (enter YES or NO)? YES</div><div class="line">deleted backup piece</div><div class="line">backup piece handle=/u01/app/oracle/product/11.2.0.4/db_1/dbs/03rtn5li_1_1 RECID=3 STAMP=937137843</div><div class="line">Deleted 1 objects</div><div class="line"></div><div class="line">RMAN&gt;</div></pre></td></tr></table></figure></p>
<ol>
<li>数据文件的备份<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">SQL&gt; select file<span class="comment">#,name from v$datafile;</span></div><div class="line"></div><div class="line">     FILE<span class="comment"># NAME</span></div><div class="line">---------- --------------------------------------------------</div><div class="line">	 1 /u01/data/orcl/system01.dbf</div><div class="line">	 2 /u01/data/orcl/sysaux01.dbf</div><div class="line">	 3 /u01/data/orcl/undotbs01.dbf</div><div class="line">	 4 /u01/data/orcl/users01.dbf</div><div class="line">	 5 /u01/data/orcl/PAYBOX_FG_PRO.dbf</div><div class="line">	 6 /u01/data/orcl/PAYBOX_TEST2SP.dbf</div><div class="line">	 7 /u01/data/orcl/dev_paydb.dbf</div><div class="line">	 8 /u01/data/orcl/dev_payboxdb.dbf</div><div class="line">	 9 /u01/data/orcl/ticket.dbf</div><div class="line"></div><div class="line">9 rows selected.</div><div class="line"></div><div class="line">SQL&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">RMAN&gt; BACKUP DATAFILE <span class="string">'/u01/data/orcl/users01.dbf'</span>;</div><div class="line"></div><div class="line">Starting backup at 28-FEB-17</div><div class="line">using channel ORA_DISK_1</div><div class="line">channel ORA_DISK_1: starting full datafile backup <span class="built_in">set</span></div><div class="line">channel ORA_DISK_1: specifying datafile(s) <span class="keyword">in</span> backup <span class="built_in">set</span></div><div class="line">input datafile file number=00004 name=/u01/data/orcl/users01.dbf</div><div class="line">channel ORA_DISK_1: starting piece 1 at 28-FEB-17</div><div class="line">channel ORA_DISK_1: finished piece 1 at 28-FEB-17</div><div class="line">piece handle=/u01/app/oracle/product/11.2.0.4/db_1/dbs/04rtn83l_1_1 tag=TAG20170228T124540 comment=NONE</div><div class="line">channel ORA_DISK_1: backup <span class="built_in">set</span> complete, elapsed time: 00:00:07</div><div class="line">Finished backup at 28-FEB-17</div><div class="line"></div><div class="line">RMAN&gt;</div></pre></td></tr></table></figure>
<ol>
<li>控制文件备份<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">RMAN&gt; BACKUP CURRENT CONTROLFILE;</div><div class="line"></div><div class="line">Starting backup at 28-FEB-17</div><div class="line">using channel ORA_DISK_1</div><div class="line">channel ORA_DISK_1: starting full datafile backup <span class="built_in">set</span></div><div class="line">channel ORA_DISK_1: specifying datafile(s) <span class="keyword">in</span> backup <span class="built_in">set</span></div><div class="line">including current control file <span class="keyword">in</span> backup <span class="built_in">set</span></div><div class="line">channel ORA_DISK_1: starting piece 1 at 28-FEB-17</div><div class="line">channel ORA_DISK_1: finished piece 1 at 28-FEB-17</div><div class="line">piece handle=/u01/app/oracle/product/11.2.0.4/db_1/dbs/05rtn873_1_1 tag=TAG20170228T124731 comment=NONE</div><div class="line">channel ORA_DISK_1: backup <span class="built_in">set</span> complete, elapsed time: 00:00:01</div><div class="line">Finished backup at 28-FEB-17</div><div class="line"></div><div class="line">RMAN&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>查看控制文件备份<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">RMAN&gt; LIST BACKUP OF CONTROLFILE;</div><div class="line"></div><div class="line">List of Backup Sets</div><div class="line">===================</div><div class="line"></div><div class="line">BS Key  Type LV Size       Device Type Elapsed Time Completion Time</div><div class="line">------- ---- -- ---------- ----------- ------------ ---------------</div><div class="line">2       Full    9.39M      DISK        00:00:05     28-FEB-17      </div><div class="line">        BP Key: 2   Status: AVAILABLE  Compressed: NO  Tag: TAG20170228T105613</div><div class="line">        Piece Name: /u01/app/oracle/product/11.2.0.4/db_1/dbs/02rtn428_1_1</div><div class="line">  Control File Included: Ckp SCN: 37645877     Ckp time: 28-FEB-17</div><div class="line"></div><div class="line">BS Key  Type LV Size       Device Type Elapsed Time Completion Time</div><div class="line">------- ---- -- ---------- ----------- ------------ ---------------</div><div class="line">5       Full    9.36M      DISK        00:00:01     28-FEB-17      </div><div class="line">        BP Key: 5   Status: AVAILABLE  Compressed: NO  Tag: TAG20170228T124731</div><div class="line">        Piece Name: /u01/app/oracle/product/11.2.0.4/db_1/dbs/05rtn873_1_1</div><div class="line">  Control File Included: Ckp SCN: 37648397     Ckp time: 28-FEB-17</div><div class="line"></div><div class="line">RMAN&gt;</div></pre></td></tr></table></figure></p>
<ol>
<li>归档文件的备份<br>归档日志对于数据库介质恢复相当关键，只要拥有相应的归档日志文件，就能确保我们将数据库恢复到备份之后的任意时刻。在RMAN中备份归档日志有以下两种方式：</li>
</ol>
<ul>
<li>利用BACKUP ARCHIVELOG命令备份<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">RMAN&gt; BACKUP ARCHIVELOG ALL;</div><div class="line"></div><div class="line">Starting backup at 28-FEB-17</div><div class="line">current <span class="built_in">log</span> archived</div><div class="line">using channel ORA_DISK_1</div><div class="line">channel ORA_DISK_1: starting archived <span class="built_in">log</span> backup <span class="built_in">set</span></div><div class="line">channel ORA_DISK_1: specifying archived <span class="built_in">log</span>(s) <span class="keyword">in</span> backup <span class="built_in">set</span></div><div class="line">input archived <span class="built_in">log</span> thread=1 sequence=868 RECID=1 STAMP=937050974</div><div class="line">input archived <span class="built_in">log</span> thread=1 sequence=871 RECID=2 STAMP=937050978</div><div class="line">input archived <span class="built_in">log</span> thread=1 sequence=872 RECID=3 STAMP=937050981</div><div class="line">input archived <span class="built_in">log</span> thread=1 sequence=873 RECID=4 STAMP=937052764</div><div class="line">input archived <span class="built_in">log</span> thread=1 sequence=874 RECID=5 STAMP=937052771</div><div class="line">input archived <span class="built_in">log</span> thread=1 sequence=875 RECID=6 STAMP=937073029</div><div class="line">input archived <span class="built_in">log</span> thread=1 sequence=876 RECID=7 STAMP=937079244</div><div class="line">input archived <span class="built_in">log</span> thread=1 sequence=877 RECID=8 STAMP=937087288</div><div class="line">input archived <span class="built_in">log</span> thread=1 sequence=878 RECID=9 STAMP=937108830</div><div class="line">input archived <span class="built_in">log</span> thread=1 sequence=879 RECID=10 STAMP=937124801</div><div class="line">input archived <span class="built_in">log</span> thread=1 sequence=880 RECID=11 STAMP=937140632</div><div class="line">channel ORA_DISK_1: starting piece 1 at 28-FEB-17</div><div class="line">channel ORA_DISK_1: finished piece 1 at 28-FEB-17</div><div class="line">piece handle=/u01/app/oracle/product/11.2.0.4/db_1/dbs/06rtn8cp_1_1 tag=TAG20170228T125032 comment=NONE</div><div class="line">channel ORA_DISK_1: backup <span class="built_in">set</span> complete, elapsed time: 00:00:15</div><div class="line">Finished backup at 28-FEB-17</div><div class="line"></div><div class="line">RMAN&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>BACKUP ARCHIVELOG命令比较灵活，ALL是指备份当前所有可访问到的归档文件，你还可以通过UNTIL、SCN、TIME、SEQUENCE等参数灵活指定要备份的归档区间。</p>
<ul>
<li>执行BACKUP命令时指定PLUS ARCHIVELOG子句<br>在备份控制文件之前<strong>首先对所有归档文件进行备份</strong>，BACKUP…PLUS ARCHIVELOG命令在备份过程中会依次执行下列步骤:</li>
</ul>
<ol>
<li>运行ALTER SYSTEM ARCHIVE LOG CURRENT语句对当前 Redolog 进行归档</li>
<li>执行BACKUP ARCHIVELOG ALL命令备份所有已归档日志</li>
<li>执行BACKUP命令对指定项进行备份</li>
<li>再次运行ALTER SYSTEM ARCHIVE LOG CURRENT对当前 Redolog 归档</li>
<li>对新生成的尚未备份的归档文件进行备份<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line">RMAN&gt; BACKUP CURRENT CONTROLFILE PLUS ARCHIVELOG;</div><div class="line"></div><div class="line">Starting backup at 28-FEB-17</div><div class="line">current <span class="built_in">log</span> archived</div><div class="line">using channel ORA_DISK_1</div><div class="line">channel ORA_DISK_1: starting archived <span class="built_in">log</span> backup <span class="built_in">set</span></div><div class="line">channel ORA_DISK_1: specifying archived <span class="built_in">log</span>(s) <span class="keyword">in</span> backup <span class="built_in">set</span></div><div class="line">input archived <span class="built_in">log</span> thread=1 sequence=868 RECID=1 STAMP=937050974</div><div class="line">input archived <span class="built_in">log</span> thread=1 sequence=871 RECID=2 STAMP=937050978</div><div class="line">input archived <span class="built_in">log</span> thread=1 sequence=872 RECID=3 STAMP=937050981</div><div class="line">input archived <span class="built_in">log</span> thread=1 sequence=873 RECID=4 STAMP=937052764</div><div class="line">input archived <span class="built_in">log</span> thread=1 sequence=874 RECID=5 STAMP=937052771</div><div class="line">input archived <span class="built_in">log</span> thread=1 sequence=875 RECID=6 STAMP=937073029</div><div class="line">input archived <span class="built_in">log</span> thread=1 sequence=876 RECID=7 STAMP=937079244</div><div class="line">input archived <span class="built_in">log</span> thread=1 sequence=877 RECID=8 STAMP=937087288</div><div class="line">input archived <span class="built_in">log</span> thread=1 sequence=878 RECID=9 STAMP=937108830</div><div class="line">input archived <span class="built_in">log</span> thread=1 sequence=879 RECID=10 STAMP=937124801</div><div class="line">input archived <span class="built_in">log</span> thread=1 sequence=880 RECID=11 STAMP=937140632</div><div class="line">input archived <span class="built_in">log</span> thread=1 sequence=881 RECID=12 STAMP=937140870</div><div class="line">channel ORA_DISK_1: starting piece 1 at 28-FEB-17</div><div class="line">channel ORA_DISK_1: finished piece 1 at 28-FEB-17</div><div class="line">piece handle=/u01/app/oracle/product/11.2.0.4/db_1/dbs/07rtn8k6_1_1 tag=TAG20170228T125430 comment=NONE</div><div class="line">channel ORA_DISK_1: backup <span class="built_in">set</span> complete, elapsed time: 00:00:03</div><div class="line">Finished backup at 28-FEB-17</div><div class="line"></div><div class="line">Starting backup at 28-FEB-17</div><div class="line">using channel ORA_DISK_1</div><div class="line">channel ORA_DISK_1: starting full datafile backup <span class="built_in">set</span></div><div class="line">channel ORA_DISK_1: specifying datafile(s) <span class="keyword">in</span> backup <span class="built_in">set</span></div><div class="line">including current control file <span class="keyword">in</span> backup <span class="built_in">set</span></div><div class="line">channel ORA_DISK_1: starting piece 1 at 28-FEB-17</div><div class="line">channel ORA_DISK_1: finished piece 1 at 28-FEB-17</div><div class="line">piece handle=/u01/app/oracle/product/11.2.0.4/db_1/dbs/08rtn8ka_1_1 tag=TAG20170228T125434 comment=NONE</div><div class="line">channel ORA_DISK_1: backup <span class="built_in">set</span> complete, elapsed time: 00:00:01</div><div class="line">Finished backup at 28-FEB-17</div><div class="line"></div><div class="line">Starting backup at 28-FEB-17</div><div class="line">current <span class="built_in">log</span> archived</div><div class="line">using channel ORA_DISK_1</div><div class="line">channel ORA_DISK_1: starting archived <span class="built_in">log</span> backup <span class="built_in">set</span></div><div class="line">channel ORA_DISK_1: specifying archived <span class="built_in">log</span>(s) <span class="keyword">in</span> backup <span class="built_in">set</span></div><div class="line">input archived <span class="built_in">log</span> thread=1 sequence=882 RECID=13 STAMP=937140878</div><div class="line">channel ORA_DISK_1: starting piece 1 at 28-FEB-17</div><div class="line">channel ORA_DISK_1: finished piece 1 at 28-FEB-17</div><div class="line">piece handle=/u01/app/oracle/product/11.2.0.4/db_1/dbs/09rtn8ke_1_1 tag=TAG20170228T125438 comment=NONE</div><div class="line">channel ORA_DISK_1: backup <span class="built_in">set</span> complete, elapsed time: 00:00:01</div><div class="line">Finished backup at 28-FEB-17</div><div class="line"></div><div class="line">RMAN&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>完成备份之后，可以通过下列命令查看已备份的归档日志片段<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line">RMAN&gt; LIST BACKUP OF ARCHIVELOG ALL;</div><div class="line"></div><div class="line">List of Backup Sets</div><div class="line">===================</div><div class="line"></div><div class="line">BS Key  Size       Device Type Elapsed Time Completion Time</div><div class="line">------- ---------- ----------- ------------ ---------------</div><div class="line">6       319.98M    DISK        00:00:07     28-FEB-17      </div><div class="line">        BP Key: 6   Status: AVAILABLE  Compressed: NO  Tag: TAG20170228T125032</div><div class="line">        Piece Name: /u01/app/oracle/product/11.2.0.4/db_1/dbs/06rtn8cp_1_1</div><div class="line"></div><div class="line">  List of Archived Logs <span class="keyword">in</span> backup <span class="built_in">set</span> 6</div><div class="line">  Thrd Seq     Low SCN    Low Time  Next SCN   Next Time</div><div class="line">  ---- ------- ---------- --------- ---------- ---------</div><div class="line">  1    868     37498935   24-FEB-17 37505736   24-FEB-17</div><div class="line">  1    871     37537046   25-FEB-17 37548296   25-FEB-17</div><div class="line">  1    872     37548296   25-FEB-17 37574822   27-FEB-17</div><div class="line">  1    873     37574822   27-FEB-17 37577191   27-FEB-17</div><div class="line">  1    874     37577191   27-FEB-17 37577232   27-FEB-17</div><div class="line">  1    875     37577232   27-FEB-17 37592150   27-FEB-17</div><div class="line">  1    876     37592150   27-FEB-17 37596510   27-FEB-17</div><div class="line">  1    877     37596510   27-FEB-17 37607071   27-FEB-17</div><div class="line">  1    878     37607071   27-FEB-17 37631135   28-FEB-17</div><div class="line">  1    879     37631135   28-FEB-17 37638288   28-FEB-17</div><div class="line">  1    880     37638288   28-FEB-17 37648486   28-FEB-17</div><div class="line"></div><div class="line">BS Key  Size       Device Type Elapsed Time Completion Time</div><div class="line">------- ---------- ----------- ------------ ---------------</div><div class="line">7       319.98M    DISK        00:00:03     28-FEB-17      </div><div class="line">        BP Key: 7   Status: AVAILABLE  Compressed: NO  Tag: TAG20170228T125430</div><div class="line">        Piece Name: /u01/app/oracle/product/11.2.0.4/db_1/dbs/07rtn8k6_1_1</div><div class="line"></div><div class="line">  List of Archived Logs <span class="keyword">in</span> backup <span class="built_in">set</span> 7</div><div class="line">  Thrd Seq     Low SCN    Low Time  Next SCN   Next Time</div><div class="line">  ---- ------- ---------- --------- ---------- ---------</div><div class="line">  1    868     37498935   24-FEB-17 37505736   24-FEB-17</div><div class="line">  1    871     37537046   25-FEB-17 37548296   25-FEB-17</div><div class="line">  1    872     37548296   25-FEB-17 37574822   27-FEB-17</div><div class="line">  1    873     37574822   27-FEB-17 37577191   27-FEB-17</div><div class="line">  1    874     37577191   27-FEB-17 37577232   27-FEB-17</div><div class="line">  1    875     37577232   27-FEB-17 37592150   27-FEB-17</div><div class="line">  1    876     37592150   27-FEB-17 37596510   27-FEB-17</div><div class="line">  1    877     37596510   27-FEB-17 37607071   27-FEB-17</div><div class="line">  1    878     37607071   27-FEB-17 37631135   28-FEB-17</div><div class="line">  1    879     37631135   28-FEB-17 37638288   28-FEB-17</div><div class="line">  1    880     37638288   28-FEB-17 37648486   28-FEB-17</div><div class="line">  1    881     37648486   28-FEB-17 37648591   28-FEB-17</div><div class="line"></div><div class="line">BS Key  Size       Device Type Elapsed Time Completion Time</div><div class="line">------- ---------- ----------- ------------ ---------------</div><div class="line">9       2.50K      DISK        00:00:00     28-FEB-17      </div><div class="line">        BP Key: 9   Status: AVAILABLE  Compressed: NO  Tag: TAG20170228T125438</div><div class="line">        Piece Name: /u01/app/oracle/product/11.2.0.4/db_1/dbs/09rtn8ke_1_1</div><div class="line"></div><div class="line">  List of Archived Logs <span class="keyword">in</span> backup <span class="built_in">set</span> 9</div><div class="line">  Thrd Seq     Low SCN    Low Time  Next SCN   Next Time</div><div class="line">  ---- ------- ---------- --------- ---------- ---------</div><div class="line">  1    882     37648591   28-FEB-17 37648602   28-FEB-17</div><div class="line"></div><div class="line">RMAN&gt;</div></pre></td></tr></table></figure></p>
<ol>
<li><p>初始化参数文件的备份</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">RMAN&gt; BACKUP SPFILE;</div><div class="line"></div><div class="line">Starting backup at 28-FEB-17</div><div class="line">using channel ORA_DISK_1</div><div class="line">channel ORA_DISK_1: starting full datafile backup <span class="built_in">set</span></div><div class="line">channel ORA_DISK_1: specifying datafile(s) <span class="keyword">in</span> backup <span class="built_in">set</span></div><div class="line">including current SPFILE <span class="keyword">in</span> backup <span class="built_in">set</span></div><div class="line">channel ORA_DISK_1: starting piece 1 at 28-FEB-17</div><div class="line">channel ORA_DISK_1: finished piece 1 at 28-FEB-17</div><div class="line">piece handle=/u01/app/oracle/product/11.2.0.4/db_1/dbs/0artn91l_1_1 tag=TAG20170228T130141 comment=NONE</div><div class="line">channel ORA_DISK_1: backup <span class="built_in">set</span> complete, elapsed time: 00:00:01</div><div class="line">Finished backup at 28-FEB-17</div><div class="line"></div><div class="line">RMAN&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>对备份集备份</p>
</li>
</ol>
<ul>
<li><p>备份所有备份集</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">RMAN&gt; BACKUP BACKUPSET ALL;</div></pre></td></tr></table></figure>
</li>
<li><p>备份指定的备份集</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#n=备份集ID，可以同时指定多个，相互间以逗号分隔即可</span></div><div class="line">RMAN&gt; BACKUP BACKUPSET n;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>参考：<a href="http://blog.csdn.net/pan_tian/article/details/46766985" target="_blank" rel="external">http://blog.csdn.net/pan_tian/article/details/46766985</a></p>
<hr>
<p>本作品采用<a href="https://creativecommons.org/licenses/by/2.5/cn/" target="_blank" rel="external">知识共享署名 2.5 中国大陆许可协议</a>进行许可，欢迎转载，但转载请注明来自<a href="https://yfshare.github.io">Jack Wang Blog</a>，并保持转载后文章内容的完整。本人保留所有版权相关权利。</p>
<p>本文出自”Jack Wang Blog”：<a href="https://yfshare.github.io/2017/02/28/Oracle数据库备份与恢复-RMAN备份/">https://yfshare.github.io/2017/02/28/Oracle数据库备份与恢复-RMAN备份/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;如果要说DBA工作中最重要的职责（没有之一），那无疑就是保证客户数据的安全和完整，可以看到几乎任何一本Oracle DBA的技术书籍一定都会把大篇幅来介绍数据库的备份与恢复，从中也可以看到备份和恢复的重要程度。&lt;a href=&quot;http://www.eygle.com/&quot;&gt;eygle&lt;/a&gt;曾经总结了&lt;a href=&quot;http://www.eygle.com/archives/2006/03/the_four_rule_for_dba.html&quot;&gt;DBA生存之四大守则&lt;/a&gt;的第一条就是：备份重于一切&lt;br&gt;&lt;em&gt;我们必需知道,系统总是要崩溃的，没有有效的备份只是等哪一天死！我经常开玩笑的说,唯一会使DBA在梦中惊醒的就是,没有有效的备份.&lt;/em&gt;&lt;br&gt;
    
    </summary>
    
      <category term="oracle" scheme="https://yfshare.github.io/categories/oracle/"/>
    
    
      <category term="oracle" scheme="https://yfshare.github.io/tags/oracle/"/>
    
      <category term="RMAN" scheme="https://yfshare.github.io/tags/RMAN/"/>
    
  </entry>
  
  <entry>
    <title>Oracle数据库备份与恢复 - RMAN恢复</title>
    <link href="https://yfshare.github.io/2017/02/28/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D-RMAN%E6%81%A2%E5%A4%8D/"/>
    <id>https://yfshare.github.io/2017/02/28/Oracle数据库备份与恢复-RMAN恢复/</id>
    <published>2017-02-28T02:06:46.000Z</published>
    <updated>2017-02-28T07:32:24.000Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><h2 id="RMAN恢复原理"><a href="#RMAN恢复原理" class="headerlink" title="RMAN恢复原理"></a>RMAN恢复原理</h2><p>首先还是得理解Oracle数据库恢复的一个原理。数据库恢复是指将数据库恢复到一个一致性的状态，整个恢复操作可以分为两个步骤，数据库修复（RESTORE）和恢复（RECOVER）<br><a href="https://docs.oracle.com/cd/B19306_01/backup.102/b14192/recov001.htm" target="_blank" rel="external">Oracle官方文档</a>上关于Restore和Recover的解释：<br> The two most important RMAN commands used in database recovery are:  </p>
<ul>
<li>RESTORE, which retrieves files from RMAN backups based on the contents of the RMAN repository</li>
<li><p>RECOVER, which performs complete or point-in-time media recovery using available datafiles and redo logs.<br>Restore是指将要恢复的文件从备份集中读取出来。<br>Recover是指应用所有重做日志，将数据库恢复到崩溃前的状态，或者应用部分REDO，将数据库恢复到指定的时间点。<br><img src="http://note.youdao.com/yws/api/personal/file/1D33C7DE579145B8A0B4B2527036349C?method=download&amp;shareKey=839a02001f760c7413f2370bc57a0092" alt="image"><br>上图是一个最典型的恢复过程，数据库在SCN=100时执行了数据库备份，在SCN=500时数据库出现介质错误，需要通过备份进行恢复  </p>
<p>操作步骤：  </p>
</li>
</ul>
<ol>
<li>首先使用SCN=100时创建的数据库备份将数据库恢复到备份时的状态，这个操作就是修复（RESTORE）</li>
<li>然后重新应用SCN 100～500之间生成的所有重做日志，这个操作就是恢复（RECOVER），最后数据库被恢复到崩溃前的状态。<br>由上可知，Oracle数据库中的备份恢复必然是先有备份，然后才能做恢复的操作。不管是RMAN备份恢复，或者是用户管理的备份和恢复，恢复操作都是从备份时间点向前进行恢复，不可能直接将当前状态向后恢复到之前的某个时间点（Oracle 10g R2新推出的Flashback Database特性开始支持，直接从当前时间点向之前的时间点恢复）</li>
</ol>
<h2 id="RMAN如何选择备份集"><a href="#RMAN如何选择备份集" class="headerlink" title="RMAN如何选择备份集"></a>RMAN如何选择备份集</h2><p>很多新接触RMAN的朋友都会有这样的疑问：我执行过很多次备份，早也备份是晚也备份，昨天也备份今天也备份，在恢复的时候，RMAN怎么知道从哪个备份集中选择文件用来恢复呢？<br>答案其实很简单，RMAN一开始也不知道，它只是遵循固定的规则，按照你的要求去寻找合适的备份集罢了，<strong>首先是寻找最近的可用的备份集</strong>（如果没有指定UNTIL子句则从最近的备份开始，如果指定了UNTIL，则从满足UNTIL的备份集开始），<strong>如果能找到，那么运气不错，恢复将会继续正常进行，如果找到了多个，还有更加细致的规则，从中选择一个RMAN觉着最优的备份集来做恢复</strong>（如优先选择镜像复制，因为RMAN认为这样恢复时会更快）。如果最终一个备份集都没找到，嘿嘿，那就只有一个选择了：报错  </p>
<h2 id="RMAN能做哪些恢复"><a href="#RMAN能做哪些恢复" class="headerlink" title="RMAN能做哪些恢复"></a>RMAN能做哪些恢复</h2><p>之前的文章<a href="https://yfshare.github.io/2017/02/28/Oracle数据库备份与恢复-RMAN备份/">Oracle数据库备份与恢复 - RMAN备份</a>里有写到RMAN可以做多种备份，包括：</p>
<ol>
<li>整库备份；</li>
<li>表空间的备份；</li>
<li>数据文件的备份；</li>
<li>控制文件备份；</li>
<li>归档文件的备份；</li>
<li>初始化参数文件的备份；  </li>
<li>对备份集备份；  </li>
</ol>
<p>对于恢复，RMAN中提供了多种不同级别的恢复方式，可以恢复整个数据库，恢复某个或某几个表空间，某个或某几个数据文件，单独恢复控制文件，初始化参数文件，或者归档文件等等。能用RMAN备份的都能恢复</p>
<h2 id="RMAN之恢复"><a href="#RMAN之恢复" class="headerlink" title="RMAN之恢复"></a>RMAN之恢复</h2><ol>
<li>对数据库进行完全恢复  </li>
</ol>
<p>如果当前数据库只剩下控制文件和SPFILE，其他数据文件因为某些原因导致全部丢失，不过幸运的是之前创建过整库的备份，并且执行备份操作之后，所有的归档文件和重做日志文件都还在，这种情况下你就可以将数据库恢复到崩溃前那一刻的状态，而这种恢复方式，就叫做完全介质恢复。<br>做数据库完全恢复，需要数据库处于MOUNT状态（如果数据库处于OPEN状态会报ORA-19573错误）<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#启动数据库到加载状态：</span></div><div class="line">RMAN&gt; STARTUP MOUNT;</div><div class="line"></div><div class="line">connected to target database (not started)</div><div class="line">Oracle instance started</div><div class="line">database mounted</div><div class="line"></div><div class="line">Total System Global Area    1071333376 bytes</div><div class="line"></div><div class="line">Fixed Size                     1375792 bytes</div><div class="line">Variable Size                637534672 bytes</div><div class="line">Database Buffers             427819008 bytes</div><div class="line">Redo Buffers                   4603904 bytes</div></pre></td></tr></table></figure></p>
<p>执行恢复操作(恢复分两步，先执行RESTORE DATABASE;，在执行RECOVER DATABASE;)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">RMAN&gt; restore database;</div><div class="line"></div><div class="line">Starting restore at 15-JUL-15</div><div class="line">allocated channel: ORA_DISK_1</div><div class="line">channel ORA_DISK_1: SID=63 device <span class="built_in">type</span>=DISK</div><div class="line"></div><div class="line">channel ORA_DISK_1: restoring datafile 00001</div><div class="line">input datafile copy RECID=2 STAMP=884555266 file name=E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\DATAFILE\O1_MF_SYSTEM_BSTBH904_.DBF</div><div class="line">destination <span class="keyword">for</span> restore of datafile 00001: E:\APP\TIANPAN\ORADATA\PTIAN\SYSTEM01.DBF</div><div class="line">channel ORA_DISK_1: copied datafile copy of datafile 00001</div><div class="line">output file name=E:\APP\TIANPAN\ORADATA\PTIAN\SYSTEM01.DBF RECID=0 STAMP=0</div><div class="line">channel ORA_DISK_1: restoring datafile 00002</div><div class="line">input datafile copy RECID=3 STAMP=884555292 file name=E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\DATAFILE\O1_MF_SYSAUX_BSTBJDFQ_.DBF</div><div class="line">destination <span class="keyword">for</span> restore of datafile 00002: E:\APP\TIANPAN\ORADATA\PTIAN\SYSAUX01.DBF</div><div class="line">channel ORA_DISK_1: copied datafile copy of datafile 00002</div><div class="line">output file name=E:\APP\TIANPAN\ORADATA\PTIAN\SYSAUX01.DBF RECID=0 STAMP=0</div><div class="line">channel ORA_DISK_1: restoring datafile 00003</div><div class="line">input datafile copy RECID=4 STAMP=884555305 file name=E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\DATAFILE\O1_MF_UNDOTBS1_BSTBK5V1_.DBF</div><div class="line">destination <span class="keyword">for</span> restore of datafile 00003: E:\APP\TIANPAN\ORADATA\PTIAN\UNDOTBS01.DBF</div><div class="line">channel ORA_DISK_1: copied datafile copy of datafile 00003</div><div class="line">output file name=E:\APP\TIANPAN\ORADATA\PTIAN\UNDOTBS01.DBF RECID=0 STAMP=0</div><div class="line">channel ORA_DISK_1: restoring datafile 00004</div><div class="line">input datafile copy RECID=7 STAMP=884555314 file name=E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\DATAFILE\O1_MF_USERS_BSTBKKVB_.DBF</div><div class="line">destination <span class="keyword">for</span> restore of datafile 00004: E:\APP\TIANPAN\ORADATA\PTIAN\USERS01.DBF</div><div class="line">channel ORA_DISK_1: copied datafile copy of datafile 00004</div><div class="line">output file name=E:\APP\TIANPAN\ORADATA\PTIAN\USERS01.DBF RECID=0 STAMP=0</div><div class="line">channel ORA_DISK_1: restoring datafile 00005</div><div class="line">input datafile copy RECID=5 STAMP=884555312 file name=E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\DATAFILE\O1_MF_EXAMPLE_BSTBKF80_.DBF</div><div class="line">destination <span class="keyword">for</span> restore of datafile 00005: E:\APP\TIANPAN\ORADATA\PTIAN\EXAMPLE01.DBF</div><div class="line">channel ORA_DISK_1: copied datafile copy of datafile 00005</div><div class="line">output file name=E:\APP\TIANPAN\ORADATA\PTIAN\EXAMPLE01.DBF RECID=0 STAMP=0</div><div class="line">Finished restore at 15-JUL-15</div></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">RMAN&gt; RECOVER DATABASE;</div><div class="line"></div><div class="line">Starting recover at 15-JUL-15</div><div class="line">using channel ORA_DISK_1</div><div class="line"></div><div class="line">starting media recovery</div><div class="line"></div><div class="line">archived <span class="built_in">log</span> <span class="keyword">for</span> thread 1 with sequence 105 is already on disk as file E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\ARCHIVELOG\2015_07_09\O1_MF_1_105_BSWC39YH_.ARC</div><div class="line">archived <span class="built_in">log</span> <span class="keyword">for</span> thread 1 with sequence 106 is already on disk as file E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\ARCHIVELOG\2015_07_10\O1_MF_1_106_BSYCRLNG_.ARC</div><div class="line">archived <span class="built_in">log</span> <span class="keyword">for</span> thread 1 with sequence 107 is already on disk as file E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\ARCHIVELOG\2015_07_11\O1_MF_1_107_BT10F9Y9_.ARC</div><div class="line">archived <span class="built_in">log</span> <span class="keyword">for</span> thread 1 with sequence 108 is already on disk as file E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\ARCHIVELOG\2015_07_11\O1_MF_1_108_BT1M9PW5_.ARC</div><div class="line">archived <span class="built_in">log</span> <span class="keyword">for</span> thread 1 with sequence 109 is already on disk as file E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\ARCHIVELOG\2015_07_15\O1_MF_1_109_BTCH29LR_.ARC</div><div class="line">archived <span class="built_in">log</span> file name=E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\ARCHIVELOG\2015_07_09\O1_MF_1_105_BSWC39YH_.ARC thread=1 sequence=105</div><div class="line">archived <span class="built_in">log</span> file name=E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\ARCHIVELOG\2015_07_10\O1_MF_1_106_BSYCRLNG_.ARC thread=1 sequence=106</div><div class="line">archived <span class="built_in">log</span> file name=E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\ARCHIVELOG\2015_07_11\O1_MF_1_107_BT10F9Y9_.ARC thread=1 sequence=107</div><div class="line">media recovery complete, elapsed time: 00:00:22</div><div class="line">Finished recover at 15-JUL-15</div><div class="line"></div><div class="line">RMAN&gt;</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#打开数据库： </span></div><div class="line">RMAN&gt;  ALTER DATABASE OPEN;</div><div class="line"></div><div class="line">database opened</div><div class="line"></div><div class="line">RMAN&gt;</div></pre></td></tr></table></figure>
<ol>
<li>表空间恢复  </li>
</ol>
<p>在执行恢复之前，如果被操作的表空间未处于OFFLINE状态，必须首先通过ALTER TABLESPACE tablespace_name OFFLINE语句将其置为脱机<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">SQL&gt; select * from v<span class="variable">$tablespace</span>;</div><div class="line">       TS<span class="comment"># NAME                           INCLUDED_IN_DATABASE_BACKUP BIGFILE FLASHBACK_ON ENCRYPT_IN_BACKUP</span></div><div class="line">---------- ------------------------------ --------------------------- ------- ------------ -----------------</div><div class="line">         0 SYSTEM                         YES                         NO      YES          </div><div class="line">         1 SYSAUX                         YES                         NO      YES          </div><div class="line">         2 UNDOTBS1                       YES                         NO      YES          </div><div class="line">         4 USERS                          YES                         NO      YES          </div><div class="line">         3 TEMP                           NO                          NO      YES          </div><div class="line">         6 EXAMPLE                        YES                         NO      YES          </div><div class="line">6 rows selected</div><div class="line">SQL&gt;</div></pre></td></tr></table></figure></p>
<p>以恢复Example表空间为例<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">操作步骤如下： </div><div class="line">RMAN&gt; SQL <span class="string">'ALTER TABLESPACE EXAMPLE OFFLINE IMMEDIATE'</span>; </div><div class="line">RMAN&gt; RESTORE TABLESPACE EXAMPLE; </div><div class="line">RMAN&gt; RECOVER TABLESPACE EXAMPLE; </div><div class="line">RMAN&gt; SQL <span class="string">'ALTER TABLESPACE  EXAMPLE ONLINE'</span>;</div></pre></td></tr></table></figure></p>
<p>上述执行的四个脚本，表示将表空间置于OFFLINE状态，执行RESTORE命令，执行RECOVER命令，最后将表空间置为ONLINE状态<br>示例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">RMAN&gt; SQL <span class="string">'ALTER TABLESPACE EXAMPLE OFFLINE IMMEDIATE'</span>;</div><div class="line"></div><div class="line">sql statement: ALTER TABLESPACE EXAMPLE OFFLINE IMMEDIATE</div><div class="line"></div><div class="line">RMAN&gt; RESTORE TABLESPACE EXAMPLE;</div><div class="line"></div><div class="line">Starting restore at 15-JUL-15</div><div class="line">using channel ORA_DISK_1</div><div class="line"></div><div class="line">channel ORA_DISK_1: restoring datafile 00005</div><div class="line">input datafile copy RECID=5 STAMP=884555312 file name=E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\DATAFILE\O1_MF_EXAMPLE_BSTBKF80_.DBF</div><div class="line">destination <span class="keyword">for</span> restore of datafile 00005: E:\APP\TIANPAN\ORADATA\PTIAN\EXAMPLE01.DBF</div><div class="line">channel ORA_DISK_1: copied datafile copy of datafile 00005</div><div class="line">output file name=E:\APP\TIANPAN\ORADATA\PTIAN\EXAMPLE01.DBF RECID=0 STAMP=0</div><div class="line">Finished restore at 15-JUL-15</div><div class="line"></div><div class="line">RMAN&gt; RECOVER TABLESPACE EXAMPLE;</div><div class="line"></div><div class="line">Starting recover at 15-JUL-15</div><div class="line">using channel ORA_DISK_1</div><div class="line"></div><div class="line">starting media recovery</div><div class="line"></div><div class="line">archived <span class="built_in">log</span> <span class="keyword">for</span> thread 1 with sequence 105 is already on disk as file E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\ARCHIVELOG\2015_07_09\O1_MF_1_105_BSWC39YH_.ARC</div><div class="line">archived <span class="built_in">log</span> <span class="keyword">for</span> thread 1 with sequence 106 is already on disk as file E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\ARCHIVELOG\2015_07_10\O1_MF_1_106_BSYCRLNG_.ARC</div><div class="line">archived <span class="built_in">log</span> <span class="keyword">for</span> thread 1 with sequence 107 is already on disk as file E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\ARCHIVELOG\2015_07_11\O1_MF_1_107_BT10F9Y9_.ARC</div><div class="line">archived <span class="built_in">log</span> <span class="keyword">for</span> thread 1 with sequence 108 is already on disk as file E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\ARCHIVELOG\2015_07_11\O1_MF_1_108_BT1M9PW5_.ARC</div><div class="line">archived <span class="built_in">log</span> <span class="keyword">for</span> thread 1 with sequence 109 is already on disk as file E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\ARCHIVELOG\2015_07_15\O1_MF_1_109_BTCH29LR_.ARC</div><div class="line">archived <span class="built_in">log</span> file name=E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\ARCHIVELOG\2015_07_09\O1_MF_1_105_BSWC39YH_.ARC thread=1 sequence=105</div><div class="line">archived <span class="built_in">log</span> file name=E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\ARCHIVELOG\2015_07_10\O1_MF_1_106_BSYCRLNG_.ARC thread=1 sequence=106</div><div class="line">archived <span class="built_in">log</span> file name=E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\ARCHIVELOG\2015_07_11\O1_MF_1_107_BT10F9Y9_.ARC thread=1 sequence=107</div><div class="line">media recovery complete, elapsed time: 00:00:03</div><div class="line">Finished recover at 15-JUL-15</div><div class="line"></div><div class="line">RMAN&gt; SQL <span class="string">'ALTER TABLESPACE  EXAMPLE ONLINE'</span>;</div><div class="line"></div><div class="line">sql statement: ALTER TABLESPACE  EXAMPLE ONLINE</div><div class="line"></div><div class="line">RMAN&gt;</div></pre></td></tr></table></figure></p>
<ol>
<li>数据文件的恢复  </li>
</ol>
<p>恢复表空间实际就是恢复其所对应的数据文件（一个表空间可能对应多个数据文件），因此恢复数据文件的操作步骤与上极其相似<br>同样在恢复操作之前，如果需要被恢复的数据文件未处于OFFLINE状态，需要通过ALTER DATABASE DATAFILE … OFFLINE语句将其置为脱机。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">SQL&gt;  select file<span class="comment">#, name,status, enabled from v$datafile;</span></div><div class="line">     FILE<span class="comment"># NAME                                                                             STATUS  ENABLED</span></div><div class="line">---------- -------------------------------------------------------------------------------- ------- ----------</div><div class="line">         1 E:\APP\TIANPAN\ORADATA\PTIAN\SYSTEM01.DBF                                        SYSTEM  READ WRITE</div><div class="line">         2 E:\APP\TIANPAN\ORADATA\PTIAN\SYSAUX01.DBF                                        ONLINE  READ WRITE</div><div class="line">         3 E:\APP\TIANPAN\ORADATA\PTIAN\UNDOTBS01.DBF                                       ONLINE  READ WRITE</div><div class="line">         4 E:\APP\TIANPAN\ORADATA\PTIAN\USERS01.DBF                                         ONLINE  READ WRITE</div><div class="line">         5 E:\APP\TIANPAN\ORADATA\PTIAN\EXAMPLE01.DBF                                       ONLINE  READ WRITE</div><div class="line"></div><div class="line">SQL&gt;</div></pre></td></tr></table></figure></p>
<p>以恢复datafile 5为例<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">RMAN&gt; SQL <span class="string">'ALTER DATABASE DATAFILE 5 OFFLINE'</span>; </div><div class="line">RMAN&gt; RESTORE DATAFILE 5; </div><div class="line">RMAN&gt; RECOVER DATAFILE 5; </div><div class="line">RMAN&gt; SQL <span class="string">'ALTER DATABASE DATAFILE 5 ONLINE'</span>;</div></pre></td></tr></table></figure></p>
<p>示例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">RMAN&gt; SQL <span class="string">'ALTER DATABASE DATAFILE 5 OFFLINE'</span>;</div><div class="line"></div><div class="line">sql statement: ALTER DATABASE DATAFILE 5 OFFLINE</div><div class="line"></div><div class="line">RMAN&gt; RESTORE DATAFILE 5;</div><div class="line"></div><div class="line">Starting restore at 15-JUL-15</div><div class="line">using channel ORA_DISK_1</div><div class="line"></div><div class="line">channel ORA_DISK_1: restoring datafile 00005</div><div class="line">input datafile copy RECID=5 STAMP=884555312 file name=E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\DATAFILE\O1_MF_EXAMPLE_BSTBKF80_.DBF</div><div class="line">destination <span class="keyword">for</span> restore of datafile 00005: E:\APP\TIANPAN\ORADATA\PTIAN\EXAMPLE01.DBF</div><div class="line">channel ORA_DISK_1: copied datafile copy of datafile 00005</div><div class="line">output file name=E:\APP\TIANPAN\ORADATA\PTIAN\EXAMPLE01.DBF RECID=0 STAMP=0</div><div class="line">Finished restore at 15-JUL-15</div><div class="line"></div><div class="line">RMAN&gt; RECOVER DATAFILE 5;</div><div class="line"></div><div class="line">Starting recover at 15-JUL-15</div><div class="line">using channel ORA_DISK_1</div><div class="line"></div><div class="line">starting media recovery</div><div class="line"></div><div class="line">archived <span class="built_in">log</span> <span class="keyword">for</span> thread 1 with sequence 105 is already on disk as file E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\ARCHIVELOG\2015_07_09\O1_MF_1_105_BSWC39YH_.ARC</div><div class="line">archived <span class="built_in">log</span> <span class="keyword">for</span> thread 1 with sequence 106 is already on disk as file E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\ARCHIVELOG\2015_07_10\O1_MF_1_106_BSYCRLNG_.ARC</div><div class="line">archived <span class="built_in">log</span> <span class="keyword">for</span> thread 1 with sequence 107 is already on disk as file E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\ARCHIVELOG\2015_07_11\O1_MF_1_107_BT10F9Y9_.ARC</div><div class="line">archived <span class="built_in">log</span> <span class="keyword">for</span> thread 1 with sequence 108 is already on disk as file E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\ARCHIVELOG\2015_07_11\O1_MF_1_108_BT1M9PW5_.ARC</div><div class="line">archived <span class="built_in">log</span> <span class="keyword">for</span> thread 1 with sequence 109 is already on disk as file E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\ARCHIVELOG\2015_07_15\O1_MF_1_109_BTCH29LR_.ARC</div><div class="line">archived <span class="built_in">log</span> file name=E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\ARCHIVELOG\2015_07_09\O1_MF_1_105_BSWC39YH_.ARC thread=1 sequence=105</div><div class="line">archived <span class="built_in">log</span> file name=E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\ARCHIVELOG\2015_07_10\O1_MF_1_106_BSYCRLNG_.ARC thread=1 sequence=106</div><div class="line">archived <span class="built_in">log</span> file name=E:\APP\TIANPAN\FLASH_RECOVERY_AREA\PTIAN\ARCHIVELOG\2015_07_11\O1_MF_1_107_BT10F9Y9_.ARC thread=1 sequence=107</div><div class="line">media recovery complete, elapsed time: 00:00:04</div><div class="line">Finished recover at 15-JUL-15</div><div class="line"></div><div class="line">RMAN&gt; SQL <span class="string">'ALTER DATABASE DATAFILE 5 ONLINE'</span>;</div><div class="line"></div><div class="line">sql statement: ALTER DATABASE DATAFILE 5 ONLINE</div><div class="line"></div><div class="line">RMAN&gt;</div></pre></td></tr></table></figure></p>
<ol>
<li>归档日志文件的恢复  </li>
</ol>
<p>恢复归档文件也是使用RESTORE命令，如果只是为了在恢复数据文件后应用归档文件，那并不需要手动对归档文件进行恢复，RMAN会在RECOVER的时候自动对适当的归档进行恢复<br>恢复归档文件也非常灵活，RMAN的RECOVER命令中提供了多种限定条件，可以精确指定恢复哪些备份的归档文件，例如，恢复归档序号为20到30之间的归档文件：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">RMAN&gt; RESTORE ARCHIVELOG SEQUENCE BETWEEN 20 AND 30;</div></pre></td></tr></table></figure></p>
<p>示例：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">RMAN&gt; RUN&#123; </div><div class="line">2&gt; SET ARCHIVELOG DESTINATION TO <span class="string">'F:\ORACLE\BACKUP\ARCLOG1'</span>; </div><div class="line">3&gt; RESTORE ARCHIVELOG SEQUENCE BETWEEN 15 AND 20; </div><div class="line">4&gt; SET ARCHIVELOG DESTINATION TO <span class="string">'F:\ORACLE\BACKUP\ARCLOG2'</span>; </div><div class="line">5&gt; RESTORE ARCHIVELOG SEQUENCE BETWEEN 21 AND 30; </div><div class="line">6&gt; SET ARCHIVELOG DESTINATION TO <span class="string">'F:\ORACLE\BACKUP\ARCLOG3'</span>; </div><div class="line">7&gt; RESTORE ARCHIVELOG SEQUENCE BETWEEN 31 AND 40;  </div><div class="line">8&gt; &#125;</div></pre></td></tr></table></figure></p>
<ol>
<li>控制文件的恢复  </li>
</ol>
<p>Oracle数据库的控制文件个头不大（最大不超过20000个数据块），Oracle数据库实例启动后（即启动到NOMOUNT模式），要通过加载控制文件确定数据文件、重做日志文件的路径（进入到MOUNT模式），然后才能打开数据库（Finally，OPEN数据库）。因此，没有了控制文件，想顺利启动Oracle数据库是不可能的。<br>控制文件中并不是只有数据文件和重做日志文件的路径，还包括数据库名称、数据库创建信息、表空间信息、数据文件状态、日志文件信息、备份信息、检查点信息等。<br>该文件不仅在数据库启动过程中需要，在Oracle数据库运行过程中，控制文件也需要发挥重要作用，如记录检查点的相关信息、归档文件路径、备份信息（假如采用RMAN执行备份的话），以及数据库发生结构修改（流行词汇形容叫领导班子调整，类似添加删除表空间、数据文件、日志文件）等操作都需要同步到控制文件。如果在Oracle数据库运行过程中，由于某些原因导致控制文件无法访问，则数据库也无法继续正常工作。<br>控制文件是一个二进制文件，不能直接通过文本编辑工具修改，一般这个文件中的内容都是由Oracle自行维护。一个Oracle数据库至少要拥有一个控制文件，鉴于其重要地位，Oracle对其的保护有加，在默认情况下，控制文件就会有两、三份冗余（就是一模一样的文件存在两、三份），这几份文件的一致性由Oracle自动维护，冗余的数量和冗余文件的位置可以由DBA指定，Oracle建议控制文件至少要有两份冗余，并且存储在不同的磁盘中，以提高该文件的可用性。  </p>
<p>查询当前数据库拥有的控制文件：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">SQL&gt; SELECT NAME FROM V<span class="variable">$CONTROLFILE</span>; </div><div class="line"></div><div class="line">NAME</div><div class="line">--------------------------------------------------------------------------------</div><div class="line">/u01/data/orcl/control01.ctl</div><div class="line">/u01/data/orcl/control02.ctl</div><div class="line"></div><div class="line">SQL&gt; SHOW PARAMETER CONTROL_FILES;</div><div class="line"></div><div class="line">NAME				     TYPE	 VALUE</div><div class="line">------------------------------------ ----------- ------------------------------</div><div class="line">control_files			     string	 /u01/data/orcl/control01.ctl,</div><div class="line">						 /u01/data/orcl/control02.ctl</div><div class="line">SQL&gt;</div></pre></td></tr></table></figure></p>
<p>如果通知文件丢失，可以通过以下集中方式恢复：</p>
<ul>
<li>从自动备份中恢复  </li>
</ul>
<p>由于没有了控制文件，目标数据库只能启动到NOMOUNT状态，不过在启动数据库之前，必须首先通过SET命令设置DBID：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#获取数据库的DBID</span></div><div class="line">SQL&gt; SELECT DBID FROM V<span class="variable">$DATABASE</span>;</div><div class="line"></div><div class="line">      DBID</div><div class="line">----------</div><div class="line">1455780274</div><div class="line"></div><div class="line">SQL&gt;</div></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">RMAN&gt; SET DBID=1455780274;</div><div class="line">RMAN&gt; STARTUP NOMOUNT;</div><div class="line">RMAN&gt; RESTORE CONTROLFILE FROM AUTOBACKUP;</div></pre></td></tr></table></figure>
<ul>
<li>从备份集中恢复</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#在启动数据库之前，必须首先通过SET命令设置DBID</span></div><div class="line">RMAN&gt; SET DBID=1415261003;</div><div class="line">RMAN&gt; STARTUP NOMOUNT;</div><div class="line"><span class="comment">#指定控制文件所在备份片段的详细路径</span></div><div class="line">RMAN&gt; RESTORE CONTROLFILE FROM <span class="string">'/u01/app/oracle/product/11.2.0.4/db_1/dbs/05rtn873_1_1'</span>;</div></pre></td></tr></table></figure>
<ul>
<li>还有一种极端的情况，没有备份过控制文件，这时不凑巧的是，控制文件居然坏了。这时我们可以采用<a href="https://yfshare.github.io/2017/02/27/重建oracle控制文件/">重构oracle的控制文件来恢复，参考这里</a></li>
</ul>
<ol>
<li>SPFILE初始化参数文件  </li>
</ol>
<p>虽然DBA可以通过BACKUP SPFILE命令手动备份服务器端的初始化参数文件，不过一般都不会主动执行，因为RMAN在备份控制文件时会自动备份SPFILE<br>相对于其他文件的备份，SPFILE最不重要（或者说最容易被恢复）。除了可以通过备份方式保障拥有可用的SPFILE外，数据库在运行过程中也会在Alert文件中留下数据库启动时的初始化参数信息。甚至即使这些都丢失了也没有关系，如果你对数据库足够了解，还是能够手动地创建出一份SPFILE出来，只是麻烦一些罢了。即使是运行中的数据库丢失了SPFILE也不会导致数据库崩溃（只不过下次启动时如果还没有能创建出一份来，数据库就起不来。</p>
<p>通过RMAN恢复初始化参数的过程与恢复控制文件极其类似<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">RMAN&gt; SET DBID=1415261003;</div><div class="line">RMAN&gt; STARTUP NOMOUNT;</div><div class="line"><span class="comment">#执行恢复命令，将SPFILE恢复到默认路径下</span></div><div class="line">RMAN&gt; RESTORE SPFILE FROM AUTOBACKUP;</div></pre></td></tr></table></figure></p>
<p>参考：<a href="http://blog.csdn.net/pan_tian/article/details/46896017" target="_blank" rel="external">http://blog.csdn.net/pan_tian/article/details/46896017</a></p>
<hr>
<p>本作品采用<a href="https://creativecommons.org/licenses/by/2.5/cn/" target="_blank" rel="external">知识共享署名 2.5 中国大陆许可协议</a>进行许可，欢迎转载，但转载请注明来自<a href="https://yfshare.github.io">Jack Wang Blog</a>，并保持转载后文章内容的完整。本人保留所有版权相关权利。</p>
<p>本文出自”Jack Wang Blog”：<a href="https://yfshare.github.io/2017/02/28/Oracle数据库备份与恢复-RMAN恢复/">https://yfshare.github.io/2017/02/28/Oracle数据库备份与恢复-RMAN恢复/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;script src=&quot;/assets/js/DPlayer.min.js&quot;&gt; &lt;/script&gt;&lt;script src=&quot;/assets/js/APlayer.min.js&quot;&gt; &lt;/script&gt;&lt;h2 id=&quot;RMAN恢复原理&quot;&gt;&lt;a href=&quot;#RMAN恢复原理&quot; cl
    
    </summary>
    
      <category term="oracle" scheme="https://yfshare.github.io/categories/oracle/"/>
    
    
      <category term="oracle" scheme="https://yfshare.github.io/tags/oracle/"/>
    
      <category term="RMAN" scheme="https://yfshare.github.io/tags/RMAN/"/>
    
  </entry>
  
  <entry>
    <title>重建oracle控制文件</title>
    <link href="https://yfshare.github.io/2017/02/27/%E9%87%8D%E5%BB%BAoracle%E6%8E%A7%E5%88%B6%E6%96%87%E4%BB%B6/"/>
    <id>https://yfshare.github.io/2017/02/27/重建oracle控制文件/</id>
    <published>2017-02-27T07:24:08.000Z</published>
    <updated>2017-02-27T07:32:32.896Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><p>环境：CentOS 6.6<br>　　　oracle 11.2.0.4.0  </p>
<p>前几天开发一都比调试存储过程时开了DEBUG，把测试服务器直接搞挂了，最后把测试服务器搞起来了，结果发现oracle数据库也挂了，原因是oracle的控制文件 control02.ctl 损坏了，因为是测试环境，所以没有备份…xxx<br><a id="more"></a><br>控制文件（control file）是一个相当小的文件（最多能增长到64M左右），其中包含Oracle需要的其他文件的一个目录。参数文件告知实例控制文件的位置，控制文件则告知示例数据库和在线重做日志文件的位置。控制文件还告知了Oracle其他一些事情，如已发生检查点的有关信息、数据库名（必须和db_name参数匹配）、创建数据库的时间戳、归档重做日志的历史（有时这会让控制文件变大）、RMAN信息等。<br>控制文件应该通过硬件（RAID）多路保存，如果不支持镜像，则要通过Oracle多路保存。应该有不止一个副本，而且它们应该保存在不同的磁盘上，以防止万一出现磁盘故障而丢失控制文件。丢失控制文件并不是致命的，但是会使恢复变得困难很多。<br>如果丢失了所有的控制文件并且没有任何的备份，我们可以通过重建控制文件来打开数据库。其中，重建控制文件至少需要以下信息：  </p>
<ol>
<li>数据库名</li>
<li>字符集</li>
<li>数据文件名称</li>
<li>初始化参数，包括MAXLOGFILES、MAXLOGMEMBERS、MAXDATAFILES、MAXINSTANCES、MAXLOGHISTORY等；  </li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#查看oracle版本信息</span></div><div class="line">SQL&gt; select * from v<span class="variable">$version</span>;</div><div class="line"></div><div class="line">BANNER</div><div class="line">-----------------------------------------------------------------------------</div><div class="line">Oracle Database 11g Enterprise Edition Release 11.2.0.4.0 - 64bit Production</div><div class="line">PL/SQL Release 11.2.0.4.0 - Production</div><div class="line">CORE	11.2.0.4.0	Production</div><div class="line">TNS <span class="keyword">for</span> Linux: Version 11.2.0.4.0 - Production</div><div class="line">NLSRTL Version 11.2.0.4.0 - Production</div><div class="line"></div><div class="line">SQL&gt;</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#查看oracle控制文件位置</span></div><div class="line">SQL&gt; show parameter control_files</div><div class="line"></div><div class="line">NAME				     TYPE	 VALUE</div><div class="line">------------------------------------ ------- -----------</div><div class="line">control_files			     string	 /u01/data/orcl/control01.ctl,</div><div class="line">						 /u01/data/orcl/control02.ctl</div><div class="line">SQL&gt;</div></pre></td></tr></table></figure>
<p>如果oracle控制文件损坏，强制关闭数据库，然后重启数据库，报ORA-00205错误。需要注意的是，此时执行shutdown immediate命令，数据库无法正常关闭，只能关闭到mounted状态；需要使用shutdown abort命令强制关闭数据库。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">SQL&gt; shutdown immediate</div><div class="line">Database closed.</div><div class="line">ORA-00210: cannot open the specified control file</div><div class="line">ORA-00202: control file: <span class="string">'/u01/data/orcl/control02.ctl'</span></div><div class="line">ORA-27041: unable to open file</div><div class="line">Linux Error: 2: No such file or directory</div><div class="line">Additional information: 3</div><div class="line"></div><div class="line">SQL&gt; select status from v<span class="variable">$instance</span>;</div><div class="line"></div><div class="line">STATUS</div><div class="line">------------</div><div class="line">MOUNTED</div><div class="line"></div><div class="line">SQL&gt; shutdown abort</div><div class="line">ORACLE instance shut down.</div><div class="line">SQL&gt; </div><div class="line">SQL&gt; startup</div><div class="line">ORACLE instance started.</div><div class="line"></div><div class="line">Total System Global Area 941600768 bytes</div><div class="line">Fixed Size 1348860 bytes</div><div class="line">Variable Size 515902212 bytes</div><div class="line">Database Buffers 419430400 bytes</div><div class="line">Redo Buffers 4919296 bytes</div><div class="line">ORA-00205: error <span class="keyword">in</span> identifying control file, check alert <span class="built_in">log</span> <span class="keyword">for</span> more info</div><div class="line"></div><div class="line">SQL&gt;</div></pre></td></tr></table></figure></p>
<p>获取数据库名<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#生成文本格式的参数文件</span></div><div class="line">$ sqlplus / as sysdba</div><div class="line">SQL&gt; create pfile from spfile;</div><div class="line">File created.</div><div class="line">SQL&gt;</div></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#打开参数文件，查看db_name参数值，即为数据库名称  </span></div><div class="line">[oracle@orcl ~]$ <span class="built_in">cd</span> <span class="variable">$ORACLE_HOME</span>/dbs</div><div class="line">[oracle@orcl dbs]$ cat initorcl.ora </div><div class="line">orcl.__db_cache_size=1107296256</div><div class="line">orcl.__java_pool_size=16777216</div><div class="line">orcl.__large_pool_size=33554432</div><div class="line">orcl.__oracle_base=<span class="string">'/u01/app/oracle'</span><span class="comment">#ORACLE_BASE set from environment</span></div><div class="line">orcl.__pga_aggregate_target=1140850688</div><div class="line">orcl.__sga_target=2130706432</div><div class="line">orcl.__shared_io_pool_size=0</div><div class="line">orcl.__shared_pool_size=369098752</div><div class="line">orcl.__streams_pool_size=0</div><div class="line">*.audit_file_dest=<span class="string">'/u01/app/oracle/admin/orcl/adump'</span></div><div class="line">*.audit_trail=<span class="string">'db'</span></div><div class="line">*.compatible=<span class="string">'11.2.0.4.0'</span></div><div class="line">*.control_files=<span class="string">'/u01/data/orcl/control01.ctl'</span>,<span class="string">'/u01/data/orcl/control02.ctl'</span></div><div class="line">*.db_block_size=8192</div><div class="line">*.db_domain=<span class="string">''</span></div><div class="line">*.db_name=<span class="string">'orcl'</span>   <span class="comment">#oracle数据库名称</span></div><div class="line">*.diagnostic_dest=<span class="string">'/u01/app/oracle'</span></div><div class="line">*.dispatchers=<span class="string">'(PROTOCOL=TCP) (SERVICE=orclXDB)'</span></div><div class="line">*.memory_target=3267362816</div><div class="line">*.nls_language=<span class="string">'SIMPLIFIED CHINESE'</span></div><div class="line">*.open_cursors=300</div><div class="line">*.processes=1500</div><div class="line">*.remote_login_passwordfile=<span class="string">'EXCLUSIVE'</span></div><div class="line">*.sessions=1655</div><div class="line">*.undo_tablespace=<span class="string">'UNDOTBS1'</span></div><div class="line">[oracle@orcl dbs]$</div></pre></td></tr></table></figure>
<p>启动到nomount状态，获取字符集<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#需要执行查询语句select userenv('language') from dual;来获取字符集，因此需要将数据库启动到nomount状态</span></div><div class="line">SQL&gt; startup nomount</div><div class="line">ORACLE instance started.</div><div class="line"></div><div class="line">Total System Global Area 941600768 bytes</div><div class="line">Fixed Size 1348860 bytes</div><div class="line">Variable Size 515902212 bytes</div><div class="line">Database Buffers 419430400 bytes</div><div class="line">Redo Buffers 4919296 bytes</div><div class="line">SQL&gt; </div><div class="line">SQL&gt; select userenv(<span class="string">'language'</span>) from dual;   </div><div class="line"></div><div class="line">USERENV(<span class="string">'LANGUAGE'</span>)</div><div class="line">----------------------------------------------------</div><div class="line">SIMPLIFIED CHINESE_CHINA.US7ASCII</div><div class="line"></div><div class="line">SQL&gt;</div></pre></td></tr></table></figure></p>
<p>获取数据文件名称<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">SQL&gt; select FILE_NAME,TABLESPACE_NAME from dba_data_files;</div><div class="line"></div><div class="line">FILE_NAME			    TABLESPACE_NAME</div><div class="line">----------------------------------- ------------------------------</div><div class="line">/u01/data/orcl/dev_payboxdb.dbf     DEV_PAYBOXDB</div><div class="line">/u01/data/orcl/dev_paydb.dbf	    DEV_PAYDB</div><div class="line">/u01/data/orcl/PAYBOX_FG_PRO.dbf    PAYBOX_FG_PRO</div><div class="line">/u01/data/orcl/PAYBOX_TEST2SP.dbf   PAYBOX_TEST2SP</div><div class="line">/u01/data/orcl/ticket.dbf	    LOTTERYDB</div><div class="line">/u01/data/orcl/users01.dbf	    USERS</div><div class="line">/u01/data/orcl/undotbs01.dbf	    UNDOTBS1</div><div class="line">/u01/data/orcl/sysaux01.dbf	    SYSAUX</div><div class="line">/u01/data/orcl/system01.dbf	    SYSTEM</div><div class="line"></div><div class="line">9 rows selected.</div><div class="line"></div><div class="line">SQL&gt;</div><div class="line"><span class="comment">#获取数据库文件列表</span></div><div class="line">[oracle@orcl orcl]$ ls -lth</div><div class="line">总用量 8.1G</div><div class="line">-rw-r----- 1 oracle oinstall  51M 2月  27 15:09 redo02.log</div><div class="line">-rw-r----- 1 oracle oinstall 503M 2月  27 15:09 users01.dbf</div><div class="line">-rw-r----- 1 oracle oinstall 511M 2月  27 15:09 undotbs01.dbf</div><div class="line">-rw-r----- 1 oracle oinstall 3.7G 2月  27 15:07 system01.dbf</div><div class="line">-rw-r----- 1 oracle oinstall 1.3G 2月  27 15:06 sysaux01.dbf</div><div class="line">-rw-r----- 1 oracle oinstall 513M 2月  27 15:00 temp01.dbf</div><div class="line">-rw-r----- 1 oracle oinstall 501M 2月  27 12:31 ticket.dbf</div><div class="line">-rw-r----- 1 oracle oinstall 501M 2月  27 12:31 dev_payboxdb.dbf</div><div class="line">-rw-r----- 1 oracle oinstall 501M 2月  27 12:31 dev_paydb.dbf</div><div class="line">-rw-r----- 1 oracle oinstall 201M 2月  27 12:31 PAYBOX_TEST2SP.dbf</div><div class="line">-rw-r----- 1 oracle oinstall 201M 2月  27 12:31 PAYBOX_FG_PRO.dbf</div><div class="line">-rw-r----- 1 oracle oinstall  51M 2月  27 12:26 redo01.log</div><div class="line">-rw-r----- 1 oracle oinstall  51M 2月  27 12:26 redo03.log</div><div class="line">-rw-r----- 1 oracle oinstall  51M 2月  25 08:05 redo05.log</div><div class="line">-rw-r----- 1 oracle oinstall  51M 2月  25 06:00 redo04.log</div><div class="line">[oracle@orcl orcl]$</div></pre></td></tr></table></figure></p>
<p>生成创建控制文件脚本<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#DATABASE后面的orcl是示例名，正确设置LOGFILE和DATAFILE的路径及名称，字符集</span></div><div class="line">[oracle@orcl orcl]$ cat create_control.sql </div><div class="line">STARTUP NOMOUNT</div><div class="line">CREATE CONTROLFILE REUSE DATABASE orcl NORESETLOGS ARCHIVELOG</div><div class="line">    MAXLOGFILES 5</div><div class="line">    MAXLOGMEMBERS 3</div><div class="line">    MAXDATAFILES 100</div><div class="line">    MAXINSTANCES 1</div><div class="line">    MAXLOGHISTORY 226</div><div class="line">LOGFILE</div><div class="line">  GROUP 1 <span class="string">'/u01/data/orcl/redo01.log'</span> SIZE 50M,</div><div class="line">  GROUP 2 <span class="string">'/u01/data/orcl/redo02.log'</span> SIZE 50M,</div><div class="line">  GROUP 3 <span class="string">'/u01/data/orcl/redo03.log'</span> SIZE 50M</div><div class="line">DATAFILE</div><div class="line">  <span class="string">'/u01/data/orcl/system01.dbf'</span>,</div><div class="line">  <span class="string">'/u01/data/orcl/sysaux01.dbf'</span>,</div><div class="line">  <span class="string">'/u01/data/orcl/undotbs01.dbf'</span>,</div><div class="line">  <span class="string">'/u01/data/orcl/users01.dbf'</span>,</div><div class="line">  <span class="string">'/u01/data/orcl/ticket.dbf'</span>,</div><div class="line">  <span class="string">'/u01/data/orcl/PAYBOX_TEST2SP.dbf'</span>,</div><div class="line">  <span class="string">'/u01/data/orcl/PAYBOX_FG_PRO.dbf'</span>,</div><div class="line">  <span class="string">'/u01/data/orcl/dev_paydb.dbf'</span>,</div><div class="line">  <span class="string">'/u01/data/orcl/dev_payboxdb.dbf'</span></div><div class="line">CHARACTER SET US7ASCII</div><div class="line">;</div><div class="line">[oracle@orcl orcl]$</div></pre></td></tr></table></figure></p>
<p>重建控制文件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#如果上述创建控制文件的脚本的DATAFILE中有系统临时文件，则会报下面的错误：</span></div><div class="line"><span class="comment">#创建控制文件脚本里面不能有左斜杠(\)，否则报错</span></div><div class="line"><span class="comment">#DATAFILE中不能有临时文件/u01/data/orcl/temp01.dbf</span></div><div class="line"><span class="comment">#如果执行出错，执行shutdown abort关闭数据库后，再执行创建控制文件的sql，因为执行了创建控制文件的sql会让oracle处理mount状态</span></div><div class="line">SQL&gt; @/u01/data/orcl/create_control.sql</div><div class="line">ORA-01081: cannot start already-running ORACLE - shut it down first</div><div class="line">CREATE CONTROLFILE REUSE DATABASE \<span class="string">"oracle\" NORESETLOGS ARCHIVELOG</span></div><div class="line">*</div><div class="line">ERROR at line 1:</div><div class="line">ORA-01503: CREATE CONTROLFILE failed</div><div class="line">ORA-01160: file is not a data file</div><div class="line">ORA-01110: data file : '/u01/data/orcl/temp01.dbf'</div><div class="line"></div><div class="line">SQL&gt;</div></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">SQL&gt; @/u01/data/orcl/create_control.sql</div><div class="line">ORACLE instance started.</div><div class="line"></div><div class="line">Total System Global Area 941600768 bytes</div><div class="line">Fixed Size 1348860 bytes</div><div class="line">Variable Size 515902212 bytes</div><div class="line">Database Buffers 419430400 bytes</div><div class="line">Redo Buffers 4919296 bytes</div><div class="line"></div><div class="line">Control file created.</div><div class="line"></div><div class="line">SQL&gt; </div><div class="line">SQL&gt; select status from v<span class="variable">$instance</span>;</div><div class="line"></div><div class="line">STATUS</div><div class="line">------------</div><div class="line">MOUNTED</div><div class="line"></div><div class="line">SQL&gt;</div></pre></td></tr></table></figure>
<p>打开数据库<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#在打开数据库时，会报错，提示system01数据文件需要执行介质恢复，我们执行recover database即可</span></div><div class="line">SQL&gt; alter database open;</div><div class="line">alter database open</div><div class="line">*</div><div class="line">ERROR at line 1:</div><div class="line">ORA-01113: file 1 needs media recovery</div><div class="line">ORA-01110: data file 1: \<span class="string">'/u01/app/oracle/oradata/HOEGH/system01.dbf\'</span></div><div class="line">SQL&gt; </div><div class="line">SQL&gt; recover database;</div><div class="line">Media recovery complete.</div><div class="line">SQL&gt; </div><div class="line">SQL&gt; alter database open;</div><div class="line"></div><div class="line">Database altered.</div><div class="line"></div><div class="line">SQL&gt; </div><div class="line">SQL&gt; select * from v<span class="variable">$version</span>;</div><div class="line"></div><div class="line">BANNER</div><div class="line">-----------------------------------------------------------------------------</div><div class="line">Oracle Database 11g Enterprise Edition Release 11.2.0.4.0 - 64bit Production</div><div class="line">PL/SQL Release 11.2.0.4.0 - Production</div><div class="line">CORE	11.2.0.4.0	Production</div><div class="line">TNS <span class="keyword">for</span> Linux: Version 11.2.0.4.0 - Production</div><div class="line">NLSRTL Version 11.2.0.4.0 - Production</div><div class="line"></div><div class="line">SQL&gt;</div><div class="line"></div><div class="line">SQL&gt; select tablespace_name from dba_tablespaces;</div><div class="line"></div><div class="line">TABLESPACE_NAME</div><div class="line">------------------------------</div><div class="line">SYSTEM</div><div class="line">SYSAUX</div><div class="line">UNDOTBS1</div><div class="line">TEMP</div><div class="line">USERS</div><div class="line">PAYBOX_FG_PRO</div><div class="line">PAYBOX_TEST2SP</div><div class="line">DEV_PAYDB</div><div class="line">DEV_PAYBOXDB</div><div class="line">LOTTERYDB</div><div class="line"></div><div class="line">10 rows selected.</div><div class="line"></div><div class="line">SQL&gt;</div></pre></td></tr></table></figure></p>
<p>总结<br>下面总结一下重建控制文件的步骤：  </p>
<ol>
<li>获取数据库名；</li>
<li>获取字符集名；</li>
<li>获取数据文件名；</li>
<li>重建控制文件；</li>
<li>执行介质恢复；</li>
<li>打开数据库。</li>
</ol>
<hr>
<p>本作品采用<a href="https://creativecommons.org/licenses/by/2.5/cn/" target="_blank" rel="external">知识共享署名 2.5 中国大陆许可协议</a>进行许可，欢迎转载，但转载请注明来自<a href="https://yfshare.github.io">Jack Wang Blog</a>，并保持转载后文章内容的完整。本人保留所有版权相关权利。</p>
<p>本文出自”Jack Wang Blog”：<a href="https://yfshare.github.io/2017/02/27/重建oracle控制文件/">https://yfshare.github.io/2017/02/27/重建oracle控制文件/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;环境：CentOS 6.6&lt;br&gt;　　　oracle 11.2.0.4.0  &lt;/p&gt;
&lt;p&gt;前几天开发一都比调试存储过程时开了DEBUG，把测试服务器直接搞挂了，最后把测试服务器搞起来了，结果发现oracle数据库也挂了，原因是oracle的控制文件 control02.ctl 损坏了，因为是测试环境，所以没有备份…xxx&lt;br&gt;
    
    </summary>
    
      <category term="oracle" scheme="https://yfshare.github.io/categories/oracle/"/>
    
    
      <category term="oracle" scheme="https://yfshare.github.io/tags/oracle/"/>
    
      <category term="control" scheme="https://yfshare.github.io/tags/control/"/>
    
  </entry>
  
  <entry>
    <title>Zabbix安装Graphtree</title>
    <link href="https://yfshare.github.io/2017/02/22/Zabbix%E5%AE%89%E8%A3%85Graphtree/"/>
    <id>https://yfshare.github.io/2017/02/22/Zabbix安装Graphtree/</id>
    <published>2017-02-22T09:01:32.000Z</published>
    <updated>2017-02-22T09:37:54.461Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><h2 id="Graphtree功能概述"><a href="#Graphtree功能概述" class="headerlink" title="Graphtree功能概述"></a>Graphtree功能概述</h2><p>Graphtree 由OneOaaS开发并开源出来，OneOaaS专注于国内Zabbix监控技术(包括二次开发)服务，为Zabbix官方中国区合作伙伴  </p>
<ol>
<li>集中展示所有分组设备</li>
<li>集中展示一个分组图像</li>
<li>集中展示一个设备图像<a id="more"></a></li>
<li>展示设备下的Application</li>
<li>展示每个应用下的图像</li>
<li>展示每个应用下的日志</li>
<li>对原声无图的监控项进行绘图</li>
<li>注意事项：主机和组级别下，默认只显示系统初始的图形</li>
</ol>
<h2 id="Zabbix版本要求：3-0-x"><a href="#Zabbix版本要求：3-0-x" class="headerlink" title="Zabbix版本要求：3.0.x"></a>Zabbix版本要求：3.0.x</h2><p>附件：<a href="http://note.youdao.com/yws/api/personal/file/DAB415BB243542CF8CF075B8907EF081?method=download&amp;shareKey=7ade1a3e929ca16ac394d1429a7152ba" target="_blank" rel="external">graphtree3-0-1.patch</a>  </p>
<ol>
<li><p>插件安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#进入zabbix web目录</span></div><div class="line">[root@localhost ~]<span class="comment"># cd /opt/server/nginx-1.2.5/html/zabbix</span></div><div class="line">[root@localhost zabbix]<span class="comment"># wget --no-check-certificate https://raw.githubusercontent.com/OneOaaS/graphtrees/master/graphtree3-0-1.patch</span></div><div class="line">[root@localhost zabbix]<span class="comment"># yum -y install patch  #安装Linux下打补丁的命令</span></div><div class="line">[root@localhost zabbix]<span class="comment"># patch -Np0 &lt; graphtree3-0-1.patch</span></div></pre></td></tr></table></figure>
</li>
<li><p>Graphtree效果图  </p>
</li>
</ol>
<ul>
<li>打开zabbix web界面，找到Graphtrees选项卡</li>
<li>删除提示信息。编辑/opt/server/nginx-1.2.5/html/zabbix/graphtree.right.php 344-350行。具体请参考zabbix web界面的提示信息，如下图：<br><img src="http://note.youdao.com/yws/api/personal/file/ABB674CC417E41D2A3D27F0E4E984C19?method=download&amp;shareKey=46a8a5e4bb870899bc6855316b83e595" alt="image">  </li>
<li>删除上述提示信息后，重新刷新zabbix web界面，即可看到效果<br><img src="http://note.youdao.com/yws/api/personal/file/E000C80252634DFA9A6EE39813914F33?method=download&amp;shareKey=930aa2a35216b44a5a23f62ff9dc2b79" alt="image">  </li>
</ul>
<hr>
<p>本作品采用<a href="https://creativecommons.org/licenses/by/2.5/cn/" target="_blank" rel="external">知识共享署名 2.5 中国大陆许可协议</a>进行许可，欢迎转载，但转载请注明来自<a href="https://yfshare.github.io">Jack Wang Blog</a>，并保持转载后文章内容的完整。本人保留所有版权相关权利。</p>
<p>本文出自”Jack Wang Blog”：<a href="https://yfshare.github.io/2017/02/22/Zabbix安装Graphtree/">https://yfshare.github.io/2017/02/22/Zabbix安装Graphtree/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Graphtree功能概述&quot;&gt;&lt;a href=&quot;#Graphtree功能概述&quot; class=&quot;headerlink&quot; title=&quot;Graphtree功能概述&quot;&gt;&lt;/a&gt;Graphtree功能概述&lt;/h2&gt;&lt;p&gt;Graphtree 由OneOaaS开发并开源出来，OneOaaS专注于国内Zabbix监控技术(包括二次开发)服务，为Zabbix官方中国区合作伙伴  &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;集中展示所有分组设备&lt;/li&gt;
&lt;li&gt;集中展示一个分组图像&lt;/li&gt;
&lt;li&gt;集中展示一个设备图像
    
    </summary>
    
      <category term="Zabbix" scheme="https://yfshare.github.io/categories/Zabbix/"/>
    
    
      <category term="zabbix" scheme="https://yfshare.github.io/tags/zabbix/"/>
    
      <category term="Graphtree" scheme="https://yfshare.github.io/tags/Graphtree/"/>
    
  </entry>
  
  <entry>
    <title>Hexo+Github绑定域名</title>
    <link href="https://yfshare.github.io/2017/02/16/Hexo-Github%E7%BB%91%E5%AE%9A%E5%9F%9F%E5%90%8D/"/>
    <id>https://yfshare.github.io/2017/02/16/Hexo-Github绑定域名/</id>
    <published>2017-02-16T03:41:33.000Z</published>
    <updated>2017-02-16T03:47:56.501Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><p>绑定域名  </p>
<p>首先去购买一个域名，<a href="https://www.godaddy.com/" target="_blank" rel="external">godaddy</a>或<a href="www.net.cn">万网</a>，听说万网比godaddy买域名便宜些  </p>
<p>效果图：<br><a id="more"></a><br><img src="http://note.youdao.com/yws/api/personal/file/84A29BD1472F43538084B5D94330CC97?method=download&amp;shareKey=57fc58d40de9aac2b6ab49ea3c19f1a4" alt="image"><br>提交资料审核通过后，需要修改域名的DNS地址<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#修改成dnspod的DNS地址</span></div><div class="line">f1g1ns1.dnspod.net</div><div class="line">f1g1ns2.dnspod.net</div></pre></td></tr></table></figure></p>
<p><img src="http://note.youdao.com/yws/api/personal/file/46849CEF99294860A7696C77176F0CC4?method=download&amp;shareKey=f604e9ed6bd9698bb6447089c76ca2c2" alt="image">  </p>
<p>注册 <a href="https://www.dnspod.cn/SignUp" target="_blank" rel="external">dnspod</a> 在dnspod域名解析添加域名，添加记录<br><img src="http://note.youdao.com/yws/api/personal/file/56E163D5B60C4A5BA0B4B3D78FF36914?method=download&amp;shareKey=88b1692a151014c739bc7f9446329fb1" alt="image">  </p>
<p><img src="http://note.youdao.com/yws/api/personal/file/5092974CA79D4889B36CA1BB02DA048B?method=download&amp;shareKey=b45d293e5c715abbd34f57c6dee09f4b" alt="image"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">pwd</span></div><div class="line">/e/GitHup_Data/Hexo_B<span class="built_in">log</span></div><div class="line">$ <span class="built_in">cd</span> <span class="built_in">source</span>/</div><div class="line">$ cat CNAME</div><div class="line">www.yfshare.vip</div></pre></td></tr></table></figure>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$ </span>hexo clean</div><div class="line"><span class="variable">$ </span>hexo g</div><div class="line"><span class="variable">$ </span>hexo d</div></pre></td></tr></table></figure>
<hr>
<p>本作品采用<a href="https://creativecommons.org/licenses/by/2.5/cn/" target="_blank" rel="external">知识共享署名 2.5 中国大陆许可协议</a>进行许可，欢迎转载，但转载请注明来自<a href="https://yfshare.github.io">Jack Wang Blog</a>，并保持转载后文章内容的完整。本人保留所有版权相关权利。</p>
<p>本文出自”Jack Wang Blog”：<a href="https://yfshare.github.io/2017/02/16/Hexo-Github绑定域名/">https://yfshare.github.io/2017/02/16/Hexo-Github绑定域名/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;绑定域名  &lt;/p&gt;
&lt;p&gt;首先去购买一个域名，&lt;a href=&quot;https://www.godaddy.com/&quot;&gt;godaddy&lt;/a&gt;或&lt;a href=&quot;www.net.cn&quot;&gt;万网&lt;/a&gt;，听说万网比godaddy买域名便宜些  &lt;/p&gt;
&lt;p&gt;效果图：&lt;br&gt;
    
    </summary>
    
      <category term="Hexo" scheme="https://yfshare.github.io/categories/Hexo/"/>
    
    
      <category term="hexo" scheme="https://yfshare.github.io/tags/hexo/"/>
    
      <category term="domain" scheme="https://yfshare.github.io/tags/domain/"/>
    
  </entry>
  
  <entry>
    <title>Hexo maupassant主题音乐小工具</title>
    <link href="https://yfshare.github.io/2017/02/16/Hexo-maupassant%E4%B8%BB%E9%A2%98%E9%9F%B3%E4%B9%90%E5%B0%8F%E5%B7%A5%E5%85%B7/"/>
    <id>https://yfshare.github.io/2017/02/16/Hexo-maupassant主题音乐小工具/</id>
    <published>2017-02-16T02:40:00.000Z</published>
    <updated>2017-02-16T02:54:45.114Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><p>maupassant主题音乐小工具实现blog背景音乐的功能  </p>
<p>自己研究的哈，我完全没有学过js脚本，经过我2小时的摸索，我发现可以在侧边栏添加音乐小工具，实现背景音乐的效果<br>灵感来源于官方Githup这句话：<a href="https://www.haomwei.com/technology/maupassant-hexo.html#功能配置" target="_blank" rel="external">https://www.haomwei.com/technology/maupassant-hexo.html#功能配置</a>  </p>
<ul>
<li>widgets - 选择和排列希望使用的侧边栏小工具。</li>
</ul>
<p><a href="https://yfshare.github.io">效果图</a>：<br><a id="more"></a><br><img src="http://note.youdao.com/yws/api/personal/file/23FAA10CE84C4441A83A9FEC1C01E2E7?method=download&amp;shareKey=5f8e308c71a0ebed208fafbfddec7c1b" alt="image">  </p>
<p>打开<a href="http://music.163.com/" target="_blank" rel="external">网页云音乐</a>寻找外链播放器代码<br>随便搜索一首歌，我这里用<a href="http://music.163.com/#/song?id=371362" target="_blank" rel="external">小跳蛙</a><br><img src="http://note.youdao.com/yws/api/personal/file/CE00D1E3EBF54F65B5C6925AF8332857?method=download&amp;shareKey=3ca948fa349b1b7eadb5c626cfdfce00" alt="image">  </p>
<p><img src="http://note.youdao.com/yws/api/personal/file/4A28038769D14E7C8B57CE19BFB8CAB9?method=download&amp;shareKey=5adab296ead0ff9c5fee07f60393a48e" alt="image"><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#网易云音乐HTML代码,把这段代码放到music.jade最下面</span></div><div class="line">&lt;iframe frameborder=<span class="string">"no"</span> border=<span class="string">"0"</span> marginwidth=<span class="string">"0"</span> marginheight=<span class="string">"0"</span> width=330 height=86 src=<span class="string">"//music.163.com/outchain/player?type=2&amp;id=371362&amp;auto=1&amp;height=66"</span>&gt;&lt;/iframe&gt;</div></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">pwd</span></div><div class="line">Hexo_B<span class="built_in">log</span>/themes/maupassant/layout/_widget</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#创建音乐侧边栏脚本</span></div><div class="line">$ touch music.jade</div><div class="line">$ cat music.jade</div><div class="line">.widget</div><div class="line">  .widget-title</div><div class="line">    i(class=<span class="string">'fa fa-external-music'</span>)= <span class="string">' '</span> + __(<span class="string">'music'</span>)</div><div class="line">  - <span class="keyword">for</span> (var i <span class="keyword">in</span> theme.music)</div><div class="line">    ul</div><div class="line">    a(href=<span class="string">'#&#123;theme.music[i].url&#125;'</span> title=<span class="string">'#&#123;theme.music[i].title&#125;'</span> target=<span class="string">'_blank'</span>) <span class="comment">#&#123;theme.music[i].title&#125;</span></div><div class="line"><span class="comment">#网易云音乐HTML代码</span></div><div class="line">&lt;iframe frameborder=<span class="string">"no"</span> border=<span class="string">"0"</span> marginwidth=<span class="string">"0"</span> marginheight=<span class="string">"0"</span> width=330 height=86 src=<span class="string">"//music.163.com/outchain/player?type=2&amp;id=371362&amp;auto=1&amp;height=66"</span>&gt;&lt;/iframe&gt;</div></pre></td></tr></table></figure>
<p>因为上面一个js脚本用到了music字段(我不懂js脚本，姑且这样称呼吧)，“+ __(‘music’)”，这里的music字段是调用下面的配置文件中的music字段<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#添加侧边栏标签</span></div><div class="line">$ <span class="built_in">pwd</span></div><div class="line">Hexo_B<span class="built_in">log</span>/themes/maupassant</div><div class="line">$ cat languages/zh-CN.yml</div><div class="line">reading_label: 正在查看 %s 下的文章</div><div class="line">blog: 博客</div><div class="line">albums: 相册</div><div class="line">categories: 分类</div><div class="line">tags: 标签</div><div class="line">archive: 归档</div><div class="line">links: 链接</div><div class="line">about: 关于</div><div class="line">recent: 最新文章</div><div class="line">next: 下一页</div><div class="line">previous: 上一页</div><div class="line">notitle: 无题</div><div class="line">blogroll: 友情链接</div><div class="line">music: 音乐   <span class="comment">#添加music字段汉字翻译</span></div><div class="line"><span class="built_in">history</span>: 历史</div><div class="line">rss: 订阅</div><div class="line">guestbook: 留言</div><div class="line">home: 首页</div><div class="line">recent_comments: 最近评论</div><div class="line">Readmore: 阅读更多</div><div class="line">belongsto: 分类于</div><div class="line">contents: 文章目录</div><div class="line">shareto: 分享到</div></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#在主题配置文件_config.yml中添加侧边栏工具music，在这里配置了才表示启用这个工具</span></div><div class="line">$ <span class="built_in">pwd</span></div><div class="line">Hexo_B<span class="built_in">log</span>/themes/maupassant</div><div class="line">$ head -39 _config.yml | tail</div><div class="line">widgets: <span class="comment">## Six widgets in sidebar provided: search, category, tag, recent_posts, rencent_comments and links.</span></div><div class="line">  - search</div><div class="line">  - category</div><div class="line">  - tag</div><div class="line">  - recent_posts</div><div class="line">  - recent_comments</div><div class="line">  - links</div><div class="line">  - music    <span class="comment">#添加music工具</span></div><div class="line"></div><div class="line">music:</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ hexo clean    <span class="comment">#修改配置文件后需要清空缓存，否则可能修改无效</span></div><div class="line">$ hexo g</div><div class="line">$ hexo d</div></pre></td></tr></table></figure>
<hr>
<p>本作品采用<a href="https://creativecommons.org/licenses/by/2.5/cn/" target="_blank" rel="external">知识共享署名 2.5 中国大陆许可协议</a>进行许可，欢迎转载，但转载请注明来自<a href="https://yfshare.github.io">Jack Wang Blog</a>，并保持转载后文章内容的完整。本人保留所有版权相关权利。</p>
<p>本文出自”Jack Wang Blog”：<a href="https://yfshare.github.io/2017/02/16/Hexo-maupassant主题音乐小工具/">https://yfshare.github.io/2017/02/16/Hexo-maupassant主题音乐小工具/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;maupassant主题音乐小工具实现blog背景音乐的功能  &lt;/p&gt;
&lt;p&gt;自己研究的哈，我完全没有学过js脚本，经过我2小时的摸索，我发现可以在侧边栏添加音乐小工具，实现背景音乐的效果&lt;br&gt;灵感来源于官方Githup这句话：&lt;a href=&quot;https://www.haomwei.com/technology/maupassant-hexo.html#功能配置&quot;&gt;https://www.haomwei.com/technology/maupassant-hexo.html#功能配置&lt;/a&gt;  &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;widgets - 选择和排列希望使用的侧边栏小工具。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&quot;https://yfshare.github.io&quot;&gt;效果图&lt;/a&gt;：&lt;br&gt;
    
    </summary>
    
      <category term="Hexo" scheme="https://yfshare.github.io/categories/Hexo/"/>
    
    
      <category term="hexo" scheme="https://yfshare.github.io/tags/hexo/"/>
    
      <category term="music" scheme="https://yfshare.github.io/tags/music/"/>
    
  </entry>
  
  <entry>
    <title>Hexo接入B站html5播放器</title>
    <link href="https://yfshare.github.io/2017/02/15/Hexo%E6%8E%A5%E5%85%A5B%E7%AB%99html5%E6%92%AD%E6%94%BE%E5%99%A8/"/>
    <id>https://yfshare.github.io/2017/02/15/Hexo接入B站html5播放器/</id>
    <published>2017-02-15T03:44:53.000Z</published>
    <updated>2017-02-15T04:45:01.253Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><p>2016年8月15日，B站推出了HTML5播放器，自此，B站成为国内原生支持全平台的HTML5播放器的视频网站<br>2017年1月19日，B站推出了HTML5播放器已支持https<br><a id="more"></a></p>
<p>效果：  </p>
<iframe src="https://www.bilibili.com/html/html5player.html?cid=10046207&aid=6184828" width="680" height="480" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen></iframe>  


<p>Hexo插入B站播放器代码：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;iframe src=<span class="string">"https://www.bilibili.com/html/html5player.html?cid=10046207&amp;aid=6184828"</span> width=<span class="string">"700"</span> height=<span class="string">"450"</span> frameborder=<span class="string">"0"</span> webkitallowfullscreen mozallowfullscreen allowfullscreen&gt;&lt;/iframe&gt;</div></pre></td></tr></table></figure></p>
<p>注：在<a href="https://www.bilibili.com/" target="_blank" rel="external">B站</a>找到一个自己喜欢的视频，缓存完成后，浏览器右键查看源代码，ctrl+f搜索 cid 或 aid，大概在源代码的380行左右。B 站每个视频都有对应的 aid 和 cid 值<br><img src="http://note.youdao.com/yws/api/personal/file/5D4552C0A7834D93879588D9BF893E5D?method=download&amp;shareKey=22f22e353b99a28c25a9f3f2e3742cd0" alt="image">  </p>
<hr>
<p>本作品采用<a href="https://creativecommons.org/licenses/by/2.5/cn/" target="_blank" rel="external">知识共享署名 2.5 中国大陆许可协议</a>进行许可，欢迎转载，但转载请注明来自<a href="https://yfshare.github.io">Jack Wang Blog</a>，并保持转载后文章内容的完整。本人保留所有版权相关权利。</p>
<p>本文出自”Jack Wang Blog”：<a href="https://yfshare.github.io/2017/02/15/Hexo接入B站html5播放器/">https://yfshare.github.io/2017/02/15/Hexo接入B站html5播放器/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;2016年8月15日，B站推出了HTML5播放器，自此，B站成为国内原生支持全平台的HTML5播放器的视频网站&lt;br&gt;2017年1月19日，B站推出了HTML5播放器已支持https&lt;br&gt;
    
    </summary>
    
      <category term="Hexo" scheme="https://yfshare.github.io/categories/Hexo/"/>
    
    
      <category term="hexo" scheme="https://yfshare.github.io/tags/hexo/"/>
    
      <category term="B站" scheme="https://yfshare.github.io/tags/B%E7%AB%99/"/>
    
      <category term="html5" scheme="https://yfshare.github.io/tags/html5/"/>
    
  </entry>
  
  <entry>
    <title>Hexo插件之音乐视频</title>
    <link href="https://yfshare.github.io/2017/02/15/Hexo%E6%8F%92%E4%BB%B6%E4%B9%8B%E9%9F%B3%E4%B9%90%E8%A7%86%E9%A2%91/"/>
    <id>https://yfshare.github.io/2017/02/15/Hexo插件之音乐视频/</id>
    <published>2017-02-15T02:59:55.000Z</published>
    <updated>2017-02-15T03:18:43.898Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><p>效果：<br><div id="aplayer0" class="aplayer" style="margin-bottom: 20px;"></div>
		<script>
			new APlayer({
				element: document.getElementById("aplayer0"),
				narrow: false,
				autoplay: true,
				showlrc: 0,
				music: {
					title: "You Raise Me Up",
					author: "Westlife",
					url: "http://other.web.ra01.sycdn.kuwo.cn/d5a898b9c8d91e8e4486011b7baccdb4/58a3c3b8/resource/n3/128/69/68/992887695.mp3",
					pic: "",
				}
			});
		</script><br><a id="more"></a><br><div id="dplayer0" class="dplayer" style="margin-bottom: 20px;"></div><script>var dplayer0 = new DPlayer({"element":document.getElementById("dplayer0"),"autoplay":false,"theme":"#FADFA3","loop":true,"video":{"url":"http://devtest.qiniudn.com/若能绽放光芒.mp4","pic":"http://devtest.qiniudn.com/若能绽放光芒.png"},"danmaku":{"api":"http://dplayer.daoapp.io","id":"9E2E3368B56CDBB4","token":"tokendemo"}});</script></p>
<p>Hexo官方插件：<a href="https://hexo.io/plugins/" target="_blank" rel="external">https://hexo.io/plugins/</a>  </p>
<p>需要用到两个播放器插件  </p>
<ul>
<li>hexo-tag-aplayer：<a href="https://github.com/grzhan/hexo-tag-aplayer#upstream-issue" target="_blank" rel="external">https://github.com/grzhan/hexo-tag-aplayer#upstream-issue</a>  </li>
<li>hexo-tag-dplayer：<a href="https://github.com/NextMoe/hexo-tag-dplayer" target="_blank" rel="external">https://github.com/NextMoe/hexo-tag-dplayer</a>  </li>
</ul>
<p>两款插件基于 <a href="https://github.com/DIYgod" target="_blank" rel="external">DIYgod</a> 编写的 html5 播放器 <a href="https://github.com/DIYgod/APlayer" target="_blank" rel="external">APlayer</a> 和 <a href="https://github.com/DIYgod/DPlayer" target="_blank" rel="external">DPlayer</a> 开发  </p>
<p>安装插件：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">pwd</span></div><div class="line">/e/GitHup_Data/Hexo_B<span class="built_in">log</span></div><div class="line">$ npm install hexo-tag-dplayer --save</div><div class="line">$ npm install hexo-tag-aplayer --save</div></pre></td></tr></table></figure></p>
<p>安装成功后，在Markdown文档中添加 APlayer 和 DPlayer 标签即可  </p>
<p>APlayer和DPlayer代码：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#APlayer Usage:</span></div><div class="line">&#123;% aplayer title author url [picture_url, narrow, autoplay, width:xxx, lrc:xxx] %&#125;</div></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&#123;% aplayer <span class="string">"You Raise Me Up"</span> <span class="string">"Westlife"</span> <span class="string">"http://other.web.ra01.sycdn.kuwo.cn/d5a898b9c8d91e8e4486011b7baccdb4/58a3c3b8/resource/n3/128/69/68/992887695.mp3"</span> <span class="string">"autoplay"</span> %&#125;</div><div class="line">&#123;% dplayer <span class="string">"url=http://devtest.qiniudn.com/若能绽放光芒.mp4"</span> <span class="string">"api=http://dplayer.daoapp.io"</span> <span class="string">"pic=http://devtest.qiniudn.com/若能绽放光芒.png"</span> <span class="string">"id=9E2E3368B56CDBB4"</span> <span class="string">"loop=yes"</span> <span class="string">"theme=#FADFA3"</span> <span class="string">"autoplay=false"</span> <span class="string">"token=tokendemo"</span> %&#125;</div></pre></td></tr></table></figure>
<p>注：dplayer存在BUG，研究了会但还是不会咋整，就把官方的贴出来了，嘿<br>参考：<a href="https://dplayer.js.org/docs/#/?id=usage" target="_blank" rel="external">https://dplayer.js.org/docs/#/?id=usage</a><br><a href="https://github.com/NextMoe/hexo-tag-dplayer" target="_blank" rel="external">https://github.com/NextMoe/hexo-tag-dplayer</a><br><a href="https://github.com/DIYgod/DPlayer" target="_blank" rel="external">https://github.com/DIYgod/DPlayer</a><br><a href="https://login926.top/2016/07/20/HexoMedia/" target="_blank" rel="external">https://login926.top/2016/07/20/HexoMedia/</a>  </p>
<hr>
<p>本作品采用<a href="https://creativecommons.org/licenses/by/2.5/cn/" target="_blank" rel="external">知识共享署名 2.5 中国大陆许可协议</a>进行许可，欢迎转载，但转载请注明来自<a href="https://yfshare.github.io">Jack Wang Blog</a>，并保持转载后文章内容的完整。本人保留所有版权相关权利。</p>
<p>本文出自”Jack Wang Blog”：<a href="https://yfshare.github.io/2017/02/15/Hexo插件之音乐视频/">https://yfshare.github.io/2017/02/15/Hexo插件之音乐视频/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;效果：&lt;br&gt;&lt;div id=&quot;aplayer0&quot; class=&quot;aplayer&quot; style=&quot;margin-bottom: 20px;&quot;&gt;&lt;/div&gt;
		&lt;script&gt;
			new APlayer({
				element: document.getElementById(&quot;aplayer0&quot;),
				narrow: false,
				autoplay: true,
				showlrc: 0,
				music: {
					title: &quot;You Raise Me Up&quot;,
					author: &quot;Westlife&quot;,
					url: &quot;http://other.web.ra01.sycdn.kuwo.cn/d5a898b9c8d91e8e4486011b7baccdb4/58a3c3b8/resource/n3/128/69/68/992887695.mp3&quot;,
					pic: &quot;&quot;,
				}
			});
		&lt;/script&gt;&lt;br&gt;
    
    </summary>
    
      <category term="Hexo" scheme="https://yfshare.github.io/categories/Hexo/"/>
    
    
      <category term="Hexo" scheme="https://yfshare.github.io/tags/Hexo/"/>
    
      <category term="music" scheme="https://yfshare.github.io/tags/music/"/>
    
      <category term="video" scheme="https://yfshare.github.io/tags/video/"/>
    
  </entry>
  
  <entry>
    <title>Hexo maupassant主题添加百度统计</title>
    <link href="https://yfshare.github.io/2017/02/14/Hexo-maupassant%E4%B8%BB%E9%A2%98%E6%B7%BB%E5%8A%A0%E7%99%BE%E5%BA%A6%E7%BB%9F%E8%AE%A1/"/>
    <id>https://yfshare.github.io/2017/02/14/Hexo-maupassant主题添加百度统计/</id>
    <published>2017-02-14T15:24:37.000Z</published>
    <updated>2017-02-16T03:44:13.904Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><p>百度统计：  </p>
<p>百度统计的结果至少需要等待半天时间才会有结果显示的哦(如果没有配置错误的话)<br>效果图：<br><a id="more"></a><br><img src="http://note.youdao.com/yws/api/personal/file/24CC1BB013334E6781854D6C820B1A45?method=download&amp;shareKey=a8dae77a9d9ea38701f59db854c0e7d5" alt="image">  </p>
<p>首先<a href="http://tongji.baidu.com/web/register" target="_blank" rel="external">注册 - 站长版</a>百度统计帐号并<a href="http://tongji.baidu.com/web/welcome/login" target="_blank" rel="external">登录</a><br>在管理选项卡新建站点<br><img src="http://note.youdao.com/yws/api/personal/file/85E4DD4B634A4CD3B9A68CB6B5809FBE?method=download&amp;shareKey=c84e499af592e81e6a4aaad72ee1f9c2" alt="image"><br><img src="http://note.youdao.com/yws/api/personal/file/D3F00C30C8F7463AB76242CD3F370890?method=download&amp;shareKey=e66264eee77d55dc8fa5cc954e5fd0c9" alt="image"><br><img src="http://note.youdao.com/yws/api/personal/file/4ECA09DB922545EA95C7861492C6B482?method=download&amp;shareKey=5126ffa078b6076ad076230fce71c41b" alt="image">  </p>
<p>从百度统计网站获取统计ID填入maupassant主题的_config.yml<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">pwd</span></div><div class="line">/e/GitHup_Data/Hexo_B<span class="built_in">log</span>/themes/maupassant</div><div class="line">$ grep -i <span class="string">'baidu_analytics'</span> _config.yml</div><div class="line">baidu_analytics: baidu_analytic_id <span class="comment">## Your Baidu Analytics tracking id, e.g. 8006843039519956000</span></div></pre></td></tr></table></figure></p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$ </span>hexo clean</div><div class="line"><span class="variable">$ </span>hexo g</div><div class="line"><span class="variable">$ </span>hexo d</div></pre></td></tr></table></figure>
<hr>
<p>本作品采用<a href="https://creativecommons.org/licenses/by/2.5/cn/" target="_blank" rel="external">知识共享署名 2.5 中国大陆许可协议</a>进行许可，欢迎转载，但转载请注明来自<a href="https://yfshare.github.io">Jack Wang Blog</a>，并保持转载后文章内容的完整。本人保留所有版权相关权利。</p>
<p>本文出自”Jack Wang Blog”：<a href="https://yfshare.github.io/2017/02/14/Hexo-maupassant主题添加百度统计/">https://yfshare.github.io/2017/02/14/Hexo-maupassant主题添加百度统计/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;百度统计：  &lt;/p&gt;
&lt;p&gt;百度统计的结果至少需要等待半天时间才会有结果显示的哦(如果没有配置错误的话)&lt;br&gt;效果图：&lt;br&gt;
    
    </summary>
    
      <category term="Hexo" scheme="https://yfshare.github.io/categories/Hexo/"/>
    
    
      <category term="Hexo" scheme="https://yfshare.github.io/tags/Hexo/"/>
    
      <category term="analytics" scheme="https://yfshare.github.io/tags/analytics/"/>
    
  </entry>
  
  <entry>
    <title>Hexo创建404页面</title>
    <link href="https://yfshare.github.io/2017/02/14/Hexo%E5%88%9B%E5%BB%BA404%E9%A1%B5%E9%9D%A2/"/>
    <id>https://yfshare.github.io/2017/02/14/Hexo创建404页面/</id>
    <published>2017-02-14T12:46:35.000Z</published>
    <updated>2017-02-16T02:55:12.386Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><p>其实这个页面很简单，但我个人喜欢干净的页面，所以觉得挺好<br><a href="https://yfshare.github.io//404.html">效果图</a>：<br><a id="more"></a><br><img src="http://note.youdao.com/yws/api/personal/file/F3B47D6155FC47D6ACA5D8C3C9A3C531?method=download&amp;shareKey=097f1b43c4b8819fa334c44c5891e595" alt="image">  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">pwd</span></div><div class="line">/e/GitHup_Data/Hexo_B<span class="built_in">log</span></div><div class="line">$ hexo new page 404</div><div class="line">INFO  Created: E:\GitHup_Data\Hexo_B<span class="built_in">log</span>\<span class="built_in">source</span>\404\index.md</div><div class="line">$ <span class="built_in">cd</span> <span class="built_in">source</span>/404/</div><div class="line">$ cat index.md</div><div class="line">title: 404 Not Found：该页无法显示</div><div class="line">toc: <span class="literal">false</span></div><div class="line">comments: <span class="literal">false</span></div><div class="line">permalink: /404</div><div class="line">---</div><div class="line">&lt;style <span class="built_in">type</span>=<span class="string">"text/css"</span>&gt;</div><div class="line">        .article-header &#123;</div><div class="line">                padding: 0;</div><div class="line">                padding-top: 26px;</div><div class="line">                border-left: none;</div><div class="line">                text-align: center;</div><div class="line">        &#125;</div><div class="line">        .article-header:hover &#123;</div><div class="line">                border-left: none;</div><div class="line">        &#125;</div><div class="line">        .article-title &#123;</div><div class="line">                font-size: 2.1em;</div><div class="line">        &#125;</div><div class="line">        strong a &#123;</div><div class="line">                color: <span class="comment">#747474;</span></div><div class="line">        &#125;</div><div class="line">        .article-meta &#123;</div><div class="line">                display: none;</div><div class="line">        &#125;</div><div class="line">        .share &#123;</div><div class="line">                display: none;</div><div class="line">        &#125;</div><div class="line">        .ds-meta &#123;</div><div class="line">                display: none;</div><div class="line">        &#125;</div><div class="line">        .player &#123;</div><div class="line">                margin-left: -10px;</div><div class="line">        &#125;</div><div class="line">        .sign &#123;</div><div class="line">                text-align: right;</div><div class="line">                font-style: italic;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">#page-visit &#123;</span></div><div class="line">                display: none;</div><div class="line">        &#125;</div><div class="line">        .center &#123;</div><div class="line">                text-align: center;</div><div class="line">                height: 2.5em;</div><div class="line">                font-weight: bold;</div><div class="line">        &#125;</div><div class="line">        .article-entry hr &#123;</div><div class="line">                margin: 0;</div><div class="line">        &#125;</div><div class="line">        .pic &#123;</div><div class="line">                text-align: center;</div><div class="line">                margin: 0;</div><div class="line">        &#125;</div><div class="line">        .pic br &#123;</div><div class="line">                display: none;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">#container .article-info-post.article-info &#123;</span></div><div class="line">        display: none;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">#container .article .article-title &#123;</span></div><div class="line">        padding: 0;</div><div class="line">        &#125;</div><div class="line">&lt;/style&gt;</div></pre></td></tr></table></figure>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$ </span>hexo g</div><div class="line"><span class="variable">$ </span>hexo d</div></pre></td></tr></table></figure>
<hr>
<p>本作品采用<a href="https://creativecommons.org/licenses/by/2.5/cn/" target="_blank" rel="external">知识共享署名 2.5 中国大陆许可协议</a>进行许可，欢迎转载，但转载请注明来自<a href="https://yfshare.github.io">Jack Wang Blog</a>，并保持转载后文章内容的完整。本人保留所有版权相关权利。</p>
<p>本文出自”Jack Wang Blog”：<a href="https://yfshare.github.io/2017/02/14/Hexo创建404页面/">https://yfshare.github.io/2017/02/14/Hexo创建404页面/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;其实这个页面很简单，但我个人喜欢干净的页面，所以觉得挺好&lt;br&gt;&lt;a href=&quot;https://yfshare.github.io//404.html&quot;&gt;效果图&lt;/a&gt;：&lt;br&gt;
    
    </summary>
    
      <category term="Hexo" scheme="https://yfshare.github.io/categories/Hexo/"/>
    
    
      <category term="hexo" scheme="https://yfshare.github.io/tags/hexo/"/>
    
      <category term="404" scheme="https://yfshare.github.io/tags/404/"/>
    
  </entry>
  
  <entry>
    <title>Hexo添加RSS订阅功能</title>
    <link href="https://yfshare.github.io/2017/02/14/Hexo%E6%B7%BB%E5%8A%A0RSS%E8%AE%A2%E9%98%85%E5%8A%9F%E8%83%BD/"/>
    <id>https://yfshare.github.io/2017/02/14/Hexo添加RSS订阅功能/</id>
    <published>2017-02-14T09:29:41.000Z</published>
    <updated>2017-02-27T10:18:29.150Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><p>Hexo添加RSS订阅功能  </p>
<p>先看看效果图：<br><a id="more"></a><br><img src="http://note.youdao.com/yws/api/personal/file/C236CE34602842F7BEDDD7E5C6610287?method=download&amp;shareKey=00f25ff8a255ccb1e62f24daaa506474" alt="image">  </p>
<p>首先安装安装hexo-generator-feed<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">pwd</span></div><div class="line">/e/GitHup_Data/Hexo_B<span class="built_in">log</span></div><div class="line">$ npm install hexo-generator-feed --save</div></pre></td></tr></table></figure></p>
<p>配置Hexo根目录_config.yml，配置RSS订阅<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">pwd</span></div><div class="line">/e/GitHup_Data/Hexo_B<span class="built_in">log</span></div><div class="line">$ head -72 _config.yml | tail -7</div><div class="line">plugin:</div><div class="line">- hexo-generator-feed</div><div class="line"><span class="comment">#Feed Atom</span></div><div class="line">feed:</div><div class="line"><span class="built_in">type</span>: atom</div><div class="line">path: atom.xml</div><div class="line"><span class="built_in">limit</span>: 20</div></pre></td></tr></table></figure></p>
<p>配置主题下的_config.yml，添加RSS订阅链接<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">pwd</span></div><div class="line">/e/GitHup_Data/Hexo_B<span class="built_in">log</span></div><div class="line">$ <span class="built_in">cd</span> themes/maupassant/</div><div class="line">$ tail -3 _config.yml</div><div class="line"><span class="comment"># SubNav</span></div><div class="line">subnav:</div><div class="line">rss: <span class="string">"/atom.xml"</span></div></pre></td></tr></table></figure></p>
<p>添加之后，运行hexo g后，就会在页面上生成RSS图标<br><img src="http://note.youdao.com/yws/api/personal/file/E808B018F8CB4145A42A20531780077C?method=download&amp;shareKey=32d712cfbfe310797ea8f9749a83e747" alt="image">  </p>
<hr>
<p>本作品采用<a href="https://creativecommons.org/licenses/by/2.5/cn/" target="_blank" rel="external">知识共享署名 2.5 中国大陆许可协议</a>进行许可，欢迎转载，但转载请注明来自<a href="https://yfshare.github.io">Jack Wang Blog</a>，并保持转载后文章内容的完整。本人保留所有版权相关权利。</p>
<p>本文出自”Jack Wang Blog”：<a href="https://yfshare.github.io/2017/02/14/Hexo添加RSS订阅功能/">https://yfshare.github.io/2017/02/14/Hexo添加RSS订阅功能/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Hexo添加RSS订阅功能  &lt;/p&gt;
&lt;p&gt;先看看效果图：&lt;br&gt;
    
    </summary>
    
      <category term="Hexo" scheme="https://yfshare.github.io/categories/Hexo/"/>
    
    
      <category term="RSS" scheme="https://yfshare.github.io/tags/RSS/"/>
    
  </entry>
  
  <entry>
    <title>Hexo添加版权说明</title>
    <link href="https://yfshare.github.io/2017/02/14/Hexo%E6%B7%BB%E5%8A%A0%E7%89%88%E6%9D%83%E8%AF%B4%E6%98%8E/"/>
    <id>https://yfshare.github.io/2017/02/14/Hexo添加版权说明/</id>
    <published>2017-02-14T04:11:43.000Z</published>
    <updated>2017-02-14T16:02:27.445Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><p>博客是文字创造的产物，是知识共享的一种形式。尊重版权意味着是对作者劳动成功的肯定和赞赏。当我们无视版权的时候，这意味着知识是没有价值的，创造是无关痛痒的，脑力劳动和创意活动的价值在现实中被无情地扼杀。当你引用一个人的观点却不加以注明的时候，当你盗用一个人的创意却不给予报酬的时候，试问谁还会愿意为这个社会贡献创意和想法呢？<br><a id="more"></a><br>在博客根目录创建一个scripts的文件夹<br>在scritps文件夹内，新建一个AddTail.js脚本文件，内容如下<br>在博客根目录，新建一个tail.md文件，里面写想要展示的版本说明内容<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">pwd</span></div><div class="line">/e/GitHup_Data/Hexo_B<span class="built_in">log</span></div><div class="line">$ mkdir scripts</div><div class="line">$ cat scripts/AddTail.js</div><div class="line">// Filename: AddTail.js</div><div class="line">// Author: Colin</div><div class="line">// Date: 2016/06/02</div><div class="line">// Based on the script by KUANG Qi: http://kuangqi.me/tricks/append<span class="_">-a</span>-copyright-info-after-every-post/</div><div class="line"></div><div class="line">// Add a tail to every post from tail.md</div><div class="line">// Great <span class="keyword">for</span> adding copyright info</div><div class="line"></div><div class="line">var fs = require(<span class="string">'fs'</span>);</div><div class="line"></div><div class="line">hexo.extend.filter.register(<span class="string">'before_post_render'</span>, <span class="keyword">function</span>(data)&#123;</div><div class="line">        <span class="keyword">if</span>(data.copyright == <span class="literal">false</span>) <span class="built_in">return</span> data;</div><div class="line"></div><div class="line">        // Add seperate line</div><div class="line">        data.content += <span class="string">'\n___\n'</span>;</div><div class="line"></div><div class="line">        // Try to <span class="built_in">read</span> tail.md</div><div class="line">        try &#123;</div><div class="line">                var file_content = fs.readFileSync(<span class="string">'tail.md'</span>);</div><div class="line">                <span class="keyword">if</span>(file_content &amp;&amp; data.content.length &gt; 50)</div><div class="line">                &#123;</div><div class="line">                        data.content += file_content;</div><div class="line">                &#125;</div><div class="line">        &#125; catch (err) &#123;</div><div class="line">                <span class="keyword">if</span> (err.code !== <span class="string">'ENOENT'</span>) throw err;</div><div class="line"></div><div class="line">                // No process <span class="keyword">for</span> ENOENT error</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        // 添加具体文章链接, 不需要去掉即可</div><div class="line">        var permalink = <span class="string">'\n本文出自"Jack Wang Blog"：'</span> + data.permalink;</div><div class="line">        data.content += permalink;</div><div class="line"></div><div class="line">        <span class="built_in">return</span> data;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">$ cat tail.md</div><div class="line">本作品采用[知识共享署名 2.5 中国大陆许可协议](https://creativecommons.org/licenses/by/2.5/cn/)进行许可，欢迎转载，但转载请注明来自[Jack Wang B<span class="built_in">log</span>](https://yfshare.github.io)，并保持转载后文章内容的完整。本人保留所有版权相关权利。</div><div class="line"></div><div class="line">$ hexo clean</div><div class="line">$ hexo g</div><div class="line">$ hexo deploy</div></pre></td></tr></table></figure></p>
<p>效果图：<br><img src="http://note.youdao.com/yws/api/personal/file/85DA80DB248F4F71A3A5D32FA7970457?method=download&amp;shareKey=15345a6812577d1860858e38ff2734e4" alt="image">  </p>
<hr>
<p>本作品采用<a href="https://creativecommons.org/licenses/by/2.5/cn/" target="_blank" rel="external">知识共享署名 2.5 中国大陆许可协议</a>进行许可，欢迎转载，但转载请注明来自<a href="https://yfshare.github.io">Jack Wang Blog</a>，并保持转载后文章内容的完整。本人保留所有版权相关权利。</p>
<p>本文出自”Jack Wang Blog”：<a href="https://yfshare.github.io/2017/02/14/Hexo添加版权说明/">https://yfshare.github.io/2017/02/14/Hexo添加版权说明/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;博客是文字创造的产物，是知识共享的一种形式。尊重版权意味着是对作者劳动成功的肯定和赞赏。当我们无视版权的时候，这意味着知识是没有价值的，创造是无关痛痒的，脑力劳动和创意活动的价值在现实中被无情地扼杀。当你引用一个人的观点却不加以注明的时候，当你盗用一个人的创意却不给予报酬的时候，试问谁还会愿意为这个社会贡献创意和想法呢？&lt;br&gt;
    
    </summary>
    
      <category term="Hexo" scheme="https://yfshare.github.io/categories/Hexo/"/>
    
    
      <category term="hexo" scheme="https://yfshare.github.io/tags/hexo/"/>
    
      <category term="版权说明" scheme="https://yfshare.github.io/tags/%E7%89%88%E6%9D%83%E8%AF%B4%E6%98%8E/"/>
    
  </entry>
  
  <entry>
    <title>Hexo maupassant主题添加多说评论系统</title>
    <link href="https://yfshare.github.io/2017/02/14/Hexo-maupassant%E4%B8%BB%E9%A2%98%E6%B7%BB%E5%8A%A0%E5%A4%9A%E8%AF%B4%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9F/"/>
    <id>https://yfshare.github.io/2017/02/14/Hexo-maupassant主题添加多说评论系统/</id>
    <published>2017-02-14T03:27:02.000Z</published>
    <updated>2017-02-16T02:54:31.302Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><p>Hexo maupassant主题添加多说评论系统  </p>
<p>查看效果<br><a id="more"></a><br><img src="http://note.youdao.com/yws/api/personal/file/804AA9EC4321495386EBAB8F13C8C2EB?method=download&amp;shareKey=f772eecd7e83c252667291edb9a2e9f8" alt="image">  </p>
<p>登录<a href="http://yfshare.duoshuo.com" target="_blank" rel="external">多说官网</a><br><a href="http://duoshuo.com/create-site/" target="_blank" rel="external">创建站点</a><br><img src="http://note.youdao.com/yws/api/personal/file/766F52EF87224EB5AA7F9574F1A522AC?method=download&amp;shareKey=382814d963e4e2d578139705ae739b23" alt="image"></p>
<p>站点创建成功后，设置相关属性<br><img src="http://note.youdao.com/yws/api/personal/file/7E04F5162EA140E9B03F390F9C526156?method=download&amp;shareKey=a9ff4b32519b0c54650b9209ec75fe3b" alt="image">  </p>
<p>配置Hexo，使其使用多说评论系统<br>修改maupassant主题的_config.yml文件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">pwd</span></div><div class="line">/e/GitHup_Data/Hexo_B<span class="built_in">log</span>/themes/maupassant</div><div class="line">$ grep -i <span class="string">'^duoshuo'</span> _config.yml</div><div class="line">duoshuo: yfshare <span class="comment">## Your duoshuo_shortname, e.g. username</span></div><div class="line"><span class="comment">#这里的duoshuo_shortname是在创建多说站点时，在多说域名那输入的字段</span></div><div class="line"></div><div class="line"><span class="comment"># hexo g</span></div><div class="line"><span class="comment"># hexo server</span></div></pre></td></tr></table></figure></p>
<hr>
<p>本作品采用<a href="https://creativecommons.org/licenses/by/2.5/cn/" target="_blank" rel="external">知识共享署名 2.5 中国大陆许可协议</a>进行许可，欢迎转载，但转载请注明来自<a href="https://yfshare.github.io">Jack Wang Blog</a>，并保持转载后文章内容的完整。本人保留所有版权相关权利。</p>
<p>本文出自”Jack Wang Blog”：<a href="https://yfshare.github.io/2017/02/14/Hexo-maupassant主题添加多说评论系统/">https://yfshare.github.io/2017/02/14/Hexo-maupassant主题添加多说评论系统/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Hexo maupassant主题添加多说评论系统  &lt;/p&gt;
&lt;p&gt;查看效果&lt;br&gt;
    
    </summary>
    
      <category term="Hexo" scheme="https://yfshare.github.io/categories/Hexo/"/>
    
    
      <category term="Hexo" scheme="https://yfshare.github.io/tags/Hexo/"/>
    
      <category term="maupassant" scheme="https://yfshare.github.io/tags/maupassant/"/>
    
      <category term="多说" scheme="https://yfshare.github.io/tags/%E5%A4%9A%E8%AF%B4/"/>
    
  </entry>
  
  <entry>
    <title>安装maupassant-hexo主题</title>
    <link href="https://yfshare.github.io/2017/02/13/%E5%AE%89%E8%A3%85maupassant-hexo%E4%B8%BB%E9%A2%98/"/>
    <id>https://yfshare.github.io/2017/02/13/安装maupassant-hexo主题/</id>
    <published>2017-02-13T13:05:21.000Z</published>
    <updated>2017-02-14T15:57:19.244Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><p>Maupassant最初是由Cho大神为Typecho平台设计开发的一套响应式模板，体积只有20KB，在各种尺寸的设备上表现出色。由于其简洁大气的风格受到许多用户喜爱，目前也已经被移植到了多个平台上，例如：</p>
<p>Typecho：<a href="https://github.com/pagecho/maupassant/" target="_blank" rel="external">https://github.com/pagecho/maupassant/</a><br>Octopress：<a href="https://github.com/pagecho/mewpassant/" target="_blank" rel="external">https://github.com/pagecho/mewpassant/</a><br>Farbox：<a href="https://github.com/pagecho/Maupassant-farbox/" target="_blank" rel="external">https://github.com/pagecho/Maupassant-farbox/</a><br>Wordpress：<a href="https://github.com/iMuFeng/maupassant/" target="_blank" rel="external">https://github.com/iMuFeng/maupassant/</a><br>Ghost: <a href="https://github.com/LjxPrime/maupassant/" target="_blank" rel="external">https://github.com/LjxPrime/maupassant/</a><br><a id="more"></a><br>Hexo更换maupassant主题：<br>参考：<a href="https://github.com/tufu9441/maupassant-hexo" target="_blank" rel="external">https://github.com/tufu9441/maupassant-hexo</a><br>淘宝npm源：<a href="http://npm.taobao.org/" target="_blank" rel="external">http://npm.taobao.org/</a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">pwd</span></div><div class="line">/e/GitHup_Data/Hexo_B<span class="built_in">log</span></div><div class="line">$ git <span class="built_in">clone</span> https://github.com/tufu9441/maupassant-hexo.git themes/maupassant</div><div class="line">$ npm install hexo-renderer-jade --save</div><div class="line">$ npm install hexo-renderer-sass --save   <span class="comment">#在国内网络原因，这个是安装不了的，可以使用taobao npm源解决</span></div><div class="line">$ npm install -g cnpm --registry=https://registry.npm.taobao.org   <span class="comment">#使用taobao源的cnpm代替官方的npm</span></div><div class="line">$ cnpm install hexo-renderer-sass --save   <span class="comment">#安装hexo-renderer-sass插件</span></div><div class="line">$ grep -i <span class="string">'^theme'</span> _config.yml</div><div class="line">theme: maupassant</div><div class="line">$ hexo g</div><div class="line">$ hexo server</div><div class="line"></div><div class="line">$ hexo deploy</div></pre></td></tr></table></figure></p>
<p><img src="http://note.youdao.com/yws/api/personal/file/5068DA269F7B404BABDE5FC96C4CB002?method=download&amp;shareKey=4f37242ddca3be850964313ceadf8c4d" alt="image">  </p>
<p>个人觉得还有个不错的主题哦。Githup上都有安装的方法哦~<br><a href="https://github.com/iissnan/hexo-theme-next" target="_blank" rel="external">https://github.com/iissnan/hexo-theme-next</a>  </p>
<hr>
<p>本作品采用<a href="https://creativecommons.org/licenses/by/2.5/cn/" target="_blank" rel="external">知识共享署名 2.5 中国大陆许可协议</a>进行许可，欢迎转载，但转载请注明来自<a href="https://yfshare.github.io">Jack Wang Blog</a>，并保持转载后文章内容的完整。本人保留所有版权相关权利。</p>
<p>本文出自”Jack Wang Blog”：<a href="https://yfshare.github.io/2017/02/13/安装maupassant-hexo主题/">https://yfshare.github.io/2017/02/13/安装maupassant-hexo主题/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Maupassant最初是由Cho大神为Typecho平台设计开发的一套响应式模板，体积只有20KB，在各种尺寸的设备上表现出色。由于其简洁大气的风格受到许多用户喜爱，目前也已经被移植到了多个平台上，例如：&lt;/p&gt;
&lt;p&gt;Typecho：&lt;a href=&quot;https://github.com/pagecho/maupassant/&quot;&gt;https://github.com/pagecho/maupassant/&lt;/a&gt;&lt;br&gt;Octopress：&lt;a href=&quot;https://github.com/pagecho/mewpassant/&quot;&gt;https://github.com/pagecho/mewpassant/&lt;/a&gt;&lt;br&gt;Farbox：&lt;a href=&quot;https://github.com/pagecho/Maupassant-farbox/&quot;&gt;https://github.com/pagecho/Maupassant-farbox/&lt;/a&gt;&lt;br&gt;Wordpress：&lt;a href=&quot;https://github.com/iMuFeng/maupassant/&quot;&gt;https://github.com/iMuFeng/maupassant/&lt;/a&gt;&lt;br&gt;Ghost: &lt;a href=&quot;https://github.com/LjxPrime/maupassant/&quot;&gt;https://github.com/LjxPrime/maupassant/&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="Hexo" scheme="https://yfshare.github.io/categories/Hexo/"/>
    
    
      <category term="Hexo" scheme="https://yfshare.github.io/tags/Hexo/"/>
    
      <category term="maupassant" scheme="https://yfshare.github.io/tags/maupassant/"/>
    
  </entry>
  
  <entry>
    <title>使用GitHub-Hexo搭建免费静态Blog</title>
    <link href="https://yfshare.github.io/2017/02/13/%E4%BD%BF%E7%94%A8GitHub-Hexo%E6%90%AD%E5%BB%BA%E5%85%8D%E8%B4%B9%E9%9D%99%E6%80%81Blog/"/>
    <id>https://yfshare.github.io/2017/02/13/使用GitHub-Hexo搭建免费静态Blog/</id>
    <published>2017-02-13T06:33:54.000Z</published>
    <updated>2017-02-14T16:44:14.251Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><p>Hexo官网：<a href="https://hexo.io/zh-cn/" target="_blank" rel="external">https://hexo.io/zh-cn/</a><br>Hexo官方安装文档：<a href="https://hexo.io/zh-cn/docs/" target="_blank" rel="external">https://hexo.io/zh-cn/docs/</a>  </p>
<h2 id="了解Hexo优点"><a href="#了解Hexo优点" class="headerlink" title="了解Hexo优点"></a>了解Hexo优点</h2><table>
<thead>
<tr>
<th>优点</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>超快速度</td>
<td>Node.js 所带来的超快生成速度，让上百个页面在几秒内瞬间完成渲染</td>
</tr>
<tr>
<td>一键部署</td>
<td>只需一条指令即可部署到 GitHub Pages, Heroku 或其他网站</td>
</tr>
<tr>
<td>支持Markdown</td>
<td>Hexo 支持 GitHub Flavored Markdown 的所有功能，甚至可以整合 Octopress 的大多数插件</td>
</tr>
<tr>
<td>丰富的插件</td>
<td>Hexo 拥有强大的插件系统，安装插件可以让 Hexo 支持 Jade, CoffeeScript</td>
</tr>
</tbody>
</table>
<a id="more"></a>
<p>环境：Hexo 3.x<br>　　　Windows7 x64Bit  </p>
<h2 id="安装Git-for-Windows"><a href="#安装Git-for-Windows" class="headerlink" title="安装Git for Windows"></a>安装Git for Windows</h2><p>Git for Windows下载地址：<a href="https://git-for-windows.github.io/" target="_blank" rel="external">https://git-for-windows.github.io/</a><br><a href="http://note.youdao.com/yws/api/personal/file/E8BA4EC159A44DD2BBD1A1B93FF92071?method=download&amp;shareKey=f77cb49e8f2061364c5c2bf65b2ce716" target="_blank" rel="external">Git for Windows 2.11下载地址</a>  </p>
<h2 id="安装Node-JS"><a href="#安装Node-JS" class="headerlink" title="安装Node.JS"></a>安装Node.JS</h2><p>Node.js是一个基于Chrome的V8 JavaScript引擎的JavaScript运行时环境<br>Node.JS for Windows下载地址：<a href="https://nodejs.org/en/" target="_blank" rel="external">https://nodejs.org/en/</a><br><a href="http://note.youdao.com/yws/api/personal/file/5FCECD3216F247288C3C160C212E02A7?method=download&amp;shareKey=21cd785dbd7a375ba7aa6604afecce45" target="_blank" rel="external">node.js-v7.5.0-x64.msi下载地址</a><br>旧版的Node.JS需要配置path环境变量，新版的在安装时会自动配置Path，即可以直接使用npm命令<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">C:\&gt;npm --help</div><div class="line">Usage: npm &lt;<span class="built_in">command</span>&gt;</div><div class="line"><span class="built_in">where</span> &lt;<span class="built_in">command</span>&gt; is one of:</div><div class="line">    access, adduser, bin, bugs, c, cache, completion, config,</div><div class="line">    ddp, dedupe, deprecate, dist-tag, docs, doctor, edit,</div><div class="line">    explore, get, <span class="built_in">help</span>, <span class="built_in">help</span>-search, i, init, install,</div><div class="line">    install-test, it, link, list, ln, login, <span class="built_in">logout</span>, ls,</div><div class="line">    outdated, owner, pack, ping, prefix, prune, publish, rb,</div><div class="line">    rebuild, repo, restart, root, run, run-script, s, se,</div><div class="line">    search, <span class="built_in">set</span>, shrinkwrap, star, stars, start, stop, t, team,</div><div class="line">    <span class="built_in">test</span>, tst, un, uninstall, unpublish, unstar, up, update, v,</div><div class="line">    version, view, whoami</div><div class="line">    </div><div class="line">npm &lt;cmd&gt; -h     quick <span class="built_in">help</span> on &lt;cmd&gt;</div><div class="line">npm <span class="_">-l</span>           display full usage info</div><div class="line">npm <span class="built_in">help</span> &lt;term&gt;  search <span class="keyword">for</span> <span class="built_in">help</span> on &lt;term&gt;</div><div class="line">npm <span class="built_in">help</span> npm     involved overview</div><div class="line"></div><div class="line">Specify configs <span class="keyword">in</span> the ini-formatted file:</div><div class="line">    C:\Users\yfshare\.npmrc</div><div class="line">or on the <span class="built_in">command</span> line via: npm &lt;<span class="built_in">command</span>&gt; --key value</div><div class="line">Config info can be viewed via: npm <span class="built_in">help</span> config</div><div class="line"></div><div class="line">npm@4.1.2 C:\Program Files\nodejs\node_modules\npm</div><div class="line">C:\&gt;</div></pre></td></tr></table></figure></p>
<h2 id="安装Hexo"><a href="#安装Hexo" class="headerlink" title="安装Hexo"></a>安装Hexo</h2><p>打开Windows桌面上的Git shell<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">npm install hexo-cli -g  <span class="comment">#安装到这里了C:\Users\yfshare\AppData\Roaming\npm</span></div><div class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org  <span class="comment">#更换npm源</span></div><div class="line">npm install hexo --save</div></pre></td></tr></table></figure></p>
<h2 id="初始化Hexo配置"><a href="#初始化Hexo配置" class="headerlink" title="初始化Hexo配置"></a>初始化Hexo配置</h2><p>创建Hexo文件夹<br>安装完成后，建立Data目录(随意，目录最好不要有空格特殊字符之类的)，进入 Git Shell 切换到 E:\GitHup_Data\GitHup\Hexo 执行下面的指令：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">cd</span> /E/GitHup_Data/Hexo_B<span class="built_in">log</span>/  <span class="comment">#GitHup是bash环境，切换路径命令</span></div><div class="line">$ hexo init</div><div class="line">$ npm install</div><div class="line">$ ls</div><div class="line">_config.yml  node_modules/  package.json  scaffolds/  <span class="built_in">source</span>/  themes/</div></pre></td></tr></table></figure></p>
<p>安装Hexo插件<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">$ cd /E/GitHup_Data/Hexo_Blog/</div><div class="line">$ npm <span class="keyword">install</span> hexo-generator-<span class="keyword">index</span> <span class="comment">--save</span></div><div class="line">$ npm <span class="keyword">install</span> hexo-generator-<span class="keyword">archive</span> <span class="comment">--save</span></div><div class="line">$ npm <span class="keyword">install</span> hexo-generator-<span class="keyword">category</span> <span class="comment">--save</span></div><div class="line">$ npm <span class="keyword">install</span> hexo-generator-tag <span class="comment">--save</span></div><div class="line">$ npm <span class="keyword">install</span> hexo-<span class="keyword">server</span> <span class="comment">--save</span></div><div class="line">$ npm <span class="keyword">install</span> hexo-deployer-git <span class="comment">--save</span></div><div class="line">$ npm <span class="keyword">install</span> hexo-deployer-heroku <span class="comment">--save</span></div><div class="line">$ npm <span class="keyword">install</span> hexo-deployer-rsync <span class="comment">--save</span></div><div class="line">$ npm <span class="keyword">install</span> hexo-deployer-openshift <span class="comment">--save</span></div><div class="line">$ npm <span class="keyword">install</span> hexo-renderer-marked@<span class="number">0.2</span> <span class="comment">--save</span></div><div class="line">$ npm <span class="keyword">install</span> hexo-renderer-stylus@<span class="number">0.2</span> <span class="comment">--save</span></div><div class="line">$ npm <span class="keyword">install</span> hexo-generator-feed@<span class="number">1</span> <span class="comment">--save</span></div><div class="line">$ npm <span class="keyword">install</span> hexo-generator-sitemap@<span class="number">1</span> <span class="comment">--save</span></div></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">$ hexo -v</div><div class="line">hexo-cli: 1.0.2</div><div class="line">os: Windows_NT 6.1.7601 win32 x64</div><div class="line">http_parser: 2.7.0</div><div class="line">node: 7.5.0</div><div class="line">v8: 5.4.500.48</div><div class="line">uv: 1.10.2</div><div class="line">zlib: 1.2.8</div><div class="line">ares: 1.10.1-DEV</div><div class="line">modules: 51</div><div class="line">openssl: 1.0.2k</div><div class="line">icu: 58.2</div><div class="line">unicode: 9.0</div><div class="line">cldr: 30.0.3</div><div class="line">tz: 2016j</div></pre></td></tr></table></figure>
<p>本地验收<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">cd</span> /E/GitHup_Data/Hexo_B<span class="built_in">log</span>/</div><div class="line">$ hexo g  <span class="comment">#生成public文件夹</span></div><div class="line">$ hexo server</div><div class="line">INFO  Start processing</div><div class="line">INFO  Hexo is running at http://localhost:4000/. Press Ctrl+C to stop.</div></pre></td></tr></table></figure></p>
<p><img src="http://note.youdao.com/yws/api/personal/file/F50DFC5051A046F093861703CDBAA7ED?method=download&amp;shareKey=7103cfa4850d3b9beb0fa05b2a650176" alt="image">  </p>
<p>Hexo简写命令<br><figure class="highlight nginx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">hexo</span> n <span class="comment">#生成文章，或者source\_posts手动编辑</span></div><div class="line">hexo s <span class="comment">#本地发布预览效果</span></div><div class="line">hexo g <span class="comment">#生成public静态文件</span></div><div class="line"><span class="comment">#最后手动同步更新至GitHub</span></div></pre></td></tr></table></figure></p>
<h2 id="配置Hexo"><a href="#配置Hexo" class="headerlink" title="配置Hexo"></a>配置Hexo</h2><p>参考官方文档：<a href="https://hexo.io/zh-cn/docs/configuration.html" target="_blank" rel="external">https://hexo.io/zh-cn/docs/configuration.html</a><br>在配置过程中请使用<a href="http://www.yamllint.com/" target="_blank" rel="external">yamllint</a>来保证自己的yaml语法正确  </p>
<p>网站存放在子目录<br>如果您的网站存放在子目录中，例如 <a href="http://yoursite.com/blog" target="_blank" rel="external">http://yoursite.com/blog</a> ，则请将您的 url设为 <a href="http://yoursite.com/blog" target="_blank" rel="external">http://yoursite.com/blog</a> 并把 root 设为 /blog/  </p>
<p>在本地的hexo目录下的source目录下新建CNAME文件，内容为youdomain<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">cd</span> /e/GitHup_Data/Hexo_B<span class="built_in">log</span>/<span class="built_in">source</span>/</div><div class="line">$ ls</div><div class="line">_posts/  CNAME</div><div class="line">$ cat CNAME</div><div class="line">https://yfshare.github.io/Hexo_B<span class="built_in">log</span></div></pre></td></tr></table></figure></p>
<p>Hexo主题设置<br>官方主题库：<a href="https://hexo.io/themes/" target="_blank" rel="external">https://hexo.io/themes/</a><br>参考文档：<a href="http://jiji262.github.io/2016/04/15/2016-04-15-hexo-github-pages-blog/" target="_blank" rel="external">http://jiji262.github.io/2016/04/15/2016-04-15-hexo-github-pages-blog/</a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">cd</span> /e/GitHup_Data/Hexo_B<span class="built_in">log</span>/themes</div><div class="line">$ hexo clean</div><div class="line">$ git <span class="built_in">clone</span> https://github.com/luuman/hexo-theme-spfk</div><div class="line"><span class="comment">#修改Hexo目录下的_config.yml配置文件中的theme属性，将其设置为hexo-theme-spfk(新下载的主题)</span></div><div class="line">$ grep -i <span class="string">'^theme'</span> ../_config.yml</div><div class="line">theme: landscape</div><div class="line">$ sed -i <span class="string">'/^theme/s/landscape/hexo-theme-spfk/'</span> ../_config.yml</div><div class="line">$ grep -i <span class="string">'^theme'</span> ../_config.yml</div><div class="line">theme: hexo-theme-spfk</div><div class="line">$</div><div class="line"><span class="comment">#更换主题</span></div><div class="line">$ <span class="built_in">cd</span> hexo-theme-spfk/</div><div class="line">$ git pull</div><div class="line">Already up-to-date.</div><div class="line">$ <span class="built_in">cd</span> /e/GitHup_Data/Hexo_B<span class="built_in">log</span>/</div><div class="line">$ hexo g   <span class="comment">#必须要切换到Hexo根目录才能执行hexo g命令，否则报错</span></div><div class="line">$ hexo server  <span class="comment">#同上</span></div></pre></td></tr></table></figure></p>
<p>更换新主题成功<br><img src="http://note.youdao.com/yws/api/personal/file/1A69C10346B44ADAB7B07C13E25575C4?method=download&amp;shareKey=bea475262c87db06114d0c19442f516a" alt="image">  </p>
<p>Github shell连接 Githup.com<br>参考：<a href="https://help.github.com/articles/connecting-to-github-with-ssh/" target="_blank" rel="external">https://help.github.com/articles/connecting-to-github-with-ssh/</a><br>生成SSH KEY<br><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">$ ssh-keygen -t rsa -b 4096 -C <span class="string">"your_email@example.com"</span></div><div class="line">Generating public/private rsa key pair.</div><div class="line">Enter file in which to save the key (/c/Users/yfshare/.ssh/id_rsa):</div><div class="line">Enter passphrase (empty for no passphrase):  <span class="comment">#这里输入密码，Github的密码</span></div><div class="line">Enter same passphrase again:</div><div class="line">Your identification has been saved in /c/Users/yfshare/.ssh/id_rsa.</div><div class="line">Your public key has been saved in /c/Users/yfshare/.ssh/id_rsa.pub.</div><div class="line">The key fingerprint is:</div><div class="line">SHA256:Vuxj3gxPJPaNv5/jUffiaSwsN2ufyCsyQ your_email<span class="meta">@example.com</span></div><div class="line">The key's randomart image is:</div><div class="line">+---[RSA 4096]----+</div><div class="line">|<span class="string">                 </span>|</div><div class="line">|<span class="string">         .  . .  </span>|</div><div class="line">|<span class="string">          =o.=   </span>|</div><div class="line">|<span class="string">        E+=+ooo  </span>|</div><div class="line">|<span class="string">        So==+.. o</span>|</div><div class="line">|<span class="string">       . o+B .  +</span>|</div><div class="line">|<span class="string">          .o++o..</span>|</div><div class="line">|<span class="string">          + O.=*o</span>|</div><div class="line">|<span class="string">          .O.BO=o</span>|</div><div class="line">+----[SHA256]-----+</div><div class="line">$</div></pre></td></tr></table></figure></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ cd ~/<span class="selector-class">.ssh</span></div><div class="line">$ ls</div><div class="line">id_rsa  id_rsa<span class="selector-class">.pub</span></div><div class="line">$ cat id_rsa<span class="selector-class">.pub</span>   <span class="selector-id">#github</span> ssh公钥</div><div class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDjABJRUmtfpxTOiaPlItHVbzmnTVTh1OhYP2uSu3mgsACthhuZ9pVQz44flE1KUSnPaxPiYOfUXkHQ/ZKeZY/xs2bLXQUglZHuAVopyhsmnUUZy4Ycz9cUw8meC2YfdIyBnUNgSt0cVRGEAaaO7gOfPqWRCcGW8m1493LD+YhPNIQkFyQK0BzUkkOkkCnpZkoQaUF7XYtmVcrN/Yg66Pwr0hSZKLqL4Q0fPYj9ZligiaE54FKQ9ORVJskrOuw8Xp/P2sdGlmbRMu9W9w6qOTlLw7KrctsqjM2Up7X20lzassdgqweqwda your_email@example.com</div></pre></td></tr></table></figure>
<p>然后把生成的ssh key添加到Githup上<br>登录Githup – Settings – SSH and GPG keys — New SSH key<br><img src="http://note.youdao.com/yws/api/personal/file/9994071BDE794AC29EB6DD24B1B3DC5E?method=download&amp;shareKey=c94ba1280c017e87856ae0fa7ae96fec" alt="image">  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ ssh -T git@github.com   <span class="comment">#登录GitHup</span></div><div class="line">Enter passphrase <span class="keyword">for</span> key <span class="string">'/c/Users/yfshare/.ssh/id_rsa'</span>:</div><div class="line">Hi yfshare! You<span class="string">'ve successfully authenticated, but GitHub does not provide shell access.</span></div><div class="line">#登录GitHup成功</div></pre></td></tr></table></figure>
<h2 id="部署静态网页到GitHub"><a href="#部署静态网页到GitHub" class="headerlink" title="部署静态网页到GitHub"></a>部署静态网页到GitHub</h2><p>Githup<a href="https://github.com/" target="_blank" rel="external">注册</a>略，<a href="https://github.com/login?return_to=%2Fjoin" target="_blank" rel="external">登录</a>Githup<br>建立与你用户名对应的仓库，仓库名必须为[your_user_name.github.io]<br>登录GitHup – New repository – yfshare.github.io(Repository name)<br>等待审核通过后，访问：<a href="https://github.com/yfshare/yfshare.github.io" target="_blank" rel="external">https://github.com/yfshare/yfshare.github.io</a><br><img src="http://note.youdao.com/yws/api/personal/file/C9FBCA72F4CD4D58A91D7AAB24D94889?method=download&amp;shareKey=934b518e3706aa5964b124dc9bdba86e" alt="image">  </p>
<p>上传Hexo代码到Githup<br>参考：<a href="https://hexo.io/zh-cn/docs/deployment.html" target="_blank" rel="external">https://hexo.io/zh-cn/docs/deployment.html</a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">pwd</span></div><div class="line">/e/GitHup_Data/Hexo_B<span class="built_in">log</span></div><div class="line">$ tail -6 _config.yml</div><div class="line"><span class="comment"># Deployment</span></div><div class="line"><span class="comment">## Docs: https://hexo.io/docs/deployment.html</span></div><div class="line">deploy:</div><div class="line">  <span class="built_in">type</span>: git</div><div class="line">  repository: git@github.com:yfshare/yfshare.github.io.git</div><div class="line">  branch: master</div><div class="line">$ hexo deploy</div></pre></td></tr></table></figure></p>
<p><img src="http://note.youdao.com/yws/api/personal/file/919BDBDA225F429581329E9D396BD06E?method=download&amp;shareKey=97eb5d3e1bf0e7a8a20dc8a3251e0dc5" alt="image">  </p>
<p>访问：<a href="https://yfshare.github.io/">https://yfshare.github.io/</a><br><img src="http://note.youdao.com/yws/api/personal/file/1A8F036079E944758528DE2B0C968A66?method=download&amp;shareKey=ebafa32ad50767e7f0dadd9fdc9b944d" alt="image"><br>如果能打开网页就说明部署成功了  </p>
<p>创建小文章：<br>参考：<a href="https://hexo.io/zh-cn/docs/writing.html" target="_blank" rel="external">https://hexo.io/zh-cn/docs/writing.html</a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#写文档前需要把hexo停止，如果运行了hexo server的话，否则可能会生成2篇相同的文章</span></div><div class="line">$ <span class="built_in">cd</span> /e/GitHup_Data/Hexo_B<span class="built_in">log</span></div><div class="line">$ hexo new <span class="string">"使用GitHub+Hexo搭建免费静态Blog"</span></div><div class="line">INFO  Created: E:\GitHup_Data\Hexo_B<span class="built_in">log</span>\<span class="built_in">source</span>\_posts\使用GitHub-Hexo搭建免费静态Blog.md   <span class="comment">#生成的.md文件使用支持markdown语法的编辑器来编辑文档，如：Sublime Text 3等</span></div><div class="line">$ hexo server</div></pre></td></tr></table></figure></p>
<p>再次访问<a href="http://localhost:4000时发现多了一篇文章" target="_blank" rel="external">http://localhost:4000时发现多了一篇文章</a><br><img src="http://note.youdao.com/yws/api/personal/file/B0D6C30338CE45C8AC9B24A54D2B8B49?method=download&amp;shareKey=b3f670355809ed823f9565d976f57221" alt="image">  </p>
<p><a href="http://www.sublimetext.com/3" target="_blank" rel="external">Sublime Text 3下载地址</a><br>参考：<a href="https://hexo.io/zh-cn/docs/configuration.html" target="_blank" rel="external">https://hexo.io/zh-cn/docs/configuration.html</a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">$ cat <span class="built_in">source</span>/_posts/使用GitHub-Hexo搭建免费静态Blog.md</div><div class="line">---</div><div class="line">title: 使用GitHub+Hexo搭建免费静态B<span class="built_in">log</span></div><div class="line">date: 2017-02-13 14:33:54</div><div class="line">tags: [GitHub,Hexo]</div><div class="line">---</div><div class="line">This is a <span class="built_in">test</span> page.</div><div class="line"></div><div class="line">$ hexo g   <span class="comment">#把markdown生成静态网页</span></div><div class="line">INFO  Start processing</div><div class="line">INFO  Files loaded <span class="keyword">in</span> 760 ms</div><div class="line">INFO  Deleted: tags/GitHub-Hexo/index.html</div><div class="line">INFO  Generated: atom.xml</div><div class="line">INFO  Generated: sitemap.xml</div><div class="line">INFO  Generated: archives/index.html</div><div class="line">INFO  Generated: archives/2017/02/index.html</div><div class="line">INFO  Generated: 2017/02/13/hello-world/index.html</div><div class="line">INFO  Generated: 2017/02/13/使用GitHub-Hexo搭建免费静态B<span class="built_in">log</span>/index.html</div><div class="line">INFO  Generated: archives/2017/index.html</div><div class="line">INFO  Generated: index.html</div><div class="line">INFO  Generated: tags/Hexo/index.html</div><div class="line">INFO  Generated: tags/GitHub/index.html</div><div class="line">INFO  10 files generated <span class="keyword">in</span> 259 ms</div></pre></td></tr></table></figure></p>
<p>定制化博客：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#修改_config.yml</span></div><div class="line">$ <span class="built_in">pwd</span></div><div class="line">/e/GitHup_Data/Hexo_B<span class="built_in">log</span></div><div class="line">$ head -n 11 _config.yml | tail -7</div><div class="line"><span class="comment"># Site</span></div><div class="line">title: Jack Wang B<span class="built_in">log</span></div><div class="line">subtitle:</div><div class="line">description: B<span class="built_in">log</span></div><div class="line">author: Jack Wang</div><div class="line">language: CN</div><div class="line">timezone: <span class="string">"Asia/Shanghai"</span></div><div class="line"></div><div class="line"><span class="comment">#修改theme信息，即theme的_config.yml</span></div><div class="line">$ <span class="built_in">cd</span> themes/hexo-theme-spfk/</div><div class="line">$ ls</div><div class="line">_config.yml  languages/  layout/  package.json  README.md  <span class="built_in">source</span>/</div><div class="line"></div><div class="line"><span class="comment">#简单修改</span></div><div class="line">$ grep -v <span class="string">'#'</span> _config.yml | grep -v ^$</div><div class="line">menu:</div><div class="line">  博客首页: /Home</div><div class="line">  作品展示: /works</div><div class="line">  留言打卡: /about</div><div class="line">  前端导航: /FrontEndGuide</div><div class="line">avatar: img/head.jpg</div><div class="line">favicon: img/favicon.png</div><div class="line">subnav:</div><div class="line">  mail: <span class="string">"http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=Uyo1IDsyITYTNTwrPjI6P30wPD4"</span></div><div class="line">  github: <span class="string">"https://yfshare.github.io/"</span></div><div class="line">  QQ: <span class="string">"http://wpa.qq.com/msgrd?V=1&amp;Uin=838554604"</span></div><div class="line">disqus:</div><div class="line">  shortname:</div><div class="line">duoshuo:</div><div class="line">  on: <span class="literal">true</span></div><div class="line">  domain:</div><div class="line">youyan:</div><div class="line">  id:</div><div class="line">background:</div><div class="line">  on: <span class="literal">true</span></div><div class="line">  background_sum: 24</div><div class="line">  background_image: 109</div><div class="line">highlight_style:</div><div class="line">  on: <span class="literal">true</span></div><div class="line">  inline_code: 5</div><div class="line">  code_block: 5</div><div class="line">blockquote_style:</div><div class="line">left_col_width: 300</div><div class="line">toc_nowrap: <span class="literal">false</span></div><div class="line">animate: <span class="literal">true</span></div><div class="line">tagcloud: <span class="literal">true</span></div><div class="line">friends:</div><div class="line">  name: http://luuman.github.io/</div><div class="line">aboutme: 纯海迷、爱运动、爱交友、爱旅行、喜欢接触新鲜事物、迎接新的挑战，更爱游离于错综复杂的编码与逻辑中</div><div class="line">open_in_new: <span class="literal">false</span></div><div class="line">rss: /atom.xml</div><div class="line">fancybox: <span class="literal">true</span></div><div class="line">mathjax: <span class="literal">false</span></div><div class="line">baidushare: <span class="literal">true</span></div><div class="line">google_analytics:</div><div class="line">baidu_analytics:</div><div class="line">visit_counter:</div><div class="line">  on: <span class="literal">true</span></div><div class="line">  site_visit: 海贼到访数</div><div class="line">  page_visit: 本页阅读量</div><div class="line">TipTitle: <span class="literal">true</span></div><div class="line">$</div></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy   <span class="comment">#推送代码到Githup</span></div></pre></td></tr></table></figure>
<p>访问：<a href="https://yfshare.github.io即可" target="_blank" rel="external">https://yfshare.github.io即可</a><br><img src="http://note.youdao.com/yws/api/personal/file/4D20AC823BA0467A8A7662371FFA143A?method=download&amp;shareKey=6aabadd2208b268f4f9dece6ecf70286" alt="image">  </p>
<p><a href="http://openmail.qq.com/cgi-bin/dy_template?sid=aITh-q3yfoUkTn8n&amp;t=index&amp;sub=&amp;r=7d887de7d8816f125839155a7c4f8f16" target="_blank" rel="external">QQ邮箱开放平台</a>  </p>
<p>参考文档：<a href="http://www.cnblogs.com/zhcncn/p/4097881.html" target="_blank" rel="external">http://www.cnblogs.com/zhcncn/p/4097881.html</a><br>　　　　　<a href="http://www.jianshu.com/p/05289a4bc8b2" target="_blank" rel="external">http://www.jianshu.com/p/05289a4bc8b2</a><br>　　　　　<a href="https://qiutc.me/post/使用hexo-github搭建静态博客.html" target="_blank" rel="external">https://qiutc.me/post/使用hexo-github搭建静态博客.html</a><br>　　　　　<a href="https://wsgzao.github.io/post/hexo-guide/#" target="_blank" rel="external">https://wsgzao.github.io/post/hexo-guide/#</a><br>　　　　　<a href="https://xuanwo.org/2015/03/26/hexo-intor/" target="_blank" rel="external">https://xuanwo.org/2015/03/26/hexo-intor/</a><br>　　　　　<a href="http://jiji262.github.io/2016/04/15/2016-04-15-hexo-github-pages-blog/" target="_blank" rel="external">http://jiji262.github.io/2016/04/15/2016-04-15-hexo-github-pages-blog/</a>  </p>
<hr>
<p>本作品采用<a href="https://creativecommons.org/licenses/by/2.5/cn/" target="_blank" rel="external">知识共享署名 2.5 中国大陆许可协议</a>进行许可，欢迎转载，但转载请注明来自<a href="https://yfshare.github.io">Jack Wang Blog</a>，并保持转载后文章内容的完整。本人保留所有版权相关权利。</p>
<p>本文出自”Jack Wang Blog”：<a href="https://yfshare.github.io/2017/02/13/使用GitHub-Hexo搭建免费静态Blog/">https://yfshare.github.io/2017/02/13/使用GitHub-Hexo搭建免费静态Blog/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Hexo官网：&lt;a href=&quot;https://hexo.io/zh-cn/&quot;&gt;https://hexo.io/zh-cn/&lt;/a&gt;&lt;br&gt;Hexo官方安装文档：&lt;a href=&quot;https://hexo.io/zh-cn/docs/&quot;&gt;https://hexo.io/zh-cn/docs/&lt;/a&gt;  &lt;/p&gt;
&lt;h2 id=&quot;了解Hexo优点&quot;&gt;&lt;a href=&quot;#了解Hexo优点&quot; class=&quot;headerlink&quot; title=&quot;了解Hexo优点&quot;&gt;&lt;/a&gt;了解Hexo优点&lt;/h2&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;优点&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;超快速度&lt;/td&gt;
&lt;td&gt;Node.js 所带来的超快生成速度，让上百个页面在几秒内瞬间完成渲染&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;一键部署&lt;/td&gt;
&lt;td&gt;只需一条指令即可部署到 GitHub Pages, Heroku 或其他网站&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;支持Markdown&lt;/td&gt;
&lt;td&gt;Hexo 支持 GitHub Flavored Markdown 的所有功能，甚至可以整合 Octopress 的大多数插件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;丰富的插件&lt;/td&gt;
&lt;td&gt;Hexo 拥有强大的插件系统，安装插件可以让 Hexo 支持 Jade, CoffeeScript&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
    
    </summary>
    
      <category term="Hexo" scheme="https://yfshare.github.io/categories/Hexo/"/>
    
    
      <category term="Hexo" scheme="https://yfshare.github.io/tags/Hexo/"/>
    
      <category term="GitHub" scheme="https://yfshare.github.io/tags/GitHub/"/>
    
  </entry>
  
</feed>
